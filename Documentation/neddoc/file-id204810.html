<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<h2 class="comptitle">File <i>mpls-doc.ned</i>
</h2>
<h3 class="subtitle">Contains:</h3>
<ul></ul>
<pre class="src"><span class="src-comment">//</span>
<span class="src-comment">// This library is free software, you can redistribute it</span>
<span class="src-comment">// and/or modify</span>
<span class="src-comment">// it under  the terms of the GNU Lesser General Public License</span>
<span class="src-comment">// as published by the Free Software Foundation;</span>
<span class="src-comment">// either version 2 of the License, or any later version.</span>
<span class="src-comment">// The library is distributed in the hope that it will be useful,</span>
<span class="src-comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="src-comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="src-comment">// See the GNU Lesser General Public License for more details.</span>
<span class="src-comment">//</span>



<span class="src-comment">//</span>
<span class="src-comment">// @page standards.html, MPLS/RSVP/LDP Model - Implemented Standards</span>
<span class="src-comment">//</span>
<span class="src-comment">// The implementation follows those RFCs below:</span>
<span class="src-comment">// - RFC 2702: Requirements for Traffic Engineering Over MPLS</span>
<span class="src-comment">// - RFC 2205: Resource ReSerVation Protocol</span>
<span class="src-comment">// - RFC 3031: Multiprotocol Label Switching Architecture</span>
<span class="src-comment">// - RFC 3036: LDP Specification</span>
<span class="src-comment">// - RFC 3209: \RSVP-TE Extension to \RSVP for LSP tunnels</span>
<span class="src-comment">// - RFC 2205: \RSVP Version 1 - Functional Specification</span>
<span class="src-comment">// - RFC 2209: \RSVP Message processing Version 1</span>
<span class="src-comment">//</span>
<span class="src-comment">//#------------------------------------------------------------------------</span>
<span class="src-comment">// @page mpls-pseudocode.html, MPLS Operation</span>
<span class="src-comment">//</span>
<span class="src-comment">// The following algorithm is carried out by the MPLS module:</span>
<span class="src-comment">//</span>
<span class="src-comment">// &lt;pre&gt;</span>
<span class="src-comment">// Step 1: - Check which layer the packet is coming from</span>
<span class="src-comment">// Alternative 1: From layer 3</span>
<span class="src-comment">//     Step 1: Find and check the next hop of this packet</span>
<span class="src-comment">//     Alternative 1: Next hop belongs to this MPLS cloud</span>
<span class="src-comment">//         Step 1: Encapsulate the packet in an MPLS packet with</span>
<span class="src-comment">//         IP_NATIVE_LABEL label</span>
<span class="src-comment">//         Step 2: Send to the next hop</span>
<span class="src-comment">//         Step 3: Return</span>
<span class="src-comment">//     Alternative 2: Next hop does not belong to this MPLS cloud</span>
<span class="src-comment">//         Step 1: Send the packet to the next hop</span>
<span class="src-comment">// Alternative 2: From layer 2</span>
<span class="src-comment">//     Step 1: Record the packet incoming interface</span>
<span class="src-comment">//     Step 2: - Check if the packet is for this LSR</span>
<span class="src-comment">//     Alternative 1: Yes</span>
<span class="src-comment">//         Step 1: Check if the packet has label</span>
<span class="src-comment">//         Alternative 1: Yes</span>
<span class="src-comment">//             Step 1: Strip off all labels and send the packet to L3</span>
<span class="src-comment">//             Step 2: Return</span>
<span class="src-comment">//         Alternative 2: No</span>
<span class="src-comment">//             Step 1: Send the packet to L3</span>
<span class="src-comment">//             Step 2: Return</span>
<span class="src-comment">//     Alternative 2: No</span>
<span class="src-comment">//         Step 1: Continue to the next step</span>
<span class="src-comment">//     Step 3: Check the packet type</span>
<span class="src-comment">//     Alternative 1: The packet is native IP</span>
<span class="src-comment">//         Step 1: Check the LSR type</span>
<span class="src-comment">//         Alternative 1: The LSR is an Ingress \Router</span>
<span class="src-comment">//             Step 1: Look up LIB for outgoing label</span>
<span class="src-comment">//             Alternative 1: Label cannot be found</span>
<span class="src-comment">//                 Step 1: Check if the label for this FEC is being requested</span>
<span class="src-comment">//                 Alternative 1: Yes</span>
<span class="src-comment">//                     Step 1: Return</span>
<span class="src-comment">//                 Alternative 2: No</span>
<span class="src-comment">//                     Step 1: Store the packet with FEC id</span>
<span class="src-comment">//                     Step 2: Do request the signalling component</span>
<span class="src-comment">//                     Step 3: Return</span>
<span class="src-comment">//             Alternative 2: Label found</span>
<span class="src-comment">//                 Step 1: Carry out the label operation on the packet</span>
<span class="src-comment">//                 Step 2: Forward the packet to the outgoing interface found</span>
<span class="src-comment">//                 Step 3: Return</span>
<span class="src-comment">//         Alternative 2: The LSR is not an Ingress \Router</span>
<span class="src-comment">//             Step 1: Print out the error</span>
<span class="src-comment">//             Step 2: Delete the packet and return</span>
<span class="src-comment">//     Alternative 2: The packet is MPLS</span>
<span class="src-comment">//         Step 1: Check the LSR type</span>
<span class="src-comment">//         Alternative 1: The LSR is an Egress \Router</span>
<span class="src-comment">//             Step 1: POP the top label</span>
<span class="src-comment">//             Step 2: Forward the packet to the outgoing interface found</span>
<span class="src-comment">//             Step 3: Return</span>
<span class="src-comment">//         Alternative 2: The LSR is not an Egress \Router</span>
<span class="src-comment">//             Step 1: Look up LIB for outgoing label</span>
<span class="src-comment">//             Alternative 1: Label cannot be found</span>
<span class="src-comment">//                 Step 1: Check if the label for this FEC is being requested</span>
<span class="src-comment">//                 Alternative 1: Yes</span>
<span class="src-comment">//                     Step 1: Return</span>
<span class="src-comment">//                 Alternative 2: No</span>
<span class="src-comment">//                     Step 1: Store the packet with FEC id</span>
<span class="src-comment">//                     Step 2: Do request the signalling component</span>
<span class="src-comment">//                     Step 3: Return</span>
<span class="src-comment">//             Alternative 2: Label found</span>
<span class="src-comment">//                 Step 1: Carry out the label operation on the packet</span>
<span class="src-comment">//                 Step 2: Forward the packet to the outgoing interface found</span>
<span class="src-comment">//                 Step 3: Return</span>
<span class="src-comment">// Step 2: Return</span>
<span class="src-comment">// &lt;/pre&gt;</span>
<span class="src-comment">//</span>
<span class="src-comment">//</span>
<span class="src-comment">//#------------------------------------------------------------------------</span>
<span class="src-comment">// @page ldp-processing.html, LDP Message Processing</span>
<span class="src-comment">//</span>
<span class="src-comment">// The simulation follows message processing rules specified in RFC3036</span>
<span class="src-comment">// (LDP Specification). A summary of the algorithm used in the RFC is</span>
<span class="src-comment">// presented below.</span>
<span class="src-comment">//</span>
<span class="src-comment">// &lt;b&gt;Label Request Message processing&lt;/b&gt;</span>
<span class="src-comment">//</span>
<span class="src-comment">// An LSR may transmit a Request message under any of the conditions below:</span>
<span class="src-comment">// - The LSR recognizes a new FEC via the forwarding tale, and the next hop</span>
<span class="src-comment">//   is its LDP peer. The LIB of this LSR does not have a mapping from the</span>
<span class="src-comment">//   next hop for the given FEC.</span>
<span class="src-comment">// - Network topology changes, the next hop to the FEC is no longer valid</span>
<span class="src-comment">//   and new mapping is not available.</span>
<span class="src-comment">// - The LSR receives a Label Request for a FEC from an upstream LDP and it</span>
<span class="src-comment">//   does not have label binding information for this FEC. The FEC next hop</span>
<span class="src-comment">//   is an LDP peer.</span>
<span class="src-comment">//</span>
<span class="src-comment">// Upon receiving a Label Request message, the following procedures will be</span>
<span class="src-comment">// performed:</span>
<span class="src-comment">//</span>
<span class="src-comment">// &lt;pre&gt;</span>
<span class="src-comment">// Step 1: Extract the FEC from the message and locate the incoming interface</span>
<span class="src-comment">//         of the message.</span>
<span class="src-comment">// Step 2: Check whether the FEC is an outstanding FEC.</span>
<span class="src-comment">//     Alternative 1: This FEC is outstanding</span>
<span class="src-comment">//         Step 1: Return</span>
<span class="src-comment">//     Alternative 2: This FEC is not outstanding</span>
<span class="src-comment">//         Step 1: Continue</span>
<span class="src-comment">// Step 3: Check if there is an exact match of the FEC in the routing table.</span>
<span class="src-comment">//     Alternative 1: There is an exact match</span>
<span class="src-comment">//         Step 1: Continue</span>
<span class="src-comment">//     Alternative 2: There is no match</span>
<span class="src-comment">//         Step 1: Construct a Notification message of No route and</span>
<span class="src-comment">//                 send this message back to the sender.</span>
<span class="src-comment">// Step 4: Make query to local LIB to find out the corresponding label.</span>
<span class="src-comment">//     Alternative 1: The label found</span>
<span class="src-comment">//         Step 1: Construct a Label Mapping message and send over</span>
<span class="src-comment">//                 the incoming interface.</span>
<span class="src-comment">//     Alternative 2: The label cannot be found for this FEC</span>
<span class="src-comment">//         Step 1: Construct a new Label Request message and send</span>
<span class="src-comment">//                 the message out using L3 routing.</span>
<span class="src-comment">//         Step 2: Construct a Notification message indicating that the</span>
<span class="src-comment">//                 label cannot be found.</span>
<span class="src-comment">// &lt;/pre&gt;</span>
<span class="src-comment">//</span>
<span class="src-comment">// &lt;b&gt;Label Mapping Message processing&lt;/b&gt;</span>
<span class="src-comment">//</span>
<span class="src-comment">// Upon receiving a Label Mapping message, the following procedures will be</span>
<span class="src-comment">// performed:</span>
<span class="src-comment">//</span>
<span class="src-comment">// &lt;pre&gt;</span>
<span class="src-comment">// Step 1: Extract the FEC and the label from the message.</span>
<span class="src-comment">// Step 2: Check whether this is an outstanding FEC</span>
<span class="src-comment">//     Alternative 1: This FEC is outstanding</span>
<span class="src-comment">//         Step 1: Continue</span>
<span class="src-comment">//     Alternative 2: This FEC is not outstanding</span>
<span class="src-comment">//         Step 1: Send back the server an Notification of Error message.</span>
<span class="src-comment">// Step 3: Install the new label to the local LIB using the extracted label,</span>
<span class="src-comment">//         FEC and the message incoming interface.</span>
<span class="src-comment">// &lt;/pre&gt;</span>
<span class="src-comment">//</span>
<span class="src-comment">//</span>
<span class="src-comment">//#------------------------------------------------------------------------</span>
<span class="src-comment">// @page lib-table-file.html, LIB Table File Format</span>
<span class="src-comment">//</span>
<span class="src-comment">// The format of a LIB table file is:</span>
<span class="src-comment">//</span>
<span class="src-comment">// The beginning of the file should begin with comments. Lines begin with # are treated</span>
<span class="src-comment">// as comments. An empty line is required after the comments. The "LIB TABLE"</span>
<span class="src-comment">// syntax must come next with an empty line. The column headers follow. This header</span>
<span class="src-comment">// must be strictly "In-lbl In-intf Out-lbl Out-intf". Column</span>
<span class="src-comment">// values are after that with space or tab for field separation.</span>
<span class="src-comment">// The following is a sample of lib table file.</span>
<span class="src-comment">//</span>
<span class="src-comment">// &lt;pre&gt;</span>
<span class="src-comment">// #lib table for MPLS network simulation test</span>
<span class="src-comment">// #lib1.table for LSR1 - this is an edge router</span>
<span class="src-comment">// #no incoming label for traffic from in-intf 0 &amp; 1 - LSR1 is ingress router for those traffic</span>
<span class="src-comment">// #no outgoing label for traffic from in_intf 2 &amp; 3 - LSR 1 is egress router for those traffic</span>
<span class="src-comment">//</span>
<span class="src-comment">// LIB TABLE:</span>
<span class="src-comment">//</span>
<span class="src-comment">// In-lbl  In-intf         Out-lbl     Out-intf</span>
<span class="src-comment">// 1       193.233.7.90    1           193.231.7.21</span>
<span class="src-comment">// 2       193.243.2.1     0           193.243.2.3</span>
<span class="src-comment">// &lt;/pre&gt;</span>
<span class="src-comment">//</span>
<span class="src-comment">//#------------------------------------------------------------------------</span>
<span class="src-comment">// @page cspf-algorithm.html, The CSPF Algorithm</span>
<span class="src-comment">//</span>
<span class="src-comment">// CSPF stands for Constraint Shortest Path First.</span>
<span class="src-comment">// This constraint-based routing is executed online by Ingress \Router.</span>
<span class="src-comment">// The CSPF calculates an optimum explicit route (ER), based on</span>
<span class="src-comment">// specific constraints. CSPF relies on a Traffic Engineering Database (TED)</span>
<span class="src-comment">// to do those calculations. The resulting route is then used by \RSVP-TE.</span>
<span class="src-comment">//</span>
<span class="src-comment">// The CSPF in particular and any constraint based routing process requires following</span>
<span class="src-comment">// inputs:</span>
<span class="src-comment">// - Attributes of the traffic trunks, e.g., bandwidth, link affinities</span>
<span class="src-comment">// - Attributes of the links of the network, e.g. bandwidth, delay</span>
<span class="src-comment">// - Attributes of the LSRs, e.g. types of signaling protocols supported</span>
<span class="src-comment">// - Other topology state information.</span>
<span class="src-comment">//</span>
<span class="src-comment">// There has been no standard for CSPF so far. The implementation of CSPF in</span>
<span class="src-comment">// the simulation is based on the concept of "induced graph" introduced in RFC</span>
<span class="src-comment">// 2702. An induced graph is analogous to a virtual topology in an overlay</span>
<span class="src-comment">// model. It is logically mapped onto the physical network through the</span>
<span class="src-comment">// selection of LSPs for traffic trunks. CSPF is similar to a normal SPF,</span>
<span class="src-comment">// except during link examination, it rejects links without capacity or links</span>
<span class="src-comment">// that do not match color constraints or configured policy. The CSPF</span>
<span class="src-comment">// algorithm used in the simulation has two phases. In the first phase, all</span>
<span class="src-comment">// the links that do not satisfy the constraints of bandwidth are excluded</span>
<span class="src-comment">// from the network topology. The link affinity is also examined in this</span>
<span class="src-comment">// phase. In the second phase, Dijkstra algorithm is performed.</span>
<span class="src-comment">//</span>
<span class="src-comment">// Dijkstra Algorithm:</span>
<span class="src-comment">//</span>
<span class="src-comment">// &lt;pre&gt;</span>
<span class="src-comment">// Dijkstra(G, w, s):</span>
<span class="src-comment">//    Initialize-single-source(G,s);</span>
<span class="src-comment">//    S = empty set;</span>
<span class="src-comment">//    Q = V[G];</span>
<span class="src-comment">//    While Q is not empty {</span>
<span class="src-comment">//        u = Extract-Min(Q);</span>
<span class="src-comment">//        S = S union {u};</span>
<span class="src-comment">//        for each vertex v in Adj[u] {</span>
<span class="src-comment">//            relax(u, v, w);</span>
<span class="src-comment">//        }</span>
<span class="src-comment">//    }</span>
<span class="src-comment">// &lt;/pre&gt;</span>
<span class="src-comment">//</span>
<span class="src-comment">// In which:</span>
<span class="src-comment">// - G: the graph, represented in some way (e.g. adjacency list)</span>
<span class="src-comment">// - w: the distance (weight) for each edge (u,v)</span>
<span class="src-comment">// - s (small s): the starting vertex (source)</span>
<span class="src-comment">// - S (big S): a set of vertices whose final shortest path from s have already been determined</span>
<span class="src-comment">// - Q: set of remaining vertices, Q union S = V</span>
<span class="src-comment">//</span>
<span class="src-comment">//</span>
<span class="src-comment">//#------------------------------------------------------------------------</span>
<span class="src-comment">// @page traffic-xml-file.html, The traffic.xml file</span>
<span class="src-comment">//</span>
<span class="src-comment">// The traffic.xml file is read by the \RSVP-TE module (\RSVP).</span>
<span class="src-comment">// The file must be in the same folder as the executable</span>
<span class="src-comment">// network simulation file.</span>
<span class="src-comment">//</span>
<span class="src-comment">// The XML elements used in the "traffic.xml" file:</span>
<span class="src-comment">// - &lt;Traffic&gt;&lt;/Traffic&gt; is the root element. It may contain one or more &lt;Conn&gt;</span>
<span class="src-comment">//   elements.</span>
<span class="src-comment">// - &lt;Conn&gt;&lt;/Conn&gt; specifies an \RSVP session. It may contain the following elements.</span>
<span class="src-comment">// - &lt;src&gt;&lt;/src&gt; specifies sender \IP address</span>
<span class="src-comment">// - &lt;dest&gt;&lt;/dest&gt; specifies receiver \IP address</span>
<span class="src-comment">// - &lt;setupPri&gt;&lt;/setupPri&gt; specifies LSP setup priority</span>
<span class="src-comment">// - &lt;holdingPri&gt;&lt;/holdingPri&gt; specifies LSP holding priority</span>
<span class="src-comment">// - &lt;bandwidth&gt;&lt;/bandwidth&gt; specifies the requested BW.</span>
<span class="src-comment">// - &lt;delay&gt;&lt;/delay&gt; specifies the requested delay.</span>
<span class="src-comment">// - &lt;route&gt;&lt;/route&gt; specifies the explicit route. This is a comma-separated</span>
<span class="src-comment">//   list of IP-address, hop-type pairs (also separated by comma).</span>
<span class="src-comment">//   A hop type has a value of 1 if the hop is a loose hop and 0 otherwise.</span>
<span class="src-comment">//</span>
<span class="src-comment">// The following presents an example file:</span>
<span class="src-comment">//</span>
<span class="src-comment">// &lt;pre&gt;</span>
<span class="src-comment">// &lt;?xml version="1.0"?&gt;</span>
<span class="src-comment">// &lt;!-- Example of traffic control file --&gt;</span>
<span class="src-comment">// &lt;traffic&gt;</span>
<span class="src-comment">//    &lt;conn&gt;</span>
<span class="src-comment">//        &lt;src&gt;10.0.0.1&lt;/src&gt;</span>
<span class="src-comment">//        &lt;dest&gt;10.0.1.2&lt;/dest&gt;</span>
<span class="src-comment">//        &lt;setupPri&gt;7&lt;/setupPri&gt;</span>
<span class="src-comment">//        &lt;holdingPri&gt;7&lt;/holdingPri&gt;</span>
<span class="src-comment">//        &lt;bandwidth&gt;400&lt;/bandwidth&gt;</span>
<span class="src-comment">//        &lt;delay&gt;5&lt;/delay&gt;</span>
<span class="src-comment">//    &lt;/conn&gt;</span>
<span class="src-comment">//    &lt;conn&gt;</span>
<span class="src-comment">//        &lt;src&gt;11.0.0.1&lt;/src&gt;</span>
<span class="src-comment">//        &lt;dest&gt;11.0.1.2&lt;/dest&gt;</span>
<span class="src-comment">//        &lt;setupPri&gt;7&lt;/setupPri&gt;</span>
<span class="src-comment">//        &lt;holdingPri&gt;7&lt;/holdingPri&gt;</span>
<span class="src-comment">//        &lt;bandwidth&gt;100&lt;/bandwidth&gt;</span>
<span class="src-comment">//        &lt;delay&gt;5&lt;/delay&gt;</span>
<span class="src-comment">//    &lt;/conn&gt;</span>
<span class="src-comment">// &lt;/traffic&gt;</span>
<span class="src-comment">// &lt;/pre&gt;</span>
<span class="src-comment">//</span>
<span class="src-comment">// An example of using \RSVP-TE as signaling protocol can be found in</span>
<span class="src-comment">// ExplicitRouting folder distributed with the simulation. In this</span>
<span class="src-comment">// example, a network similar to the network in LDP-MPLS example is</span>
<span class="src-comment">// setup. Instead of using LDP, "signaling" parameter is set to 2 (value</span>
<span class="src-comment">// of \RSVP-TE handler). The following xml file is used for traffic</span>
<span class="src-comment">// control. Note the explicit routes specified in the second connection.</span>
<span class="src-comment">// It indicates that the route is a strict one since the values of every</span>
<span class="src-comment">// hop types are 0. The route defined is 10.0.0.1 -&gt; 1.0.0.1 -&gt;</span>
<span class="src-comment">// 10.0.0.3 -&gt; 1.0.0.4 -&gt; 10.0.0.5 -&gt; 10.0.1.2.</span>
<span class="src-comment">//</span>
<span class="src-comment">// &lt;pre&gt;</span>
<span class="src-comment">// &lt;?xml version="1.0"?&gt;</span>
<span class="src-comment">// &lt;!-- Example of traffic control file --&gt;</span>
<span class="src-comment">// &lt;traffic&gt;</span>
<span class="src-comment">//     &lt;conn&gt;</span>
<span class="src-comment">//         &lt;src&gt;10.0.0.1&lt;/src&gt;</span>
<span class="src-comment">//         &lt;dest&gt;10.0.1.2&lt;/dest&gt;</span>
<span class="src-comment">//         &lt;setupPri&gt;7&lt;/setupPri&gt;</span>
<span class="src-comment">//         &lt;holdingPri&gt;7&lt;/holdingPri&gt;</span>
<span class="src-comment">//         &lt;bandwidth&gt;0&lt;/bandwidth&gt;</span>
<span class="src-comment">//         &lt;delay&gt;0&lt;/delay&gt;</span>
<span class="src-comment">//         &lt;ER&gt;false&lt;/ER&gt;</span>
<span class="src-comment">//     &lt;/conn&gt;</span>
<span class="src-comment">//     &lt;conn&gt;</span>
<span class="src-comment">//         &lt;src&gt;11.0.0.1&lt;/src&gt;</span>
<span class="src-comment">//         &lt;dest&gt;11.0.1.2&lt;/dest&gt;</span>
<span class="src-comment">//         &lt;setupPri&gt;7&lt;/setupPri&gt;</span>
<span class="src-comment">//         &lt;holdingPri&gt;7&lt;/holdingPri&gt;</span>
<span class="src-comment">//         &lt;bandwidth&gt;0&lt;/bandwidth&gt;</span>
<span class="src-comment">//         &lt;delay&gt;0&lt;/delay&gt;</span>
<span class="src-comment">//         &lt;ER&gt;true&lt;/ER&gt;</span>
<span class="src-comment">//         &lt;route&gt;1.0.0.1,0,1.0.0.3,0,1.0.0.4,0,1.0.0.5,0,10.0.1.2,0&lt;/route&gt;</span>
<span class="src-comment">//     &lt;/conn&gt;</span>
<span class="src-comment">// &lt;/traffic&gt;</span>
<span class="src-comment">// &lt;/pre&gt;</span>
<span class="src-comment">//</span>
</pre>
</body>
</html>
