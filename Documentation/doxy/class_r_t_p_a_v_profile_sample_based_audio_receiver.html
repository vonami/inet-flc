<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: RTPAVProfileSampleBasedAudioReceiver Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>RTPAVProfileSampleBasedAudioReceiver Class Reference</h1><code>#include &lt;RTPAVProfileSampleBasedAudioReceiver.h&gt;</code>
<p>
<p>Inheritance diagram for RTPAVProfileSampleBasedAudioReceiver:
<p><center><img src="class_r_t_p_a_v_profile_sample_based_audio_receiver.png" usemap="#RTPAVProfileSampleBasedAudioReceiver_map" border="0" alt=""></center>
<map name="RTPAVProfileSampleBasedAudioReceiver_map">
<area href="class_r_t_p_payload_receiver.html" alt="RTPPayloadReceiver" shape="rect" coords="0,0,250,24">
<area href="class_r_t_p_a_v_profile_payload10_receiver.html" alt="RTPAVProfilePayload10Receiver" shape="rect" coords="0,112,250,136">
</map>
<a href="class_r_t_p_a_v_profile_sample_based_audio_receiver-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#b0">processPacket</a> (<a class="el" href="class_r_t_p_packet.html">RTPPacket</a> *packet)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#b1">openOutputFile</a> (const char *fileName)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#b2">closeOutputFile</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#b3">insertSilence</a> (simtime_t duration)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">AFfilehandle&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p0">_audioFile</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">AFfilesetup&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p1">_fileSetup</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p2">_samplingRate</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p3">_sampleWidth</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p4">_numberOfChannels</a></td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#d0">Module_Class_Members</a> (<a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html">RTPAVProfileSampleBasedAudioReceiver</a>, <a class="el" href="class_r_t_p_payload_receiver.html">RTPPayloadReceiver</a>, 0) virtual ~<a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html">RTPAVProfileSampleBasedAudioReceiver</a>()</td></tr>

</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b2" doxytag="RTPAVProfileSampleBasedAudioReceiver::closeOutputFile"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RTPAVProfileSampleBasedAudioReceiver::closeOutputFile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Closes the output file stream. 
<p>
Reimplemented from <a class="el" href="class_r_t_p_payload_receiver.html#b5">RTPPayloadReceiver</a>.<div class="fragment"><pre class="fragment">00092                                                            {
00093     <span class="keywordflow">if</span> (afCloseFile(_audioFile)) {
00094         opp_error(<span class="stringliteral">"payload receiver: error closing output file"</span>);
00095     };
00096 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="RTPAVProfileSampleBasedAudioReceiver::insertSilence"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RTPAVProfileSampleBasedAudioReceiver::insertSilence           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">simtime_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>duration</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
When packets arrival late or have been lost, this method can be called to insert a silence period. It must be overwritten because in different audio formats different values for silence exist. 
<p>
Reimplemented in <a class="el" href="class_r_t_p_a_v_profile_payload10_receiver.html#b1">RTPAVProfilePayload10Receiver</a>.<div class="fragment"><pre class="fragment">00099                                                                            {
00100     <span class="comment">// depends at least on sampling rate and sample width</span>
00101 }</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d0" doxytag="RTPAVProfileSampleBasedAudioReceiver::Module_Class_Members"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">RTPAVProfileSampleBasedAudioReceiver::Module_Class_Members           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html">RTPAVProfileSampleBasedAudioReceiver</a>&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_r_t_p_payload_receiver.html">RTPPayloadReceiver</a>&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>0&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="RTPAVProfileSampleBasedAudioReceiver::openOutputFile"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RTPAVProfileSampleBasedAudioReceiver::openOutputFile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fileName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This method is called by initialize and opens the output file stream. For most payload receivers this method works well, only when using a library for a payload type which provides an own open method it must 
<p>
Reimplemented from <a class="el" href="class_r_t_p_payload_receiver.html#b4">RTPPayloadReceiver</a>.<div class="fragment"><pre class="fragment">00079                                                                               {
00080     <a class="code" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p1">_fileSetup</a> = afNewFileSetup();
00081     afInitByteOrder(_fileSetup, AF_DEFAULT_TRACK, AF_BYTEORDER_LITTLEENDIAN);
00082     afInitChannels(_fileSetup, AF_DEFAULT_TRACK, _numberOfChannels);
00083     afInitSampleFormat(_fileSetup, AF_DEFAULT_TRACK, AF_SAMPFMT_TWOSCOMP, _sampleWidth);
00084     afInitRate(_fileSetup, AF_DEFAULT_TRACK, (<span class="keywordtype">double</span>)_samplingRate);
00085     <a class="code" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p0">_audioFile</a> = afOpenFile(fileName, <span class="stringliteral">"w"</span>, _fileSetup);
00086     <span class="keywordflow">if</span> (_audioFile == AF_NULL_FILEHANDLE) {
00087         opp_error(<span class="stringliteral">"payload receiver: error creating output file"</span>);
00088     };
00089 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="RTPAVProfileSampleBasedAudioReceiver::processPacket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RTPAVProfileSampleBasedAudioReceiver::processPacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_r_t_p_packet.html">RTPPacket</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>packet</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Writes contents of this <a class="el" href="class_r_t_p_packet.html">RTPPacket</a> into the output file. Must be overwritten by subclasses. 
<p>
Reimplemented from <a class="el" href="class_r_t_p_payload_receiver.html#b3">RTPPayloadReceiver</a>.<div class="fragment"><pre class="fragment">00070                                                                           {
00071     <span class="comment">//RTPPayloadReceiver::processPacket(packet);</span>
00072     <span class="keywordtype">void</span> *data = packet-&gt;par(<span class="stringliteral">"data"</span>);
00073     <span class="keywordtype">int</span> dataSize = packet-&gt;<a class="code" href="class_r_t_p_packet.html#a19">payloadLength</a>();
00074     <span class="keywordtype">int</span> numberOfFrames = dataSize  / ((<a class="code" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p3">_sampleWidth</a> / 8) * <a class="code" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p4">_numberOfChannels</a>);
00075     afWriteFrames(_audioFile, AF_DEFAULT_TRACK, data, numberOfFrames);
00076 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p0" doxytag="RTPAVProfileSampleBasedAudioReceiver::_audioFile"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AFfilehandle <a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p0">RTPAVProfileSampleBasedAudioReceiver::_audioFile</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="RTPAVProfileSampleBasedAudioReceiver::_fileSetup"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AFfilesetup <a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p1">RTPAVProfileSampleBasedAudioReceiver::_fileSetup</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p4" doxytag="RTPAVProfileSampleBasedAudioReceiver::_numberOfChannels"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p4">RTPAVProfileSampleBasedAudioReceiver::_numberOfChannels</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="RTPAVProfileSampleBasedAudioReceiver::_sampleWidth"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p3">RTPAVProfileSampleBasedAudioReceiver::_sampleWidth</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p2" doxytag="RTPAVProfileSampleBasedAudioReceiver::_samplingRate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_r_t_p_a_v_profile_sample_based_audio_receiver.html#p2">RTPAVProfileSampleBasedAudioReceiver::_samplingRate</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_r_t_p_a_v_profile_sample_based_audio_receiver_8h.html">RTPAVProfileSampleBasedAudioReceiver.h</a><li><a class="el" href="_r_t_p_a_v_profile_sample_based_audio_receiver_8cc.html">RTPAVProfileSampleBasedAudioReceiver.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:29 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
