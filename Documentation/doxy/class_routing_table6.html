<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: RoutingTable6 Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>RoutingTable6 Class Reference</h1><code>#include &lt;RoutingTable6.h&gt;</code>
<p>
<a href="class_routing_table6-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Represents the <a class="el" href="class_i_pv6.html">IPv6</a> routing table and neighbour discovery data structures. This object has one instance per host or router.<p>
See the NED documentation for general overview.<p>
This is a simple module without gates, it requires function calls to it (message handling does nothing). Methods are provided for reading and updating the interface table and the route table, as well as for unicast and multicast routing.<p>
The route table is read from a file. The route table can also be read and modified during simulation, typically by routing protocol implementations. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#a0">RoutingTable6</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#a1">~RoutingTable6</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#a2">isRouter</a> () const </td></tr>

<tr><td colspan="2"><div class="groupHeader">Interfaces</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z52_0">interfaceByAddress</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;address)</td></tr>

<tr><td colspan="2"><div class="groupHeader">Routing functions</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z54_0">localDeliver</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;dest)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z54_1">lookupDestCache</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;dest, int &amp;outInterfaceId)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const <a class="el" href="class_i_pv6_route.html">IPv6Route</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z54_2">doLongestPrefixMatch</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;dest)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z54_3">isPrefixPresent</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;prefix)</td></tr>

<tr><td colspan="2"><div class="groupHeader">Managing the destination cache</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z55_0">updateDestCache</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;dest, const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;nextHopAddr, int interfaceId)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z55_1">purgeDestCache</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z55_2">purgeDestCacheEntriesToNeighbour</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;nextHopAddr, int interfaceId)</td></tr>

<tr><td colspan="2"><div class="groupHeader">Managing prefixes and the route table</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z57_0">addOrUpdateOnLinkPrefix</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;destPrefix, int prefixLength, int interfaceId, simtime_t expiryTime)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z57_1">removeOnLinkPrefix</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;destPrefix, int prefixLength)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z57_2">addOrUpdateOwnAdvPrefix</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;destPrefix, int prefixLength, int interfaceId, simtime_t expiryTime)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z57_3">addStaticRoute</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;destPrefix, int prefixLength, unsigned int interfaceId, const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;nextHop, int metric=0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z57_4">addDefaultRoute</a> (const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;raSrcAddr, unsigned int ifID, simtime_t routerLifetime)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z57_5">addRoutingProtocolRoute</a> (<a class="el" href="class_i_pv6_route.html">IPv6Route</a> *route)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z57_6">removeRoute</a> (<a class="el" href="class_i_pv6_route.html">IPv6Route</a> *route)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z57_7">numRoutes</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_pv6_route.html">IPv6Route</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#z57_8">route</a> (int i)</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#b0">updateDisplayString</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#b1">numInitStages</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#b2">initialize</a> (int stage)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#b3">parseXMLConfigFile</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#b4">handleMessage</a> (cMessage *)</td></tr>

<tr><td colspan="2"><br><h2>Private Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::map&lt; <a class="el" href="class_i_pv6_address.html">IPv6Address</a>,<br>
 <a class="el" href="struct_routing_table6_1_1_dest_cache_entry.html">DestCacheEntry</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#y0">DestCache</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::vector&lt; <a class="el" href="class_i_pv6_route.html">IPv6Route</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#y1">RouteList</a></td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#d0">addRoute</a> (<a class="el" href="class_i_pv6_route.html">IPv6Route</a> *route)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#d1">configureInterfaceForIPv6</a> (<a class="el" href="class_interface_entry.html">InterfaceEntry</a> *ie)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#d2">assignRequiredNodeAddresses</a> (<a class="el" href="class_interface_entry.html">InterfaceEntry</a> *ie)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#d3">configureInterfaceFromXML</a> (<a class="el" href="class_interface_entry.html">InterfaceEntry</a> *ie, cXMLElement *cfg)</td></tr>

<tr><td colspan="2"><br><h2>Static Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#h0">routeLessThan</a> (const <a class="el" href="class_i_pv6_route.html">IPv6Route</a> *a, const <a class="el" href="class_i_pv6_route.html">IPv6Route</a> *b)</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_interface_table.html">InterfaceTable</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#r0">ift</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#r1">isrouter</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_routing_table6.html#y0">DestCache</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#r2">destCache</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_routing_table6.html#y1">RouteList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#r3">routeList</a></td></tr>

<tr><td colspan="2"><br><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::ostream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_routing_table6.html#n0">operator&lt;&lt;</a> (std::ostream &amp;os, const <a class="el" href="struct_routing_table6_1_1_dest_cache_entry.html">DestCacheEntry</a> &amp;e)</td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_routing_table6_1_1_dest_cache_entry.html">DestCacheEntry</a></td></tr>

</table>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="y0" doxytag="RoutingTable6::DestCache"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef std::map&lt;<a class="el" href="class_i_pv6_address.html">IPv6Address</a>,<a class="el" href="struct_routing_table6_1_1_dest_cache_entry.html">DestCacheEntry</a>&gt; <a class="el" href="class_routing_table6.html#y0">RoutingTable6::DestCache</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="y1" doxytag="RoutingTable6::RouteList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef std::vector&lt;<a class="el" href="class_i_pv6_route.html">IPv6Route</a>*&gt; <a class="el" href="class_routing_table6.html#y1">RoutingTable6::RouteList</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="RoutingTable6::RoutingTable6"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">RoutingTable6::RoutingTable6           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00075 {
00076 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="RoutingTable6::~RoutingTable6"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">RoutingTable6::~<a class="el" href="class_routing_table6.html">RoutingTable6</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00079 {
00080     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="class_routing_table6.html#r3">routeList</a>.size(); i++)
00081         <span class="keyword">delete</span> <a class="code" href="class_routing_table6.html#r3">routeList</a>[i];
00082 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="z57_4" doxytag="RoutingTable6::addDefaultRoute"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::addDefaultRoute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>raSrcAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>ifID</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>simtime_t&nbsp;</td>
          <td class="mdname" nowrap> <em>routerLifetime</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds a default route for a host. This method requires the RA's source address and the router expiry time plus the simTime(). <div class="fragment"><pre class="fragment">00552 {
00553     <span class="comment">// create route object</span>
00554     <a class="code" href="class_i_pv6_route.html">IPv6Route</a> *<a class="code" href="class_routing_table6.html#z57_8">route</a> = <span class="keyword">new</span> <a class="code" href="class_i_pv6_route.html">IPv6Route</a>(<a class="code" href="class_i_pv6_address.html">IPv6Address</a>(), 0, IPv6Route::FROM_RA);
00555     route-&gt;<a class="code" href="class_i_pv6_route.html#a3">setInterfaceID</a>(ifID);
00556     route-&gt;<a class="code" href="class_i_pv6_route.html#a4">setNextHop</a>(nextHop);
00557     route-&gt;<a class="code" href="class_i_pv6_route.html#a6">setMetric</a>(10);<span class="comment">//FIXME:should be filled from interface metric</span>
00558 
00559     <span class="comment">// then add it</span>
00560     <a class="code" href="class_routing_table6.html#d0">addRoute</a>(route);
00561 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z57_0" doxytag="RoutingTable6::addOrUpdateOnLinkPrefix"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::addOrUpdateOnLinkPrefix           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>destPrefix</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>prefixLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>interfaceId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>simtime_t&nbsp;</td>
          <td class="mdname" nowrap> <em>expiryTime</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add on-link prefix (route of type FROM_RA), or update existing one. To be called from code processing on-link prefixes in Router Advertisements. Expiry time can be derived from the Valid Lifetime field in the Router Advertisements.<p>
NOTE: This method does NOT update the lifetime of matching addresses in the <a class="el" href="class_interface_table.html">InterfaceTable</a> (see <a class="el" href="class_i_pv6_interface_data.html">IPv6InterfaceData</a>); that has to be done separately. <div class="fragment"><pre class="fragment">00447 {
00448     <span class="comment">// see if prefix exists in table</span>
00449     <a class="code" href="class_i_pv6_route.html">IPv6Route</a> *<a class="code" href="class_routing_table6.html#z57_8">route</a> = NULL;
00450     <span class="keywordflow">for</span> (RouteList::iterator it=<a class="code" href="class_routing_table6.html#r3">routeList</a>.begin(); it!=<a class="code" href="class_routing_table6.html#r3">routeList</a>.end(); it++)
00451     {
00452         <span class="keywordflow">if</span> ((*it)-&gt;src()==<a class="code" href="class_i_pv6_route.html#w4w0">IPv6Route::FROM_RA</a> &amp;&amp; (*it)-&gt;destPrefix()==destPrefix &amp;&amp; (*it)-&gt;prefixLength()==prefixLength)
00453         {
00454             route = *it;
00455             <span class="keywordflow">break</span>;
00456         }
00457     }
00458 
00459     <span class="keywordflow">if</span> (route==NULL)
00460     {
00461         <span class="comment">// create new route object</span>
00462         <a class="code" href="class_i_pv6_route.html">IPv6Route</a> *route = <span class="keyword">new</span> <a class="code" href="class_i_pv6_route.html">IPv6Route</a>(destPrefix, prefixLength, IPv6Route::FROM_RA);
00463         route-&gt;<a class="code" href="class_i_pv6_route.html#a3">setInterfaceID</a>(interfaceId);
00464         route-&gt;<a class="code" href="class_i_pv6_route.html#a5">setExpiryTime</a>(expiryTime);
00465         route-&gt;<a class="code" href="class_i_pv6_route.html#a6">setMetric</a>(0);
00466 
00467         <span class="comment">// then add it</span>
00468         <a class="code" href="class_routing_table6.html#d0">addRoute</a>(route);
00469     }
00470     <span class="keywordflow">else</span>
00471     {
00472         <span class="comment">// update existing one</span>
00473         route-&gt;<a class="code" href="class_i_pv6_route.html#a3">setInterfaceID</a>(interfaceId);
00474         route-&gt;<a class="code" href="class_i_pv6_route.html#a5">setExpiryTime</a>(expiryTime);
00475     }
00476 
00477     <a class="code" href="class_routing_table6.html#b0">updateDisplayString</a>();
00478 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z57_2" doxytag="RoutingTable6::addOrUpdateOwnAdvPrefix"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::addOrUpdateOwnAdvPrefix           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>destPrefix</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>prefixLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>interfaceId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>simtime_t&nbsp;</td>
          <td class="mdname" nowrap> <em>expiryTime</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add route of type OWN_ADV_PREFIX. This is a prefix that *this* router advertises on this interface. <div class="fragment"><pre class="fragment">00482 {
00483     <span class="comment">// FIXME this is very similar to the one above -- refactor!!</span>
00484 
00485     <span class="comment">// see if prefix exists in table</span>
00486     <a class="code" href="class_i_pv6_route.html">IPv6Route</a> *<a class="code" href="class_routing_table6.html#z57_8">route</a> = NULL;
00487     <span class="keywordflow">for</span> (RouteList::iterator it=<a class="code" href="class_routing_table6.html#r3">routeList</a>.begin(); it!=<a class="code" href="class_routing_table6.html#r3">routeList</a>.end(); it++)
00488     {
00489         <span class="keywordflow">if</span> ((*it)-&gt;src()==<a class="code" href="class_i_pv6_route.html#w4w1">IPv6Route::OWN_ADV_PREFIX</a> &amp;&amp; (*it)-&gt;destPrefix()==destPrefix &amp;&amp; (*it)-&gt;prefixLength()==prefixLength)
00490         {
00491             route = *it;
00492             <span class="keywordflow">break</span>;
00493         }
00494     }
00495 
00496     <span class="keywordflow">if</span> (route==NULL)
00497     {
00498         <span class="comment">// create new route object</span>
00499         <a class="code" href="class_i_pv6_route.html">IPv6Route</a> *route = <span class="keyword">new</span> <a class="code" href="class_i_pv6_route.html">IPv6Route</a>(destPrefix, prefixLength, IPv6Route::OWN_ADV_PREFIX);
00500         route-&gt;<a class="code" href="class_i_pv6_route.html#a3">setInterfaceID</a>(interfaceId);
00501         route-&gt;<a class="code" href="class_i_pv6_route.html#a5">setExpiryTime</a>(expiryTime);
00502         route-&gt;<a class="code" href="class_i_pv6_route.html#a6">setMetric</a>(0);
00503 
00504         <span class="comment">// then add it</span>
00505         <a class="code" href="class_routing_table6.html#d0">addRoute</a>(route);
00506     }
00507     <span class="keywordflow">else</span>
00508     {
00509         <span class="comment">// update existing one</span>
00510         route-&gt;<a class="code" href="class_i_pv6_route.html#a3">setInterfaceID</a>(interfaceId);
00511         route-&gt;<a class="code" href="class_i_pv6_route.html#a5">setExpiryTime</a>(expiryTime);
00512     }
00513 
00514     <a class="code" href="class_routing_table6.html#b0">updateDisplayString</a>();
00515 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d0" doxytag="RoutingTable6::addRoute"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::addRoute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_route.html">IPv6Route</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>route</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00580 {
00581     <a class="code" href="class_routing_table6.html#r3">routeList</a>.push_back(route);
00582 
00583     <span class="comment">// we keep entries sorted by prefix length in routeList, so that we can</span>
00584     <span class="comment">// stop at the first match when doing the longest prefix matching</span>
00585     std::sort(<a class="code" href="class_routing_table6.html#r3">routeList</a>.begin(), <a class="code" href="class_routing_table6.html#r3">routeList</a>.end(), <a class="code" href="class_routing_table6.html#h0">routeLessThan</a>);
00586 
00587     <a class="code" href="class_routing_table6.html#b0">updateDisplayString</a>();
00588 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z57_5" doxytag="RoutingTable6::addRoutingProtocolRoute"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::addRoutingProtocolRoute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_route.html">IPv6Route</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>route</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds the given route (which can be <a class="el" href="namespace_o_s_p_f.html">OSPF</a>, BGP, RIP or any other route) with src==ROUTING_PROT. To store additional information with the route, one can subclass from <a class="el" href="class_i_pv6_route.html">IPv6Route</a> and add more fields. <div class="fragment"><pre class="fragment">00564 {
00565     ASSERT(route-&gt;<a class="code" href="class_i_pv6_route.html#a9">src</a>()==<a class="code" href="class_i_pv6_route.html#w4w3">IPv6Route::ROUTING_PROT</a>);
00566     <a class="code" href="class_routing_table6.html#d0">addRoute</a>(route);
00567 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z57_3" doxytag="RoutingTable6::addStaticRoute"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::addStaticRoute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>destPrefix</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>prefixLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>interfaceId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>nextHop</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>metric</em> = <code>0</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Creates a static route. If metric is omitted, it gets initialized to the interface's metric value. <div class="fragment"><pre class="fragment">00535 {
00536     <span class="comment">// create route object</span>
00537     <a class="code" href="class_i_pv6_route.html">IPv6Route</a> *<a class="code" href="class_routing_table6.html#z57_8">route</a> = <span class="keyword">new</span> <a class="code" href="class_i_pv6_route.html">IPv6Route</a>(destPrefix, prefixLength, IPv6Route::STATIC);
00538     route-&gt;<a class="code" href="class_i_pv6_route.html#a3">setInterfaceID</a>(interfaceId);
00539     route-&gt;<a class="code" href="class_i_pv6_route.html#a4">setNextHop</a>(nextHop);
00540     <span class="keywordflow">if</span> (metric==0)
00541     {
00542         metric = 10; <span class="comment">// TBD should be filled from interface metric</span>
00543     }
00544     route-&gt;<a class="code" href="class_i_pv6_route.html#a6">setMetric</a>(metric);
00545 
00546     <span class="comment">// then add it</span>
00547     <a class="code" href="class_routing_table6.html#d0">addRoute</a>(route);
00548 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d2" doxytag="RoutingTable6::assignRequiredNodeAddresses"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::assignRequiredNodeAddresses           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ie</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
RFC 3513: Section 2.8 A Node's Required Address Assign the various addresses to the node's respective interface. This should be done when the <a class="el" href="class_i_pv6.html">IPv6</a> Protocol stack is created. <div class="fragment"><pre class="fragment">00197 {
00198     <span class="comment">//RFC 3513 Section 2.8:A Node's Required Addresses</span>
00199     <span class="comment">/*A host is required to recognize the following addresses as</span>
00200 <span class="comment">    identifying itself:*/</span>
00201 
00202     <span class="comment">//o  The loopback address.</span>
00203     <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a15">isLoopback</a>())
00204     {
00205         ie-&gt;<a class="code" href="class_interface_entry.html#a34">ipv6</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#z48_0">assignAddress</a>(<a class="code" href="class_i_pv6_address.html">IPv6Address</a>(<span class="stringliteral">"::1"</span>), <span class="keyword">false</span>, 0, 0);
00206         <span class="keywordflow">return</span>;
00207     }
00208     <span class="comment">//o  Its required Link-Local Address for each interface.</span>
00209     <span class="comment">//IPv6Address linkLocalAddr = IPv6Address().formLinkLocalAddress(ie-&gt;interfaceToken());</span>
00210     <span class="comment">//ie-&gt;ipv6()-&gt;assignAddress(linkLocalAddr, true, 0, 0);</span>
00211 
00212     <span class="comment">/*o  Any additional Unicast and Anycast Addresses that have been configured</span>
00213 <span class="comment">    for the node's interfaces (manually or automatically).*/</span>
00214 
00215     <span class="comment">// FIXME FIXME Andras: commented out the following lines, because these addresses</span>
00216     <span class="comment">// are implicitly checked for in localDeliver()  (we don't want redundancy,</span>
00217     <span class="comment">// and manually adding solicited-node mcast address for each and every address</span>
00218     <span class="comment">// is very error-prone!)</span>
00219     <span class="comment">//</span>
00220     <span class="comment">//o  The All-Nodes Multicast Addresses defined in section 2.7.1.</span>
00221 
00222     <span class="comment">/*o  The Solicited-Node Multicast Address for each of its unicast and anycast</span>
00223 <span class="comment">    addresses.*/</span>
00224 
00225     <span class="comment">//o  Multicast Addresses of all other groups to which the node belongs.</span>
00226 
00227     <span class="comment">/*A router is required to recognize all addresses that a host is</span>
00228 <span class="comment">    required to recognize, plus the following addresses as identifying</span>
00229 <span class="comment">    itself:*/</span>
00230     <span class="comment">/*o  The Subnet-Router Anycast Addresses for all interfaces for</span>
00231 <span class="comment">    which it is configured to act as a router.*/</span>
00232 
00233     <span class="comment">//o  All other Anycast Addresses with which the router has been configured.</span>
00234     <span class="comment">//o  The All-Routers Multicast Addresses defined in section 2.7.1.</span>
00235 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d1" doxytag="RoutingTable6::configureInterfaceForIPv6"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::configureInterfaceForIPv6           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ie</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00179 {
00180     <a class="code" href="class_i_pv6_interface_data.html">IPv6InterfaceData</a> *ipv6IfData = <span class="keyword">new</span> <a class="code" href="class_i_pv6_interface_data.html">IPv6InterfaceData</a>();
00181     ie-&gt;<a class="code" href="class_interface_entry.html#a38">setIPv6Data</a>(ipv6IfData);
00182 
00183     <span class="comment">// for routers, turn on advertisements by default</span>
00184     <span class="comment">//FIXME: we will use this isRouter flag for now. what if future implementations</span>
00185     <span class="comment">//have 2 interfaces where one interface is configured as a router and the other</span>
00186     <span class="comment">//as a host?</span>
00187     ipv6IfData-&gt;<a class="code" href="class_i_pv6_interface_data.html#z48_68">setAdvSendAdvertisements</a>(isrouter);<span class="comment">//Added by WEI</span>
00188 
00189     <span class="comment">// metric: some hints: OSPF cost (2e9/bps value), MS KB article Q299540, ...</span>
00190     <span class="comment">//d-&gt;setMetric((int)ceil(2e9/ie-&gt;datarate())); // use OSPF cost as default</span>
00191     <span class="comment">//FIXME TBD fill in the rest</span>
00192 
00193     <a class="code" href="class_routing_table6.html#d2">assignRequiredNodeAddresses</a>(ie);
00194 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d3" doxytag="RoutingTable6::configureInterfaceFromXML"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::configureInterfaceFromXML           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>cXMLElement *&nbsp;</td>
          <td class="mdname" nowrap> <em>cfg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00253 {
00254     <span class="comment">/*XML parsing capabilities tweaked by WEI. For now, we can configure a specific</span>
00255 <span class="comment">    node's interface. We can set advertising prefixes and other variables to be used</span>
00256 <span class="comment">    in RAs. The IPv6 interface data gets overwritten if lines 249 to 262 is uncommented.</span>
00257 <span class="comment">    The fix is to create an XML file with all the default values. Customised XML files</span>
00258 <span class="comment">    can be used for future protocols that requires different values. (MIPv6)*/</span>
00259     <a class="code" href="class_i_pv6_interface_data.html">IPv6InterfaceData</a> *d = ie-&gt;<a class="code" href="class_interface_entry.html#a34">ipv6</a>();
00260 
00261     <span class="comment">// parse basic config (attributes)</span>
00262     d-&gt;<a class="code" href="class_i_pv6_interface_data.html#z48_68">setAdvSendAdvertisements</a>(toBool(getRequiredAttr(cfg, <span class="stringliteral">"AdvSendAdvertisements"</span>)));
00263     <span class="comment">//TODO: leave this off first!! They overwrite stuff!</span>
00264 <span class="comment">/* TODO: Wei commented out the stuff below. To be checked why (Andras).</span>
00265 <span class="comment">    d-&gt;setMaxRtrAdvInterval(OPP_Global::atod(getRequiredAttr(cfg, "MaxRtrAdvInterval")));</span>
00266 <span class="comment">    d-&gt;setMinRtrAdvInterval(OPP_Global::atod(getRequiredAttr(cfg, "MinRtrAdvInterval")));</span>
00267 <span class="comment">    d-&gt;setAdvManagedFlag(toBool(getRequiredAttr(cfg, "AdvManagedFlag")));</span>
00268 <span class="comment">    d-&gt;setAdvOtherConfigFlag(toBool(getRequiredAttr(cfg, "AdvOtherConfigFlag")));</span>
00269 <span class="comment">    d-&gt;setAdvLinkMTU(OPP_Global::atoul(getRequiredAttr(cfg, "AdvLinkMTU")));</span>
00270 <span class="comment">    d-&gt;setAdvReachableTime(OPP_Global::atoul(getRequiredAttr(cfg, "AdvReachableTime")));</span>
00271 <span class="comment">    d-&gt;setAdvRetransTimer(OPP_Global::atoul(getRequiredAttr(cfg, "AdvRetransTimer")));</span>
00272 <span class="comment">    d-&gt;setAdvCurHopLimit(OPP_Global::atoul(getRequiredAttr(cfg, "AdvCurHopLimit")));</span>
00273 <span class="comment">    d-&gt;setAdvDefaultLifetime(OPP_Global::atoul(getRequiredAttr(cfg, "AdvDefaultLifetime")));</span>
00274 <span class="comment">    ie-&gt;setMtu(OPP_Global::atoul(getRequiredAttr(cfg, "HostLinkMTU")));</span>
00275 <span class="comment">    d-&gt;setCurHopLimit(OPP_Global::atoul(getRequiredAttr(cfg, "HostCurHopLimit")));</span>
00276 <span class="comment">    d-&gt;setBaseReachableTime(OPP_Global::atoul(getRequiredAttr(cfg, "HostBaseReachableTime")));</span>
00277 <span class="comment">    d-&gt;setRetransTimer(OPP_Global::atoul(getRequiredAttr(cfg, "HostRetransTimer")));</span>
00278 <span class="comment">    d-&gt;setDupAddrDetectTransmits(OPP_Global::atoul(getRequiredAttr(cfg, "HostDupAddrDetectTransmits")));</span>
00279 <span class="comment">*/</span>
00280 
00281     <span class="comment">// parse prefixes (AdvPrefix elements; they should be inside an AdvPrefixList</span>
00282     <span class="comment">// element, but we don't check that)</span>
00283     cXMLElementList prefixList = cfg-&gt;getElementsByTagName(<span class="stringliteral">"AdvPrefix"</span>);
00284     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;prefixList.size(); i++)
00285     {
00286         cXMLElement *node = prefixList[i];
00287         <a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html">IPv6InterfaceData::AdvPrefix</a> prefix;
00288 
00289         <span class="comment">// FIXME todo implement: advValidLifetime, advPreferredLifetime can</span>
00290         <span class="comment">// store (absolute) expiry time (if &gt;0) or lifetime (delta) (if &lt;0);</span>
00291         <span class="comment">// 0 should be treated as infinity</span>
00292         <span class="keywordtype">int</span> pfxLen;
00293         <span class="keywordflow">if</span> (!prefix.<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#o0">prefix</a>.<a class="code" href="class_i_pv6_address.html#a9">tryParseAddrWithPrefix</a>(node-&gt;getNodeValue(),pfxLen))
00294             opp_error(<span class="stringliteral">"element &lt;%s&gt; at %s: wrong IPv6Address/prefix syntax %s"</span>,
00295                       node-&gt;getTagName(), node-&gt;getSourceLocation(), node-&gt;getNodeValue());
00296         prefix.<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#o1">prefixLength</a> = pfxLen;
00297         prefix.<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#o2">advValidLifetime</a> = <a class="code" href="namespace_o_p_p___global.html#a3">OPP_Global::atoul</a>(getRequiredAttr(node, <span class="stringliteral">"AdvValidLifetime"</span>));
00298         prefix.<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#o3">advOnLinkFlag</a> = toBool(getRequiredAttr(node, <span class="stringliteral">"AdvOnLinkFlag"</span>));
00299         prefix.<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#o4">advPreferredLifetime</a> = <a class="code" href="namespace_o_p_p___global.html#a3">OPP_Global::atoul</a>(getRequiredAttr(node, <span class="stringliteral">"AdvPreferredLifetime"</span>));
00300         prefix.<a class="code" href="struct_i_pv6_interface_data_1_1_adv_prefix.html#o5">advAutonomousFlag</a> = toBool(getRequiredAttr(node, <span class="stringliteral">"AdvAutonomousFlag"</span>));
00301         d-&gt;<a class="code" href="class_i_pv6_interface_data.html#z50_0">addAdvPrefix</a>(prefix);
00302     }
00303 
00304     <span class="comment">// parse addresses</span>
00305     cXMLElementList addrList = cfg-&gt;getChildrenByTagName(<span class="stringliteral">"inetAddr"</span>);
00306     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k=0; k&lt;addrList.size(); k++)
00307     {
00308         cXMLElement *node = addrList[k];
00309         <a class="code" href="class_i_pv6_address.html">IPv6Address</a> address(node-&gt;getNodeValue());
00310         <span class="comment">//We can now decide if the address is tentative or not.</span>
00311         d-&gt;<a class="code" href="class_i_pv6_interface_data.html#z48_0">assignAddress</a>(address, toBool(getRequiredAttr(node, <span class="stringliteral">"tentative"</span>)), 0, 0);  <span class="comment">// set up with infinite lifetimes</span>
00312     }
00313 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z54_2" doxytag="RoutingTable6::doLongestPrefixMatch"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_route.html">IPv6Route</a> * RoutingTable6::doLongestPrefixMatch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dest</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Performs longest prefix match in the routing table and returns the resulting route, or NULL if there was no match. <div class="fragment"><pre class="fragment">00379 {
00380     Enter_Method(<span class="stringliteral">"doLongestPrefixMatch(%s)"</span>, dest.<a class="code" href="class_i_pv6_address.html#a11">str</a>().c_str());
00381 
00382     <span class="comment">// we'll just stop at the first match, because the table is sorted</span>
00383     <span class="comment">// by prefix lengths and metric (see addRoute())</span>
00384     <span class="keywordflow">for</span> (RouteList::iterator it=<a class="code" href="class_routing_table6.html#r3">routeList</a>.begin(); it!=<a class="code" href="class_routing_table6.html#r3">routeList</a>.end(); it++)
00385     {
00386         <span class="keywordflow">if</span> (dest.<a class="code" href="class_i_pv6_address.html#a21">matches</a>((*it)-&gt;destPrefix(),(*it)-&gt;prefixLength()))
00387         {
00388             <span class="comment">// FIXME proofread this code, iterator invalidation-wise, etc</span>
00389             <span class="keywordtype">bool</span> entryExpired = <span class="keyword">false</span>;
00390             <span class="keywordflow">if</span> (simTime() &gt; (*it)-&gt;expiryTime() &amp;&amp; (*it)-&gt;expiryTime() != 0)<span class="comment">//since 0 represents infinity.</span>
00391             {
00392                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Expired prefix detected!!"</span> &lt;&lt; endl;
00393                 <a class="code" href="class_routing_table6.html#z57_1">removeOnLinkPrefix</a>((*it)-&gt;destPrefix(), (*it)-&gt;prefixLength());
00394                 entryExpired = <span class="keyword">true</span>;
00395             }
00396             <span class="keywordflow">if</span> (entryExpired == <span class="keyword">false</span>) return *it;
00397         }
00398     }
00399     <span class="comment">// FIXME todo: if we selected an expired route, throw it out and select again!</span>
00400     return NULL;
00401 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="RoutingTable6::handleMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::handleMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Raises an error. <div class="fragment"><pre class="fragment">00174 {
00175     opp_error(<span class="stringliteral">"This module doesn't process messages"</span>);
00176 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="RoutingTable6::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>stage</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00085 {
00086     <span class="keywordflow">if</span> (stage==1)
00087     {
00088         <a class="code" href="class_routing_table6.html#r0">ift</a> = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a>().get();
00089 
00090         WATCH_PTRVECTOR(routeList);
00091         WATCH_MAP(destCache); <span class="comment">// FIXME commented out for now</span>
00092         <a class="code" href="class_routing_table6.html#r1">isrouter</a> = par(<span class="stringliteral">"isRouter"</span>);
00093         WATCH(isrouter);
00094 
00095         <span class="comment">// add IPv6InterfaceData to interfaces</span>
00096         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ift-&gt;numInterfaces(); i++)
00097         {
00098             <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = <a class="code" href="class_routing_table6.html#r0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(i);
00099             <a class="code" href="class_routing_table6.html#d1">configureInterfaceForIPv6</a>(ie);
00100         }
00101 
00102         <a class="code" href="class_routing_table6.html#b3">parseXMLConfigFile</a>();
00103 
00104         <span class="comment">// skip hosts</span>
00105         <span class="keywordflow">if</span> (isrouter)
00106         {
00107             <span class="comment">// add globally routable prefixes to routing table</span>
00108             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; ift-&gt;numInterfaces(); x++)
00109             {
00110                 <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = <a class="code" href="class_routing_table6.html#r0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(x);
00111 
00112                 <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a15">isLoopback</a>())
00113                     <span class="keywordflow">continue</span>;
00114 
00115                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; ie-&gt;ipv6()-&gt;numAdvPrefixes(); y++)
00116                     if (ie-&gt;ipv6()-&gt;advPrefix(y).prefix.isGlobal())
00117                         addOrUpdateOwnAdvPrefix(ie-&gt;ipv6()-&gt;advPrefix(y).prefix,
00118                                                 ie-&gt;ipv6()-&gt;advPrefix(y).prefixLength,
00119                                                 x, 0);
00120             }
00121         }
00122     }
00123     else if (stage==4)
00124     {
00125         <span class="comment">// configurator adds routes only in stage==3</span>
00126         <a class="code" href="class_routing_table6.html#b0">updateDisplayString</a>();
00127     }
00128 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z52_0" doxytag="RoutingTable6::interfaceByAddress"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> * RoutingTable6::interfaceByAddress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>address</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns an interface given by its address. Returns NULL if not found. <div class="fragment"><pre class="fragment">00316 {
00317     Enter_Method(<span class="stringliteral">"interfaceByAddress(%s)=?"</span>, addr.<a class="code" href="class_i_pv6_address.html#a11">str</a>().c_str());
00318 
00319     <span class="keywordflow">if</span> (addr.<a class="code" href="class_i_pv6_address.html#a22">isUnspecified</a>())
00320         <span class="keywordflow">return</span> NULL;
00321     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ift-&gt;numInterfaces(); ++i)
00322     {
00323         <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = <a class="code" href="class_routing_table6.html#r0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(i);
00324         <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a34">ipv6</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#z48_5">hasAddress</a>(addr))
00325             <span class="keywordflow">return</span> ie;
00326     }
00327     <span class="keywordflow">return</span> NULL;
00328 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z54_3" doxytag="RoutingTable6::isPrefixPresent"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool RoutingTable6::isPrefixPresent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>prefix</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Checks if the given prefix already exists in the routing table (prefix list) <div class="fragment"><pre class="fragment">00404 {
00405     <span class="keywordflow">for</span> (RouteList::iterator it=<a class="code" href="class_routing_table6.html#r3">routeList</a>.begin(); it!=<a class="code" href="class_routing_table6.html#r3">routeList</a>.end(); it++)
00406         <span class="keywordflow">if</span> (prefix.<a class="code" href="class_i_pv6_address.html#a21">matches</a>((*it)-&gt;destPrefix(),128))
00407             <span class="keywordflow">return</span> <span class="keyword">true</span>;
00408     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00409 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="RoutingTable6::isRouter"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool RoutingTable6::isRouter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<a class="el" href="class_i_p.html">IP</a> forwarding on/off <div class="fragment"><pre class="fragment">00171 {<span class="keywordflow">return</span> <a class="code" href="class_routing_table6.html#r1">isrouter</a>;}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z54_0" doxytag="RoutingTable6::localDeliver"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool RoutingTable6::localDeliver           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dest</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Checks if the address is one of the host's addresses, i.e. assigned to one of its interfaces (tentatively or not). <div class="fragment"><pre class="fragment">00331 {
00332     Enter_Method(<span class="stringliteral">"localDeliver(%s) y/n"</span>, dest.<a class="code" href="class_i_pv6_address.html#a11">str</a>().c_str());
00333 
00334     <span class="comment">// first, check if we have an interface with this address</span>
00335     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ift-&gt;numInterfaces(); i++)
00336     {
00337         <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = <a class="code" href="class_routing_table6.html#r0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(i);
00338         <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a34">ipv6</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#z48_5">hasAddress</a>(dest))
00339             <span class="keywordflow">return</span> <span class="keyword">true</span>;
00340     }
00341 
00342     <span class="comment">// then check for special, preassigned multicast addresses</span>
00343     <span class="comment">// (these addresses occur more rarely than specific interface addresses,</span>
00344     <span class="comment">// that's why we check for them last)</span>
00345 
00346     <span class="keywordflow">if</span> (dest==IPv6Address::ALL_NODES_1 || dest==IPv6Address::ALL_NODES_2)
00347         return true;
00348     if (isRouter() &amp;&amp; (dest==<a class="code" href="class_i_pv6_address.html">IPv6Address</a>::ALL_ROUTERS_1 || dest==<a class="code" href="class_i_pv6_address.html">IPv6Address</a>::ALL_ROUTERS_2 || dest==<a class="code" href="class_i_pv6_address.html">IPv6Address</a>::ALL_ROUTERS_5))
00349         return true;
00350 
00351     <span class="comment">// check for solicited-node multicast address</span>
00352     if (dest.matches(<a class="code" href="class_i_pv6_address.html">IPv6Address</a>::SOLICITED_NODE_PREFIX, 104))
00353     {
00354         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ift-&gt;numInterfaces(); i++)
00355         {
00356             <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = <a class="code" href="class_routing_table6.html#r0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(i);
00357             <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a34">ipv6</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#z48_6">matchesSolicitedNodeMulticastAddress</a>(dest))
00358                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00359         }
00360     }
00361     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00362 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z54_1" doxytag="RoutingTable6::lookupDestCache"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp; RoutingTable6::lookupDestCache           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>outInterfaceId</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Looks up the given destination address in the Destination Cache, then returns the next-hop address and the interface in the outInterfaceId variable. If the destination is not in the cache, outInterfaceId is set to -1 and the unspecified address is returned. The caller should check for interfaceId==-1, because unspecified address is also returned if the link layer doesn't use addresses at all (e.g. <a class="el" href="class_p_p_p.html">PPP</a>).<p>
NOTE: outInterfaceId is an OUTPUT parameter -- its initial value is ignored, and the <a class="el" href="class_routing_table6.html#z54_1">lookupDestCache()</a> sets it to the correct value instead. <div class="fragment"><pre class="fragment">00365 {
00366     Enter_Method(<span class="stringliteral">"lookupDestCache(%s)"</span>, dest.<a class="code" href="class_i_pv6_address.html#a11">str</a>().c_str());
00367 
00368     DestCache::iterator it = <a class="code" href="class_routing_table6.html#r2">destCache</a>.find(dest);
00369     <span class="keywordflow">if</span> (it == <a class="code" href="class_routing_table6.html#r2">destCache</a>.end())
00370     {
00371         outInterfaceId = -1;
00372         <span class="keywordflow">return</span> <a class="code" href="class_i_pv6_address.html#z33_0">IPv6Address::UNSPECIFIED_ADDRESS</a>;
00373     }
00374     outInterfaceId = it-&gt;second.interfaceId;
00375     <span class="keywordflow">return</span> it-&gt;second.nextHopAddr;
00376 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="RoutingTable6::numInitStages"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int RoutingTable6::numInitStages           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00150 {<span class="keywordflow">return</span> 5;}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z57_7" doxytag="RoutingTable6::numRoutes"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int RoutingTable6::numRoutes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the number of routes. <div class="fragment"><pre class="fragment">00600 {
00601     <span class="keywordflow">return</span> <a class="code" href="class_routing_table6.html#r3">routeList</a>.size();
00602 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="RoutingTable6::parseXMLConfigFile"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::parseXMLConfigFile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00131 {
00132     <span class="comment">// TODO to be revised by Andras</span>
00133     <span class="comment">// configure interfaces from XML config file</span>
00134     cXMLElement *config = par(<span class="stringliteral">"routingTableFile"</span>);
00135     <span class="keywordflow">for</span> (cXMLElement *child=config-&gt;getFirstChild(); child; child = child-&gt;getNextSibling())
00136     {
00137         <span class="comment">//std::cout &lt;&lt; "configuring interfaces from XML file." &lt;&lt; endl;</span>
00138         <span class="comment">//std::cout &lt;&lt; "selected element is: " &lt;&lt; child-&gt;getTagName() &lt;&lt; endl;</span>
00139         <span class="comment">// we ensure that the selected element is local.</span>
00140         <span class="keywordflow">if</span> (opp_strcmp(child-&gt;getTagName(),<span class="stringliteral">"local"</span>)!=0) <span class="keywordflow">continue</span>;
00141         <span class="comment">//ensure that this is the right parent module we are configuring.</span>
00142         <span class="keywordflow">if</span> (opp_strcmp(child-&gt;getAttribute(<span class="stringliteral">"node"</span>),parentModule()-&gt;fullName())!=0)
00143             <span class="keywordflow">continue</span>;
00144         <span class="comment">//Go one level deeper.</span>
00145         <span class="comment">//child = child-&gt;getFirstChild();</span>
00146         <span class="keywordflow">for</span> (cXMLElement *ifTag=child-&gt;getFirstChild(); ifTag; ifTag = ifTag-&gt;getNextSibling())
00147         {
00148             <span class="comment">//The next tag should be "interface".</span>
00149             <span class="keywordflow">if</span> (opp_strcmp(ifTag-&gt;getTagName(),<span class="stringliteral">"interface"</span>)!=0)
00150                 <span class="keywordflow">continue</span>;
00151             <span class="comment">//std::cout &lt;&lt; "Getting attribute: name" &lt;&lt; endl;</span>
00152             <span class="keyword">const</span> <span class="keywordtype">char</span> *ifname = ifTag-&gt;getAttribute(<span class="stringliteral">"name"</span>);
00153             <span class="keywordflow">if</span> (!ifname)
00154                 error("&lt;interface&gt; without name attribute at %s", child-&gt;getSourceLocation());
00155             <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = ift-&gt;interfaceByName(ifname);
00156             if (!ie)
00157                 error("no interface named %s was registered, %s", ifname, child-&gt;getSourceLocation());
00158             configureInterfaceFromXML(ie, ifTag);
00159         }
00160     }
00161 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z55_1" doxytag="RoutingTable6::purgeDestCache"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::purgeDestCache           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Discard all entries in destination cache <div class="fragment"><pre class="fragment">00421 {
00422     <a class="code" href="class_routing_table6.html#r2">destCache</a>.clear();
00423     <a class="code" href="class_routing_table6.html#b0">updateDisplayString</a>();
00424 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z55_2" doxytag="RoutingTable6::purgeDestCacheEntriesToNeighbour"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::purgeDestCacheEntriesToNeighbour           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>nextHopAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>interfaceId</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Discard all entries in destination cache where next hop is the given address on the given interface. This is typically called when a router becomes unreachable, and all destinations going via that router have to go though router selection again. <div class="fragment"><pre class="fragment">00427 {
00428     <span class="keywordflow">for</span> (DestCache::iterator it=<a class="code" href="class_routing_table6.html#r2">destCache</a>.begin(); it!=<a class="code" href="class_routing_table6.html#r2">destCache</a>.end(); )
00429     {
00430         <span class="keywordflow">if</span> (it-&gt;second.interfaceId==interfaceId &amp;&amp; it-&gt;second.nextHopAddr==nextHopAddr)
00431         {
00432             <span class="comment">// move the iterator past this element before removing it</span>
00433             DestCache::iterator oldIt = it++;
00434             <a class="code" href="class_routing_table6.html#r2">destCache</a>.erase(oldIt);
00435         }
00436         <span class="keywordflow">else</span>
00437         {
00438             it++;
00439         }
00440     }
00441 
00442     <a class="code" href="class_routing_table6.html#b0">updateDisplayString</a>();
00443 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z57_1" doxytag="RoutingTable6::removeOnLinkPrefix"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::removeOnLinkPrefix           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>destPrefix</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>prefixLength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remove an on-link prefix. To be called when the prefix gets advertised with zero lifetime, or to purge an expired prefix.<p>
NOTE: This method does NOT remove the matching addresses from the <a class="el" href="class_interface_table.html">InterfaceTable</a> (see <a class="el" href="class_i_pv6_interface_data.html">IPv6InterfaceData</a>); that has to be done separately. <div class="fragment"><pre class="fragment">00518 {
00519     <span class="comment">// scan the routing table for this prefix and remove it</span>
00520     <span class="keywordflow">for</span> (RouteList::iterator it=<a class="code" href="class_routing_table6.html#r3">routeList</a>.begin(); it!=<a class="code" href="class_routing_table6.html#r3">routeList</a>.end(); it++)
00521     {
00522         <span class="keywordflow">if</span> ((*it)-&gt;src()==<a class="code" href="class_i_pv6_route.html#w4w0">IPv6Route::FROM_RA</a> &amp;&amp; (*it)-&gt;destPrefix()==destPrefix &amp;&amp; (*it)-&gt;prefixLength()==prefixLength)
00523         {
00524             <a class="code" href="class_routing_table6.html#r3">routeList</a>.erase(it);
00525             <span class="keywordflow">return</span>; <span class="comment">// there can be only one such route, addOrUpdateOnLinkPrefix() guarantees that</span>
00526         }
00527     }
00528 
00529     <a class="code" href="class_routing_table6.html#b0">updateDisplayString</a>();
00530 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z57_6" doxytag="RoutingTable6::removeRoute"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::removeRoute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_route.html">IPv6Route</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>route</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deletes the given route from the route table. <div class="fragment"><pre class="fragment">00591 {
00592     RouteList::iterator it = <a class="code" href="_r_s_v_p___t_e_2_utils_8cc.html#a2">std::find</a>(<a class="code" href="class_routing_table6.html#r3">routeList</a>.begin(), <a class="code" href="class_routing_table6.html#r3">routeList</a>.end(), route);
00593     ASSERT(it!=<a class="code" href="class_routing_table6.html#r3">routeList</a>.end());
00594     <a class="code" href="class_routing_table6.html#r3">routeList</a>.erase(it);
00595 
00596     <a class="code" href="class_routing_table6.html#b0">updateDisplayString</a>();
00597 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z57_8" doxytag="RoutingTable6::route"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_route.html">IPv6Route</a> * RoutingTable6::route           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the ith route. <div class="fragment"><pre class="fragment">00605 {
00606     ASSERT(i&gt;=0 &amp;&amp; i&lt;<a class="code" href="class_routing_table6.html#r3">routeList</a>.size());
00607     <span class="keywordflow">return</span> <a class="code" href="class_routing_table6.html#r3">routeList</a>[i];
00608 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="h0" doxytag="RoutingTable6::routeLessThan"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool RoutingTable6::routeLessThan           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_route.html">IPv6Route</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="class_i_pv6_route.html">IPv6Route</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>b</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static, private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00570 {
00571     <span class="comment">// helper for sort() in addRoute(). We want routes with longer</span>
00572     <span class="comment">// prefixes to be at front, so we compare them as "less".</span>
00573     <span class="comment">// For metric, a smaller value is better (we report that as "less").</span>
00574     <span class="keywordflow">if</span> (a-&gt;<a class="code" href="class_i_pv6_route.html#a8">prefixLength</a>()!=b-&gt;<a class="code" href="class_i_pv6_route.html#a8">prefixLength</a>())
00575         <span class="keywordflow">return</span> a-&gt;<a class="code" href="class_i_pv6_route.html#a8">prefixLength</a>() &gt; b-&gt;<a class="code" href="class_i_pv6_route.html#a8">prefixLength</a>();
00576     <span class="keywordflow">return</span> a-&gt;<a class="code" href="class_i_pv6_route.html#a13">metric</a>() &lt; b-&gt;<a class="code" href="class_i_pv6_route.html#a13">metric</a>();
00577 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z55_0" doxytag="RoutingTable6::updateDestCache"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::updateDestCache           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="class_i_pv6_address.html">IPv6Address</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>nextHopAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>interfaceId</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add or update a destination cache entry. <div class="fragment"><pre class="fragment">00412 {
00413     <span class="comment">// FIXME this performs 2 lookups -- optimize to do only one</span>
00414     <a class="code" href="class_routing_table6.html#r2">destCache</a>[dest].nextHopAddr = nextHopAddr;
00415     <a class="code" href="class_routing_table6.html#r2">destCache</a>[dest].interfaceId = interfaceId;
00416 
00417     <a class="code" href="class_routing_table6.html#b0">updateDisplayString</a>();
00418 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="RoutingTable6::updateDisplayString"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RoutingTable6::updateDisplayString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00164 {
00165     <span class="keywordflow">if</span> (!ev.isGUI())
00166         <span class="keywordflow">return</span>;
00167 
00168     <span class="keywordtype">char</span> buf[80];
00169     sprintf(buf, <span class="stringliteral">"%d routes\n%d destcache entries"</span>, <a class="code" href="class_routing_table6.html#z57_7">numRoutes</a>(), <a class="code" href="class_routing_table6.html#r2">destCache</a>.size());
00170     displayString().setTagArg(<span class="stringliteral">"t"</span>,0,buf);
00171 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Friends And Related Function Documentation</h2>
<a class="anchor" name="n0" doxytag="RoutingTable6::operator<<"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::ostream&amp; operator&lt;&lt;           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">std::ostream &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>os</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="struct_routing_table6_1_1_dest_cache_entry.html">DestCacheEntry</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [friend]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00069 {
00070     os &lt;&lt; <span class="stringliteral">"if="</span> &lt;&lt; e.interfaceId &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; e.nextHopAddr;  <span class="comment">//FIXME try printing interface name</span>
00071     <span class="keywordflow">return</span> os;
00072 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="r2" doxytag="RoutingTable6::destCache"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_routing_table6.html#y0">DestCache</a> <a class="el" href="class_routing_table6.html#r2">RoutingTable6::destCache</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="r0" doxytag="RoutingTable6::ift"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_table.html">InterfaceTable</a>* <a class="el" href="class_routing_table6.html#r0">RoutingTable6::ift</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="r1" doxytag="RoutingTable6::isrouter"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="class_routing_table6.html#r1">RoutingTable6::isrouter</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="r3" doxytag="RoutingTable6::routeList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_routing_table6.html#y1">RouteList</a> <a class="el" href="class_routing_table6.html#r3">RoutingTable6::routeList</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_routing_table6_8h.html">RoutingTable6.h</a><li><a class="el" href="_routing_table6_8cc.html">RoutingTable6.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:28 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
