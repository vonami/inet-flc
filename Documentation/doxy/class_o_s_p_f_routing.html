<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: OSPFRouting Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>OSPFRouting Class Reference</h1><code>#include &lt;OSPFRouting.h&gt;</code>
<p>
<a href="class_o_s_p_f_routing-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
OMNeT++ module class acting as a facade for the <a class="el" href="namespace_o_s_p_f.html">OSPF</a> datastructure. Handles the configuration loading and forwards the OMNeT++ messages (<a class="el" href="namespace_o_s_p_f.html">OSPF</a> packets). 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#a0">OSPFRouting</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#a1">~OSPFRouting</a> (void)</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#b0">numInitStages</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#b1">initialize</a> (int stage)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#b2">handleMessage</a> (cMessage *msg)</td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#d0">ResolveInterfaceName</a> (const std::string &amp;name) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#d1">GetAreaListFromXML</a> (const cXMLElement &amp;routerNode, std::map&lt; std::string, int &gt; &amp;areaList) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#d2">LoadAreaFromXML</a> (const cXMLElement &amp;asConfig, const std::string &amp;areaID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#d3">LoadInterfaceParameters</a> (const cXMLElement &amp;ifConfig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#d4">LoadExternalRoute</a> (const cXMLElement &amp;externalRouteConfig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#d5">LoadHostRoute</a> (const cXMLElement &amp;hostRouteConfig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#d6">LoadVirtualLink</a> (const cXMLElement &amp;virtualLinkConfig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#d7">LoadConfigFromXML</a> (const char *filename)</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_interface_table.html">InterfaceTable</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#r0">ift</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provides access to the interface table.  <a href="#r0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_routing_table.html">RoutingTable</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#r1">rt</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provides access to the <a class="el" href="class_i_p.html">IP</a> routing table.  <a href="#r1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_o_s_p_f_1_1_router.html">OSPF::Router</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_s_p_f_routing.html#r2">ospfRouter</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Root object of the <a class="el" href="namespace_o_s_p_f.html">OSPF</a> datastructure.  <a href="#r2"></a><br></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="OSPFRouting::OSPFRouting"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">OSPFRouting::OSPFRouting           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00041 {
00042     <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a> = NULL;
00043 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="OSPFRouting::~OSPFRouting"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">OSPFRouting::~<a class="el" href="class_o_s_p_f_routing.html">OSPFRouting</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destructor. Deletes the whole <a class="el" href="namespace_o_s_p_f.html">OSPF</a> datastructure. <div class="fragment"><pre class="fragment">00050 {
00051     <span class="keyword">delete</span> <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>;
00052 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="d1" doxytag="OSPFRouting::GetAreaListFromXML"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OSPFRouting::GetAreaListFromXML           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const cXMLElement &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>routerNode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::map&lt; std::string, int &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>areaList</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"> const<code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Loads a list of <a class="el" href="namespace_o_s_p_f.html">OSPF</a> Areas connected to this router from the config XML. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>routerNode</em>&nbsp;</td><td>[in] XML node describing this router. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>areaList</em>&nbsp;</td><td>[out] A hash of <a class="el" href="namespace_o_s_p_f.html">OSPF</a> Areas connected to this router. The hash key is the Area ID. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00113 {
00114     cXMLElementList routerConfig = routerNode.getChildren ();
00115     <span class="keywordflow">for</span> (cXMLElementList::iterator routerConfigIt = routerConfig.begin (); routerConfigIt != routerConfig.end (); routerConfigIt++) {
00116         std::string nodeName = (*routerConfigIt)-&gt;getTagName ();
00117         <span class="keywordflow">if</span> ((nodeName == <span class="stringliteral">"PointToPointInterface"</span>) ||
00118             (nodeName == <span class="stringliteral">"BroadcastInterface"</span>) ||
00119             (nodeName == <span class="stringliteral">"NBMAInterface"</span>) ||
00120             (nodeName == <span class="stringliteral">"PointToMultiPointInterface"</span>))
00121         {
00122             std::string areaId = (*routerConfigIt)-&gt;getChildrenByTagName (<span class="stringliteral">"AreaID"</span>)[0]-&gt;getNodeValue ();
00123             <span class="keywordflow">if</span> (areaList.find (areaId) == areaList.end ()) {
00124                 areaList[areaId] = 1;
00125             }
00126         }
00127     }
00128 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="OSPFRouting::handleMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OSPFRouting::handleMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Forwards <a class="el" href="namespace_o_s_p_f.html">OSPF</a> messages to the message handler object of the <a class="el" href="namespace_o_s_p_f.html">OSPF</a> datastructure. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>[in] The <a class="el" href="namespace_o_s_p_f.html">OSPF</a> message. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00089 {
00090 <span class="comment">//    if (simulation.eventNumber () == 90591) {</span>
00091 <span class="comment">//        __asm int 3;</span>
00092 <span class="comment">//    }</span>
00093     <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a7">GetMessageHandler</a> ()-&gt;MessageReceived (msg);
00094 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="OSPFRouting::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OSPFRouting::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>stage</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
OMNeT++ init method. Runs at stage 2 after interfaces are registered (stage 0) and the routing table is initialized (stage 1). Loads <a class="el" href="namespace_o_s_p_f.html">OSPF</a> configuration information from the config XML. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>stage</em>&nbsp;</td><td>[in] The initialization stage. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00063 {
00064     <span class="comment">// we have to wait for stage 2 until interfaces get registered (stage 0)</span>
00065     <span class="comment">// and routerId gets assigned (stage 3)</span>
00066     <span class="keywordflow">if</span> (stage == 4)
00067     {
00068         <a class="code" href="class_o_s_p_f_routing.html#r1">rt</a> = <a class="code" href="class_routing_table_access.html">RoutingTableAccess</a> ().get ();
00069         <a class="code" href="class_o_s_p_f_routing.html#r0">ift</a> = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a> ().get ();
00070 
00071         <span class="comment">// Get routerId</span>
00072         <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a> = <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_router.html">OSPF::Router</a> (<a class="code" href="class_o_s_p_f_routing.html#r1">rt</a>-&gt;<a class="code" href="class_routing_table.html#a4">routerId</a> ().<a class="code" href="class_i_p_address.html#a5">getInt</a> (), <span class="keyword">this</span>);
00073 
00074         <span class="comment">// read the OSPF AS configuration</span>
00075         <span class="keyword">const</span> <span class="keywordtype">char</span> *fileName = par (<span class="stringliteral">"ospfConfigFile"</span>);
00076         <span class="keywordflow">if</span> (fileName == NULL || (!strcmp(fileName, <span class="stringliteral">""</span>)) || !LoadConfigFromXML (fileName))
00077             error (<span class="stringliteral">"Error reading AS configuration from file %s"</span>, fileName);
00078 
00079         <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a16">AddWatches</a> ();
00080     }
00081 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d2" doxytag="OSPFRouting::LoadAreaFromXML"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OSPFRouting::LoadAreaFromXML           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const cXMLElement &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>asConfig</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>areaID</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Loads basic configuration information for a given area from the config XML. Reads the configured address ranges, and whether this Area should be handled as a stub Area. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>asConfig</em>&nbsp;</td><td>[in] XML node describing the configuration of the whole Autonomous System. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>areaID</em>&nbsp;</td><td>[in] The Area to be added to the <a class="el" href="namespace_o_s_p_f.html">OSPF</a> datastructure. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00138 {
00139     std::string areaXPath (<span class="stringliteral">"Area[@id='"</span>);
00140     areaXPath += areaID;
00141     areaXPath += <span class="stringliteral">"']"</span>;
00142 
00143     cXMLElement* areaConfig = asConfig.getElementByPath (areaXPath.c_str ());
00144     <span class="keywordflow">if</span> (areaConfig == NULL) {
00145         error (<span class="stringliteral">"No configuration for Area ID: %s"</span>, areaID.c_str ());
00146     }
00147     <span class="keywordflow">else</span> {
00148         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"    loading info for Area id = "</span> &lt;&lt; areaID &lt;&lt; <span class="stringliteral">"\n"</span>;
00149     }
00150 
00151     <a class="code" href="class_o_s_p_f_1_1_area.html">OSPF::Area</a>* area = <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_area.html">OSPF::Area</a> (ULongFromAddressString (areaID.c_str ()));
00152     cXMLElementList areaDetails = areaConfig-&gt;getChildren ();
00153     <span class="keywordflow">for</span> (cXMLElementList::iterator arIt = areaDetails.begin (); arIt != areaDetails.end (); arIt++) {
00154         std::string nodeName = (*arIt)-&gt;getTagName ();
00155         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"AddressRange"</span>) {
00156             <a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html">OSPF::IPv4AddressRange</a> addressRange;
00157             addressRange.<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#o0">address</a> = <a class="code" href="_o_s_p_fcommon_8h.html#a53">IPv4AddressFromAddressString</a> ((*arIt)-&gt;getChildrenByTagName (<span class="stringliteral">"Address"</span>)[0]-&gt;getNodeValue ());
00158             addressRange.<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#o1">mask</a> = <a class="code" href="_o_s_p_fcommon_8h.html#a53">IPv4AddressFromAddressString</a> ((*arIt)-&gt;getChildrenByTagName (<span class="stringliteral">"Mask"</span>)[0]-&gt;getNodeValue ());
00159             std::string status = (*arIt)-&gt;getChildrenByTagName (<span class="stringliteral">"Status"</span>)[0]-&gt;getNodeValue ();
00160             <span class="keywordflow">if</span> (status == <span class="stringliteral">"Advertise"</span>) {
00161                 area-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a4">AddAddressRange</a> (addressRange, <span class="keyword">true</span>);
00162             } <span class="keywordflow">else</span> {
00163                 area-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a4">AddAddressRange</a> (addressRange, <span class="keyword">false</span>);
00164             }
00165         }
00166         <span class="keywordflow">if</span> ((nodeName == <span class="stringliteral">"Stub"</span>) &amp;&amp; (areaID != <span class="stringliteral">"0.0.0.0"</span>)) {    <span class="comment">// the backbone cannot be configured as a stub</span>
00167             area-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a10">SetExternalRoutingCapability</a> (<span class="keyword">false</span>);
00168             area-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a12">SetStubDefaultCost</a> (atoi ((*arIt)-&gt;getChildrenByTagName (<span class="stringliteral">"DefaultCost"</span>)[0]-&gt;getNodeValue ()));
00169         }
00170     }
00171     <span class="comment">// Add the Area to the router</span>
00172     <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a17">AddArea</a> (area);
00173 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d7" doxytag="OSPFRouting::LoadConfigFromXML"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool OSPFRouting::LoadConfigFromXML           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>filename</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Loads the configuration of the <a class="el" href="namespace_o_s_p_f.html">OSPF</a> datastructure from the config XML. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>[in] The path of the XML config file. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>True if the configuration was succesfully loaded. </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>an</em>&nbsp;</td><td>error () otherwise. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00468 {
00469     cXMLElement* asConfig = ev.getXMLDocument (filename);
00470     <span class="keywordflow">if</span> (asConfig == NULL) {
00471         error (<span class="stringliteral">"Cannot read AS configuration from file: %s"</span>, filename);
00472     }
00473 
00474     <span class="comment">// load information on this router</span>
00475     std::string routerXPath (<span class="stringliteral">"Router[@id='"</span>);
00476     <a class="code" href="class_i_p_address.html">IPAddress</a> routerId (<a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a3">GetRouterID</a> ());
00477     routerXPath += routerId.str ();
00478     routerXPath += <span class="stringliteral">"']"</span>;
00479 
00480     cXMLElement* routerNode = asConfig-&gt;getElementByPath (routerXPath.c_str ());
00481     <span class="keywordflow">if</span> (routerNode == NULL) {
00482         error (<span class="stringliteral">"No configuration for Router ID: %s"</span>, routerId.str ().c_str ());
00483     }
00484     <span class="keywordflow">else</span> {
00485         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"OSPFRouting: Loading info for Router id = "</span> &lt;&lt; routerId.str () &lt;&lt; <span class="stringliteral">"\n"</span>;
00486     }
00487 
00488     <span class="keywordflow">if</span> (routerNode-&gt;getChildrenByTagName (<span class="stringliteral">"RFC1583Compatible"</span>).size () &gt; 0) {
00489         <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a4">SetRFC1583Compatibility</a> (<span class="keyword">true</span>);
00490     }
00491 
00492     std::map&lt;std::string, int&gt; areaList;
00493     <a class="code" href="class_o_s_p_f_routing.html#d1">GetAreaListFromXML</a> (*routerNode, areaList);
00494 
00495     <span class="comment">// load area information</span>
00496     <span class="keywordflow">for</span> (std::map&lt;std::string, int&gt;::iterator areaIt = areaList.begin (); areaIt != areaList.end (); areaIt++) {
00497         <a class="code" href="class_o_s_p_f_routing.html#d2">LoadAreaFromXML</a> (*asConfig, areaIt-&gt;first);
00498     }
00499     <span class="comment">// if the router is an area border router then it MUST be part of the backbone (area 0)</span>
00500     <span class="keywordflow">if</span> ((areaList.size () &gt; 1) &amp;&amp; (areaList.find (<span class="stringliteral">"0.0.0.0"</span>) == areaList.end ())) {
00501         <a class="code" href="class_o_s_p_f_routing.html#d2">LoadAreaFromXML</a> (*asConfig, <span class="stringliteral">"0.0.0.0"</span>);
00502     }
00503 
00504     <span class="comment">// load interface information</span>
00505     cXMLElementList routerConfig = routerNode-&gt;getChildren ();
00506     <span class="keywordflow">for</span> (cXMLElementList::iterator routerConfigIt = routerConfig.begin (); routerConfigIt != routerConfig.end (); routerConfigIt++) {
00507         std::string nodeName = (*routerConfigIt)-&gt;getTagName ();
00508         <span class="keywordflow">if</span> ((nodeName == <span class="stringliteral">"PointToPointInterface"</span>) ||
00509             (nodeName == <span class="stringliteral">"BroadcastInterface"</span>) ||
00510             (nodeName == <span class="stringliteral">"NBMAInterface"</span>) ||
00511             (nodeName == <span class="stringliteral">"PointToMultiPointInterface"</span>))
00512         {
00513             <a class="code" href="class_o_s_p_f_routing.html#d3">LoadInterfaceParameters</a> (*(*routerConfigIt));
00514         }
00515         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"ExternalInterface"</span>) {
00516             <a class="code" href="class_o_s_p_f_routing.html#d4">LoadExternalRoute</a> (*(*routerConfigIt));
00517         }
00518         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"HostInterface"</span>) {
00519             <a class="code" href="class_o_s_p_f_routing.html#d5">LoadHostRoute</a> (*(*routerConfigIt));
00520         }
00521         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"VirtualLink"</span>) {
00522             <a class="code" href="class_o_s_p_f_routing.html#d6">LoadVirtualLink</a> (*(*routerConfigIt));
00523         }
00524     }
00525     <span class="keywordflow">return</span> <span class="keyword">true</span>;
00526 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d4" doxytag="OSPFRouting::LoadExternalRoute"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OSPFRouting::LoadExternalRoute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const cXMLElement &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>externalRouteConfig</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Loads the configuration information of a route outside of the Autonomous System (external route). <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>externalRouteConfig</em>&nbsp;</td><td>[in] XML node describing the parameters of an external route. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00298 {
00299     std::string               ifName  = externalRouteConfig.getAttribute (<span class="stringliteral">"ifName"</span>);
00300     <span class="keywordtype">int</span>                       ifIndex = <a class="code" href="class_o_s_p_f_routing.html#d0">ResolveInterfaceName</a> (ifName);
00301     <a class="code" href="class_o_s_p_f_a_s_external_l_s_a_contents.html">OSPFASExternalLSAContents</a> asExternalRoute;
00302     <a class="code" href="class_o_s_p_f_1_1_routing_table_entry.html">OSPF::RoutingTableEntry</a>   externalRoutingEntry; <span class="comment">// only used here to keep the path cost calculation in one place</span>
00303     <a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html">OSPF::IPv4AddressRange</a>    networkAddress;
00304 
00305     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"        loading ExternalInterface "</span> &lt;&lt; ifName &lt;&lt; <span class="stringliteral">" ifIndex["</span> &lt;&lt; ifIndex &lt;&lt; <span class="stringliteral">"]\n"</span>;
00306 
00307     cXMLElementList ifDetails = externalRouteConfig.getChildren ();
00308     <span class="keywordflow">for</span> (cXMLElementList::iterator exElemIt = ifDetails.begin (); exElemIt != ifDetails.end (); exElemIt++) {
00309         std::string nodeName = (*exElemIt)-&gt;getTagName ();
00310         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"AdvertisedExternalNetwork"</span>) {
00311             networkAddress.<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#o0">address</a> = <a class="code" href="_o_s_p_fcommon_8h.html#a53">IPv4AddressFromAddressString</a> ((*exElemIt)-&gt;getChildrenByTagName (<span class="stringliteral">"Address"</span>)[0]-&gt;getNodeValue ());
00312             networkAddress.<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#o1">mask</a>    = <a class="code" href="_o_s_p_fcommon_8h.html#a53">IPv4AddressFromAddressString</a> ((*exElemIt)-&gt;getChildrenByTagName (<span class="stringliteral">"Mask"</span>)[0]-&gt;getNodeValue ());
00313             asExternalRoute.<a class="code" href="class_o_s_p_f_a_s_external_l_s_a_contents.html#a8">setNetworkMask</a> (ULongFromIPv4Address (networkAddress.<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#o1">mask</a>));
00314         }
00315         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"ExternalInterfaceOutputParameters"</span>) {
00316             std::string metricType = (*exElemIt)-&gt;getChildrenByTagName (<span class="stringliteral">"ExternalInterfaceOutputType"</span>)[0]-&gt;getNodeValue ();
00317             <span class="keywordtype">int</span>         routeCost  = atoi ((*exElemIt)-&gt;getChildrenByTagName (<span class="stringliteral">"ExternalInterfaceOutputCost"</span>)[0]-&gt;getNodeValue ());
00318 
00319             asExternalRoute.<a class="code" href="class_o_s_p_f_a_s_external_l_s_a_contents.html#a12">setRouteCost</a> (routeCost);
00320             <span class="keywordflow">if</span> (metricType == <span class="stringliteral">"Type2"</span>) {
00321                 asExternalRoute.<a class="code" href="class_o_s_p_f_a_s_external_l_s_a_contents.html#a10">setE_ExternalMetricType</a> (<span class="keyword">true</span>);
00322                 externalRoutingEntry.<a class="code" href="class_o_s_p_f_1_1_routing_table_entry.html#a19">SetType2Cost</a> (routeCost);
00323                 externalRoutingEntry.<a class="code" href="class_o_s_p_f_1_1_routing_table_entry.html#a15">SetPathType</a> (OSPF::RoutingTableEntry::Type2External);
00324             } <span class="keywordflow">else</span> {
00325                 asExternalRoute.<a class="code" href="class_o_s_p_f_a_s_external_l_s_a_contents.html#a10">setE_ExternalMetricType</a> (<span class="keyword">false</span>);
00326                 externalRoutingEntry.<a class="code" href="class_o_s_p_f_1_1_routing_table_entry.html#a17">SetCost</a> (routeCost);
00327                 externalRoutingEntry.<a class="code" href="class_o_s_p_f_1_1_routing_table_entry.html#a15">SetPathType</a> (OSPF::RoutingTableEntry::Type1External);
00328             }
00329         }
00330         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"ForwardingAddress"</span>) {
00331             asExternalRoute.<a class="code" href="class_o_s_p_f_a_s_external_l_s_a_contents.html#a15">setForwardingAddress</a> (ULongFromAddressString ((*exElemIt)-&gt;getNodeValue ()));
00332         }
00333         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"ExternalRouteTag"</span>) {
00334             std::string externalRouteTag = (*exElemIt)-&gt;getNodeValue ();
00335             <span class="keywordtype">char</span>        externalRouteTagValue[4];
00336 
00337             memset (externalRouteTagValue, 0, 4 * <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));
00338             <span class="keywordtype">int</span> externalRouteTagLength = externalRouteTag.length ();
00339             <span class="keywordflow">if</span> ((externalRouteTagLength &gt; 4) &amp;&amp; (externalRouteTagLength &lt;= 10) &amp;&amp; (externalRouteTagLength % 2 == 0) &amp;&amp; (externalRouteTag[0] == <span class="charliteral">'0'</span>) &amp;&amp; (externalRouteTag[1] == <span class="charliteral">'x'</span>)) {
00340                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = externalRouteTagLength; (i &gt; 2); i -= 2) {
00341                     externalRouteTagValue[(i - 2) / 2] = <a class="code" href="_o_s_p_fcommon_8h.html#a60">HexPairToByte</a> (externalRouteTag[i - 1], externalRouteTag[i]);
00342                 }
00343             }
00344             asExternalRoute.<a class="code" href="class_o_s_p_f_a_s_external_l_s_a_contents.html#a17">setExternalRouteTag</a> ((externalRouteTagValue[0] &lt;&lt; 24) + (externalRouteTagValue[1] &lt;&lt; 16) + (externalRouteTagValue[2] &lt;&lt; 8) + externalRouteTagValue[3]);
00345         }
00346     }
00347     <span class="comment">// add the external route to the OSPF datastructure</span>
00348     <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a34">UpdateExternalRoute</a> (networkAddress.<a class="code" href="struct_o_s_p_f_1_1_i_pv4_address_range.html#o0">address</a>, asExternalRoute, ifIndex);
00349 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d5" doxytag="OSPFRouting::LoadHostRoute"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OSPFRouting::LoadHostRoute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const cXMLElement &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hostRouteConfig</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Loads the configuration of a host route (a host directly connected to the router). <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hostRouteConfig</em>&nbsp;</td><td>[in] XML node describing the parameters of a host route. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00357 {
00358     <a class="code" href="struct_o_s_p_f_1_1_host_route_parameters.html">OSPF::HostRouteParameters</a> hostParameters;
00359     OSPF::AreaID              hostArea;
00360 
00361     std::string ifName = hostRouteConfig.getAttribute (<span class="stringliteral">"ifName"</span>);
00362     hostParameters.<a class="code" href="struct_o_s_p_f_1_1_host_route_parameters.html#o0">ifIndex</a> = <a class="code" href="class_o_s_p_f_routing.html#d0">ResolveInterfaceName</a> (ifName);
00363 
00364     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"        loading HostInterface "</span> &lt;&lt; ifName &lt;&lt; <span class="stringliteral">" ifIndex["</span> &lt;&lt; static_cast&lt;short&gt; (hostParameters.<a class="code" href="struct_o_s_p_f_1_1_host_route_parameters.html#o0">ifIndex</a>) &lt;&lt; <span class="stringliteral">"]\n"</span>;
00365 
00366     cXMLElementList ifDetails = hostRouteConfig.getChildren ();
00367     <span class="keywordflow">for</span> (cXMLElementList::iterator hostElemIt = ifDetails.begin (); hostElemIt != ifDetails.end (); hostElemIt++) {
00368         std::string nodeName = (*hostElemIt)-&gt;getTagName ();
00369         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"AreaID"</span>) {
00370             hostArea = <a class="code" href="_o_s_p_fcommon_8h.html#a56">ULongFromAddressString</a> ((*hostElemIt)-&gt;getNodeValue ());
00371         }
00372         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"AttachedHost"</span>) {
00373             hostParameters.<a class="code" href="struct_o_s_p_f_1_1_host_route_parameters.html#o1">address</a> = <a class="code" href="_o_s_p_fcommon_8h.html#a53">IPv4AddressFromAddressString</a> ((*hostElemIt)-&gt;getNodeValue ());
00374         }
00375         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"LinkCost"</span>) {
00376             hostParameters.<a class="code" href="struct_o_s_p_f_1_1_host_route_parameters.html#o2">linkCost</a> = atoi ((*hostElemIt)-&gt;getNodeValue ());
00377         }
00378     }
00379     <span class="comment">// add the host route to the OSPF datastructure.</span>
00380     <a class="code" href="class_o_s_p_f_1_1_area.html">OSPF::Area</a>* area = <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a18">GetArea</a> (hostArea);
00381     <span class="keywordflow">if</span> (area != NULL) {
00382         area-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a7">AddHostRoute</a> (hostParameters);
00383 
00384     } <span class="keywordflow">else</span> {
00385         error (<span class="stringliteral">"Loading HostInterface ifIndex[%d] in Area %d aborted"</span>, hostParameters.<a class="code" href="struct_o_s_p_f_1_1_host_route_parameters.html#o0">ifIndex</a>, hostArea);
00386     }
00387 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d3" doxytag="OSPFRouting::LoadInterfaceParameters"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OSPFRouting::LoadInterfaceParameters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const cXMLElement &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ifConfig</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Loads <a class="el" href="namespace_o_s_p_f.html">OSPF</a> configuration information for a router interface. Handles PointToPoint, Broadcast, NBMA and PointToMultiPoint interfaces. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ifConfig</em>&nbsp;</td><td>[in] XML node describing the configuration of an <a class="el" href="namespace_o_s_p_f.html">OSPF</a> interface. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00182 {
00183     <a class="code" href="class_o_s_p_f_1_1_interface.html">OSPF::Interface</a>* intf          = <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface.html">OSPF::Interface</a>;
00184     std::string      ifName        = ifConfig.getAttribute (<span class="stringliteral">"ifName"</span>);
00185     <span class="keywordtype">int</span>              ifIndex       = <a class="code" href="class_o_s_p_f_routing.html#d0">ResolveInterfaceName</a> (ifName);
00186     std::string      interfaceType = ifConfig.getTagName ();
00187 
00188     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"        loading "</span> &lt;&lt; interfaceType &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; ifName &lt;&lt; <span class="stringliteral">" ifIndex["</span> &lt;&lt; ifIndex &lt;&lt; <span class="stringliteral">"]\n"</span>;
00189 
00190     intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a20">SetIfIndex</a> (ifIndex);
00191     <span class="keywordflow">if</span> (interfaceType == <span class="stringliteral">"PointToPointInterface"</span>) {
00192         intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a18">SetType</a> (OSPF::Interface::PointToPoint);
00193     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (interfaceType == <span class="stringliteral">"BroadcastInterface"</span>) {
00194         intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a18">SetType</a> (OSPF::Interface::Broadcast);
00195     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (interfaceType == <span class="stringliteral">"NBMAInterface"</span>) {
00196         intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a18">SetType</a> (OSPF::Interface::NBMA);
00197     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (interfaceType == <span class="stringliteral">"PointToMultiPointInterface"</span>) {
00198         intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a18">SetType</a> (OSPF::Interface::PointToMultiPoint);
00199     } <span class="keywordflow">else</span> {
00200         <span class="keyword">delete</span> intf;
00201         error (<span class="stringliteral">"Loading %s ifIndex[%d] aborted"</span>, interfaceType.c_str(), ifIndex);
00202     }
00203 
00204     OSPF::AreaID    areaID    = 0;
00205     cXMLElementList ifDetails = ifConfig.getChildren ();
00206 
00207     <span class="keywordflow">for</span> (cXMLElementList::iterator ifElemIt = ifDetails.begin (); ifElemIt != ifDetails.end (); ifElemIt++) {
00208         std::string nodeName = (*ifElemIt)-&gt;getTagName ();
00209         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"AreaID"</span>) {
00210             areaID = <a class="code" href="_o_s_p_fcommon_8h.html#a56">ULongFromAddressString</a> ((*ifElemIt)-&gt;getNodeValue ());
00211             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a24">SetAreaID</a> (areaID);
00212         }
00213         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"InterfaceOutputCost"</span>) {
00214             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a28">SetOutputCost</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00215         }
00216         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"RetransmissionInterval"</span>) {
00217             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a30">SetRetransmissionInterval</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00218         }
00219         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"InterfaceTransmissionDelay"</span>) {
00220             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a32">SetTransmissionDelay</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00221         }
00222         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"RouterPriority"</span>) {
00223             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a36">SetRouterPriority</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00224         }
00225         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"HelloInterval"</span>) {
00226             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a38">SetHelloInterval</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00227         }
00228         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"RouterDeadInterval"</span>) {
00229             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42">SetRouterDeadInterval</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00230         }
00231         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"AuthenticationType"</span>) {
00232             std::string authenticationType = (*ifElemIt)-&gt;getNodeValue ();
00233             <span class="keywordflow">if</span> (authenticationType == <span class="stringliteral">"SimplePasswordType"</span>) {
00234                 intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a44">SetAuthenticationType</a> (OSPF::SimplePasswordType);
00235             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (authenticationType == <span class="stringliteral">"CrytographicType"</span>) {
00236                 intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a44">SetAuthenticationType</a> (OSPF::CrytographicType);
00237             } <span class="keywordflow">else</span> {
00238                 intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a44">SetAuthenticationType</a> (OSPF::NullType);
00239             }
00240         }
00241         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"AuthenticationKey"</span>) {
00242             std::string key = (*ifElemIt)-&gt;getNodeValue ();
00243             <a class="code" href="struct_o_s_p_f_1_1_authentication_key_type.html">OSPF::AuthenticationKeyType</a> keyValue;
00244             memset (keyValue.<a class="code" href="struct_o_s_p_f_1_1_authentication_key_type.html#o0">bytes</a>, 0, 8 * sizeof (<span class="keywordtype">char</span>));
00245             <span class="keywordtype">int</span> keyLength = key.length ();
00246             <span class="keywordflow">if</span> ((keyLength &gt; 4) &amp;&amp; (keyLength &lt;= 18) &amp;&amp; (keyLength % 2 == 0) &amp;&amp; (key[0] == <span class="charliteral">'0'</span>) &amp;&amp; (key[1] == <span class="charliteral">'x'</span>)) {
00247                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = keyLength; (i &gt; 2); i -= 2) {
00248                     keyValue.<a class="code" href="struct_o_s_p_f_1_1_authentication_key_type.html#o0">bytes</a>[(i - 2) / 2] = <a class="code" href="_o_s_p_fcommon_8h.html#a60">HexPairToByte</a> (key[i - 1], key[i]);
00249                 }
00250             }
00251             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a46">SetAuthenticationKey</a> (keyValue);
00252         }
00253         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"PollInterval"</span>) {
00254             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a40">SetPollInterval</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00255         }
00256         <span class="keywordflow">if</span> ((interfaceType == <span class="stringliteral">"NBMAInterface"</span>) &amp;&amp; (nodeName == <span class="stringliteral">"NBMANeighborList"</span>)) {
00257             cXMLElementList neighborList = (*ifElemIt)-&gt;getChildren ();
00258             <span class="keywordflow">for</span> (cXMLElementList::iterator neighborIt = neighborList.begin (); neighborIt != neighborList.end (); neighborIt++) {
00259                 std::string neighborNodeName = (*neighborIt)-&gt;getTagName ();
00260                 <span class="keywordflow">if</span> (neighborNodeName == <span class="stringliteral">"NBMANeighbor"</span>) {
00261                     <a class="code" href="class_o_s_p_f_1_1_neighbor.html">OSPF::Neighbor</a>* neighbor = <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_neighbor.html">OSPF::Neighbor</a>;
00262                     neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a33">SetAddress</a> (IPv4AddressFromAddressString ((*neighborIt)-&gt;getChildrenByTagName (<span class="stringliteral">"NetworkInterfaceAddress"</span>)[0]-&gt;getNodeValue ()));
00263                     neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a31">SetPriority</a> (atoi ((*neighborIt)-&gt;getChildrenByTagName (<span class="stringliteral">"NeighborPriority"</span>)[0]-&gt;getNodeValue ()));
00264                     intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a8">AddNeighbor</a> (neighbor);
00265                 }
00266             }
00267         }
00268         <span class="keywordflow">if</span> ((interfaceType == <span class="stringliteral">"PointToMultiPointInterface"</span>) &amp;&amp; (nodeName == <span class="stringliteral">"PointToMultiPointNeighborList"</span>)) {
00269             cXMLElementList neighborList = (*ifElemIt)-&gt;getChildren ();
00270             <span class="keywordflow">for</span> (cXMLElementList::iterator neighborIt = neighborList.begin (); neighborIt != neighborList.end (); neighborIt++) {
00271                 std::string neighborNodeName = (*neighborIt)-&gt;getTagName ();
00272                 <span class="keywordflow">if</span> (neighborNodeName == <span class="stringliteral">"PointToMultiPointNeighbor"</span>) {
00273                     <a class="code" href="class_o_s_p_f_1_1_neighbor.html">OSPF::Neighbor</a>* neighbor = <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_neighbor.html">OSPF::Neighbor</a>;
00274                     neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a33">SetAddress</a> (IPv4AddressFromAddressString ((*neighborIt)-&gt;getNodeValue ()));
00275                     intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a8">AddNeighbor</a> (neighbor);
00276                 }
00277             }
00278         }
00279 
00280     }
00281     <span class="comment">// add the interface to it's Area</span>
00282     <a class="code" href="class_o_s_p_f_1_1_area.html">OSPF::Area</a>* area = <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a18">GetArea</a> (areaID);
00283     <span class="keywordflow">if</span> (area != NULL) {
00284         area-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a32">AddInterface</a> (intf);
00285         intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a2">ProcessEvent</a> (OSPF::Interface::InterfaceUp); <span class="comment">// notification should come from the blackboard...</span>
00286     } <span class="keywordflow">else</span> {
00287         <span class="keyword">delete</span> intf;
00288         error (<span class="stringliteral">"Loading %s ifIndex[%d] in Area %d aborted"</span>, interfaceType.c_str(), ifIndex, areaID);
00289     }
00290 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d6" doxytag="OSPFRouting::LoadVirtualLink"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void OSPFRouting::LoadVirtualLink           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const cXMLElement &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>virtualLinkConfig</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Loads the configuration of an OSPf virtual link (virtual connection between two backbone routers). <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>virtualLinkConfig</em>&nbsp;</td><td>[in] XML node describing the parameters of a virtual link. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00395 {
00396     <a class="code" href="class_o_s_p_f_1_1_interface.html">OSPF::Interface</a>* intf     = <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_interface.html">OSPF::Interface</a>;
00397     std::string      endPoint = virtualLinkConfig.getAttribute (<span class="stringliteral">"endPointRouterID"</span>);
00398     <a class="code" href="class_o_s_p_f_1_1_neighbor.html">OSPF::Neighbor</a>*  neighbor = <span class="keyword">new</span> <a class="code" href="class_o_s_p_f_1_1_neighbor.html">OSPF::Neighbor</a>;
00399 
00400     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"        loading VirtualLink to "</span> &lt;&lt; endPoint &lt;&lt; <span class="stringliteral">"\n"</span>;
00401 
00402     intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a18">SetType</a> (OSPF::Interface::Virtual);
00403     neighbor-&gt;<a class="code" href="class_o_s_p_f_1_1_neighbor.html#a29">SetNeighborID</a> (ULongFromAddressString (endPoint.c_str ()));
00404     intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a8">AddNeighbor</a> (neighbor);
00405 
00406     cXMLElementList ifDetails = virtualLinkConfig.getChildren ();
00407     <span class="keywordflow">for</span> (cXMLElementList::iterator ifElemIt = ifDetails.begin (); ifElemIt != ifDetails.end (); ifElemIt++) {
00408         std::string nodeName = (*ifElemIt)-&gt;getTagName ();
00409         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"TransitAreaID"</span>) {
00410             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a26">SetTransitAreaID</a> (ULongFromAddressString ((*ifElemIt)-&gt;getNodeValue ()));
00411         }
00412         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"RetransmissionInterval"</span>) {
00413             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a30">SetRetransmissionInterval</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00414         }
00415         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"InterfaceTransmissionDelay"</span>) {
00416             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a32">SetTransmissionDelay</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00417         }
00418         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"HelloInterval"</span>) {
00419             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a38">SetHelloInterval</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00420         }
00421         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"RouterDeadInterval"</span>) {
00422             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a42">SetRouterDeadInterval</a> (atoi ((*ifElemIt)-&gt;getNodeValue ()));
00423         }
00424         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"AuthenticationType"</span>) {
00425             std::string authenticationType = (*ifElemIt)-&gt;getNodeValue ();
00426             <span class="keywordflow">if</span> (authenticationType == <span class="stringliteral">"SimplePasswordType"</span>) {
00427                 intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a44">SetAuthenticationType</a> (OSPF::SimplePasswordType);
00428             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (authenticationType == <span class="stringliteral">"CrytographicType"</span>) {
00429                 intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a44">SetAuthenticationType</a> (OSPF::CrytographicType);
00430             } <span class="keywordflow">else</span> {
00431                 intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a44">SetAuthenticationType</a> (OSPF::NullType);
00432             }
00433         }
00434         <span class="keywordflow">if</span> (nodeName == <span class="stringliteral">"AuthenticationKey"</span>) {
00435             std::string key = (*ifElemIt)-&gt;getNodeValue ();
00436             <a class="code" href="struct_o_s_p_f_1_1_authentication_key_type.html">OSPF::AuthenticationKeyType</a> keyValue;
00437             memset (keyValue.<a class="code" href="struct_o_s_p_f_1_1_authentication_key_type.html#o0">bytes</a>, 0, 8 * sizeof (<span class="keywordtype">char</span>));
00438             <span class="keywordtype">int</span> keyLength = key.length ();
00439             <span class="keywordflow">if</span> ((keyLength &gt; 4) &amp;&amp; (keyLength &lt;= 18) &amp;&amp; (keyLength % 2 == 0) &amp;&amp; (key[0] == <span class="charliteral">'0'</span>) &amp;&amp; (key[1] == <span class="charliteral">'x'</span>)) {
00440                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = keyLength; (i &gt; 2); i -= 2) {
00441                     keyValue.<a class="code" href="struct_o_s_p_f_1_1_authentication_key_type.html#o0">bytes</a>[(i - 2) / 2] = <a class="code" href="_o_s_p_fcommon_8h.html#a60">HexPairToByte</a> (key[i - 1], key[i]);
00442                 }
00443             }
00444             intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a46">SetAuthenticationKey</a> (keyValue);
00445         }
00446     }
00447 
00448     <span class="comment">// add the virtual link to the OSPF datastructure.</span>
00449     <a class="code" href="class_o_s_p_f_1_1_area.html">OSPF::Area</a>* transitArea = <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a18">GetArea</a> (intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a25">GetAreaID</a> ());
00450     <a class="code" href="class_o_s_p_f_1_1_area.html">OSPF::Area</a>* backbone    = <a class="code" href="class_o_s_p_f_routing.html#r2">ospfRouter</a>-&gt;<a class="code" href="class_o_s_p_f_1_1_router.html#a18">GetArea</a> (OSPF::BackboneAreaID);
00451 
00452     <span class="keywordflow">if</span> ((backbone != NULL) &amp;&amp; (transitArea != NULL) &amp;&amp; (transitArea-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a11">GetExternalRoutingCapability</a> ())) {
00453         backbone-&gt;<a class="code" href="class_o_s_p_f_1_1_area.html#a32">AddInterface</a> (intf);
00454     } <span class="keywordflow">else</span> {
00455         <span class="keyword">delete</span> intf;
00456         error (<span class="stringliteral">"Loading VirtualLink to %s through Area %d aborted"</span>, endPoint.c_str (), intf-&gt;<a class="code" href="class_o_s_p_f_1_1_interface.html#a25">GetAreaID</a> ());
00457     }
00458 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="OSPFRouting::numInitStages"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual int OSPFRouting::numInitStages           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00052 {<span class="keywordflow">return</span> 5;}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d0" doxytag="OSPFRouting::ResolveInterfaceName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int OSPFRouting::ResolveInterfaceName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const std::string &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Looks up the interface name in <a class="el" href="class_interface_table.html">InterfaceTable</a>, and returns interfaceId a.k.a ifIndex. <div class="fragment"><pre class="fragment">00100 {
00101     <a class="code" href="class_interface_entry.html">InterfaceEntry</a>* ie = <a class="code" href="class_o_s_p_f_routing.html#r0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a9">interfaceByName</a> (name.c_str());
00102     <span class="keywordflow">if</span> (!ie)
00103         opp_error ("error reading XML config: <a class="code" href="class_interface_table.html">InterfaceTable</a> contains no interface named '%s'", name.c_str());
00104     return ie-&gt;interfaceId ();
00105 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="r0" doxytag="OSPFRouting::ift"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_table.html">InterfaceTable</a>* <a class="el" href="class_o_s_p_f_routing.html#r0">OSPFRouting::ift</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Provides access to the interface table. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="r2" doxytag="OSPFRouting::ospfRouter"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_o_s_p_f_1_1_router.html">OSPF::Router</a>* <a class="el" href="class_o_s_p_f_routing.html#r2">OSPFRouting::ospfRouter</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Root object of the <a class="el" href="namespace_o_s_p_f.html">OSPF</a> datastructure. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="r1" doxytag="OSPFRouting::rt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_routing_table.html">RoutingTable</a>* <a class="el" href="class_o_s_p_f_routing.html#r1">OSPFRouting::rt</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Provides access to the <a class="el" href="class_i_p.html">IP</a> routing table. 
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_o_s_p_f_routing_8h.html">OSPFRouting.h</a><li><a class="el" href="_o_s_p_f_routing_8cc.html">OSPFRouting.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:27 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
