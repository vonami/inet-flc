<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: RadioBase Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>RadioBase Class Reference</h1><code>#include &lt;RadioBase.h&gt;</code>
<p>
<p>Inheritance diagram for RadioBase:
<p><center><img src="class_radio_base.png" usemap="#RadioBase_map" border="0" alt=""></center>
<map name="RadioBase_map">
<area href="class_channel_access.html" alt="ChannelAccess" shape="rect" coords="0,112,110,136">
<area href="class_basic_module.html" alt="BasicModule" shape="rect" coords="0,56,110,80">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="0,0,110,24">
<area href="class_ieee80211_radio2.html" alt="Ieee80211Radio2" shape="rect" coords="0,224,110,248">
</map>
<a href="class_radio_base-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Keeps track of the different snir levels when receiving a packet. 
<p>
This module keeps track of the noise level of the channel.<p>
When receiving a packet this module updates the noise level of the channel. Based on the receive power of the packet it is processed and handed to upper layers or just treated as noise.<p>
After the packet is completely received the snir information is attached and it is handed to the decider module.<p>
The snir information is a SnrList that lists all different snr levels together with the point of time (simTime()) when they started.<p>
On top of that this module manages the <a class="el" href="class_radio_state.html">RadioState</a>, and posts notifications on <a class="el" href="class_notification_board.html">NotificationBoard</a> whenever it changes. The radio state gives information about whether this module is sending a packet, receiving a packet or idle. This information can be accessed via the <a class="el" href="class_notification_board.html">NotificationBoard</a> by other modules, e.g. a <a class="el" href="class_c_s_m_a_mac_layer.html">CSMAMacLayer</a>.<p>
<dl compact><dt><b>Author:</b></dt><dd>Marc Loebbers </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#a0">RadioBase</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#a1">changeChannel</a> (int channel)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">change transmitter and receiver to a new channel. This method throws an error if the radio state is transmit. Messages that are already sent to the new channel and would reach us in the future - thus they are on the air - will be received correctly.  <a href="#a1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#a2">setBitrate</a> (double bitrate)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">change the bitrate to the given value. This method throws an error if the radio state is transmit.  <a href="#a2"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::map&lt; <a class="el" href="class_air_frame.html">AirFrame</a> *,<br>
 double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#x0">RecvBuff</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Typedef used to store received messages together with receive power.  <a href="#x0"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b0">initialize</a> (int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize variables and publish the radio status.  <a href="#b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b1">finish</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b2">~RadioBase</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b3">handleMessage</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b4">handleUpperMsg</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b5">handleSelfMsg</a> (cMessage *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b6">handleCommand</a> (int msgkind, cPolymorphic *ctrl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b7">handleLowerMsgStart</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffer the frame and update noise levels and snr information.  <a href="#b7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b8">handleLowerMsgEnd</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unbuffer the frame and update noise levels and snr information.  <a href="#b8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b9">bufferMsg</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffers message for 'transmission time'.  <a href="#b9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b10">unbufferMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unbuffers a message after 'transmission time'.  <a href="#b10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b11">sendUp</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to the upper layer.  <a href="#b11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b12">sendDown</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to the channel.  <a href="#b12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b13">encapsMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulates a MAC frame into an Air Frame.  <a href="#b13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b14">channelNumber</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b15">addNewSnr</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">updates the snr information of the relevant AirFrames  <a href="#b15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b16">createCapsulePkt</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new <a class="el" href="class_air_frame.html">AirFrame</a>.  <a href="#b16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_i_radio_model.html">IRadioModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b17">createRadioModel</a> ()=0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_i_reception_model.html">IReceptionModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#b18">createReceptionModel</a> ()=0</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_radio_model.html">IRadioModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p0">radioModel</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_reception_model.html">IReceptionModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p1">receptionModel</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p2">transmitterPower</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">power used to transmit messages  <a href="#p2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_radio_base_1_1_snr_struct.html">SnrStruct</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p3">snrInfo</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">State: SnrInfo stores the snrList and the the recvdPower for the message currently being received, together with a pointer to the message.  <a href="#p3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_radio_base.html#x0">RecvBuff</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p4">recvBuff</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">State: A buffer to store a pointer to a message and the related receive power.  <a href="#p4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_radio_state.html">RadioState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p5">rs</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">State: the current <a class="el" href="class_radio_state.html">RadioState</a> of the NIC; includes channel number.  <a href="#p5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p6">newChannel</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">State: if not -1, we have to switch to that channel once we finished transmitting.  <a href="#p6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p7">newBitrate</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">State: if not -1, we have to switch to that bitrate once we finished transmitting.  <a href="#p7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p8">noiseLevel</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">State: the current noise level of the channel.  <a href="#p8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p9">carrierFrequency</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Configuration: The carrier frequency used. It is read from the <a class="el" href="class_channel_control.html">ChannelControl</a> module.  <a href="#p9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p10">thermalNoise</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Configuration: Thermal noise on the channel. Can be specified in omnetpp.ini. Default: -100 dBm.  <a href="#p10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#p11">sensitivity</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Configuration: Defines up to what Power level (in dBm) a message can be understood. If the level of a received packet is lower, it is only treated as noise. Can be specified in omnetpp.ini. Default: -85 dBm.  <a href="#p11"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#z125_0">uppergateOut</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">gate id  <a href="#z125_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radio_base.html#z125_1">uppergateIn</a></td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_radio_base_1_1_snr_struct.html">SnrStruct</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Struct to store a pointer to the message, rcvdPower AND a SnrList, needed in <a class="el" href="class_radio_base.html#b15">RadioBase::addNewSnr</a>.  <a href="struct_radio_base_1_1_snr_struct.html#_details">More...</a><br></td></tr>
</table>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="x0" doxytag="RadioBase::RecvBuff"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef std::map&lt;<a class="el" href="class_air_frame.html">AirFrame</a>*,double&gt; <a class="el" href="class_radio_base.html#x0">RadioBase::RecvBuff</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Typedef used to store received messages together with receive power. 
<p>
    </td>
  </tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="RadioBase::RadioBase"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">RadioBase::RadioBase           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00034                      : <a class="code" href="class_radio_base.html#p5">rs</a>(this-&gt;id())
00035 {
00036     <a class="code" href="class_radio_base.html#p0">radioModel</a> = NULL;
00037     <a class="code" href="class_radio_base.html#p1">receptionModel</a> = NULL;
00038 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="RadioBase::~RadioBase"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">RadioBase::~<a class="el" href="class_radio_base.html">RadioBase</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00109 {
00110     <span class="keyword">delete</span> <a class="code" href="class_radio_base.html#p0">radioModel</a>;
00111     <span class="keyword">delete</span> <a class="code" href="class_radio_base.html#p1">receptionModel</a>;
00112 
00113     <span class="comment">// delete messages being received</span>
00114     <span class="keywordflow">for</span> (RecvBuff::iterator it = <a class="code" href="class_radio_base.html#p4">recvBuff</a>.begin(); it!=<a class="code" href="class_radio_base.html#p4">recvBuff</a>.end(); ++it)
00115         <span class="keyword">delete</span> it-&gt;first;
00116 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b15" doxytag="RadioBase::addNewSnr"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::addNewSnr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
updates the snr information of the relevant AirFrames 
<p>
The Snr information of the buffered message is updated. <div class="fragment"><pre class="fragment">00556 {
00557     <a class="code" href="struct_snr_list_entry.html">SnrListEntry</a> listEntry;     <span class="comment">// create a new entry</span>
00558     listEntry.<a class="code" href="struct_snr_list_entry.html#o0">time</a> = simTime();
00559     listEntry.<a class="code" href="struct_snr_list_entry.html#o1">snr</a> = <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o1">rcvdPower</a> / <a class="code" href="class_radio_base.html#p8">noiseLevel</a>;
00560     <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o2">sList</a>.push_back(listEntry);
00561 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b9" doxytag="RadioBase::bufferMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::bufferMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Buffers message for 'transmission time'. 
<p>
The packet is put in a buffer for the time the transmission would last in reality. A timer indicates when the transmission is complete. So, look at unbufferMsg to see what happens when the transmission is complete.. <div class="fragment"><pre class="fragment">00185                                                    : add <span class="keyword">explicit</span> simtime_t atTime arg?
00186 {
00187     <span class="comment">// set timer to indicate transmission is complete</span>
00188     cMessage *endRxTimer = <span class="keyword">new</span> cMessage(<span class="stringliteral">"endRx"</span>, MK_RECEPTION_COMPLETE);
00189     endRxTimer-&gt;setContextPointer(airframe);
00190     airframe-&gt;setContextPointer(endRxTimer);
00191 
00192     <span class="comment">// NOTE: use arrivalTime instead of simTime, because we might be calling this</span>
00193     <span class="comment">// function during a channel change, when we're picking up ongoing transmissions</span>
00194     <span class="comment">// on the channel -- and then the message's arrival time is in the past!</span>
00195     scheduleAt(airframe-&gt;arrivalTime() + airframe-&gt;<a class="code" href="class_air_frame.html#a11">getDuration</a>(), endRxTimer);
00196 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="RadioBase::changeChannel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::changeChannel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>channel</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
change transmitter and receiver to a new channel. This method throws an error if the radio state is transmit. Messages that are already sent to the new channel and would reach us in the future - thus they are on the air - will be received correctly. 
<p>
<div class="fragment"><pre class="fragment">00564 {
00565     <span class="keywordflow">if</span> (channel == <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a3">getChannel</a>())
00566         <span class="keywordflow">return</span>;
00567     <span class="keywordflow">if</span> (channel &lt; 0 || channel &gt;= <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;<a class="code" href="class_channel_control.html#a12">getNumChannels</a>())
00568         error(<span class="stringliteral">"changeChannel(): channel number %d is out of range (hint: numChannels is a parameter of ChannelControl)"</span>, channel);
00569     <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a1">getState</a>() == <a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a>)
00570         error(<span class="stringliteral">"changing channel while transmitting is not allowed"</span>);
00571 
00572     <span class="comment">// if we are currently receiving, must clean that up before moving to different channel</span>
00573     <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a1">getState</a>() == <a class="code" href="class_radio_state.html#w4w1">RadioState::RECV</a>)
00574     {
00575         <span class="comment">// delete messages being received, and cancel associated self-messages</span>
00576         <span class="keywordflow">for</span> (RecvBuff::iterator it = <a class="code" href="class_radio_base.html#p4">recvBuff</a>.begin(); it!=<a class="code" href="class_radio_base.html#p4">recvBuff</a>.end(); ++it)
00577         {
00578             <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = it-&gt;first;
00579             cMessage *endRxTimer = (cMessage *)airframe-&gt;contextPointer();
00580             <span class="keyword">delete</span> airframe;
00581             <span class="keyword">delete</span> cancelEvent(endRxTimer);
00582         }
00583         <a class="code" href="class_radio_base.html#p4">recvBuff</a>.clear();
00584     }
00585 
00586     <span class="comment">// clear snr info</span>
00587     <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> = NULL;
00588     <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o2">sList</a>.clear();
00589 
00590     <span class="comment">// do channel switch</span>
00591     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Changing to channel #"</span> &lt;&lt; channel &lt;&lt; <span class="stringliteral">"\n"</span>;
00592 
00593     <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a4">setChannel</a>(channel);
00594     <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;<a class="code" href="class_channel_control.html#a5">updateHostChannel</a>(myHostRef, channel);
00595     <a class="code" href="class_channel_control.html#w2">ChannelControl::TransmissionList</a> tl = <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;<a class="code" href="class_channel_control.html#a6">getOngoingTransmissions</a>(channel);
00596 
00597     <span class="comment">// pick up ongoing transmissions on the new channel</span>
00598     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Picking up ongoing transmissions on new channel:\n"</span>;
00599     <span class="keywordflow">for</span> (ChannelControl::TransmissionList::const_iterator it = tl.begin(); it != tl.end(); ++it)
00600     {
00601         <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = *it;
00602         <span class="comment">// time for the message to reach us</span>
00603         <span class="keywordtype">double</span> distance = <a class="code" href="class_channel_access.html#p1">myHostRef</a>-&gt;<a class="code" href="struct_channel_control_1_1_host_entry.html#o1">pos</a>.<a class="code" href="class_coord.html#a7">distance</a>(airframe-&gt;<a class="code" href="class_air_frame.html#a15">getSenderPos</a>());
00604         <span class="keywordtype">double</span> propagationDelay = distance / <a class="code" href="_channel_control_8h.html#a0">LIGHT_SPEED</a>;
00605 
00606         <span class="comment">// if this transmission is on our new channel and it would reach us in the future, then schedule it</span>
00607         <span class="keywordflow">if</span> (channel == airframe-&gt;<a class="code" href="class_air_frame.html#a9">getChannelNumber</a>())
00608         {
00609             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">" - ("</span> &lt;&lt; airframe-&gt;className() &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; airframe-&gt;name() &lt;&lt; <span class="stringliteral">": "</span>;
00610 
00611             <span class="comment">// if there is a message on the air which will reach us in the future</span>
00612             <span class="keywordflow">if</span> (airframe-&gt;timestamp() + propagationDelay &gt;= simTime())
00613             {
00614                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"will arrive in the future, scheduling it\n"</span>;
00615 
00616                 <span class="comment">// we need to send to each radioIn[] gate</span>
00617                 cGate *radioGate = gate(<span class="stringliteral">"radioIn"</span>);
00618                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; radioGate-&gt;size(); i++)
00619                     sendDirect((cMessage*)airframe-&gt;dup(), airframe-&gt;timestamp() + propagationDelay - simTime(), this, radioGate-&gt;<span class="keywordtype">id</span>() + i);
00620             }
00621             <span class="comment">// if we hear some part of the message</span>
00622             else if (airframe-&gt;timestamp() + airframe-&gt;getDuration() + propagationDelay &gt; simTime())
00623             {
00624                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"missed beginning of frame, processing it as noise\n"</span>;
00625 
00626                 <a class="code" href="class_air_frame.html">AirFrame</a> *frameDup = (<a class="code" href="class_air_frame.html">AirFrame</a>*)airframe-&gt;<a class="code" href="class_air_frame.html#a4">dup</a>();
00627                 frameDup-&gt;setArrivalTime(airframe-&gt;timestamp() + propagationDelay);
00628                 <a class="code" href="class_radio_base.html#b7">handleLowerMsgStart</a>(frameDup);
00629                 <a class="code" href="class_radio_base.html#b9">bufferMsg</a>(frameDup);
00630             }
00631             <span class="keywordflow">else</span>
00632             {
00633                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"in the past\n"</span>;
00634             }
00635         }
00636     }
00637 
00638     <span class="comment">// notify other modules about the channel switch; and actually, radio state has changed too</span>
00639     <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIO_CHANNEL_CHANGED, &amp;rs);
00640     <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00641 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b14" doxytag="RadioBase::channelNumber"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual int RadioBase::channelNumber           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Redefined from BasicRadio <div class="fragment"><pre class="fragment">00116 {<span class="keywordflow">return</span> <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a3">getChannel</a>();}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b16" doxytag="RadioBase::createCapsulePkt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual <a class="el" href="class_air_frame.html">AirFrame</a>* RadioBase::createCapsulePkt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a new <a class="el" href="class_air_frame.html">AirFrame</a>. 
<p>
<div class="fragment"><pre class="fragment">00122 {<span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_air_frame.html">AirFrame</a>();};
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b17" doxytag="RadioBase::createRadioModel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual <a class="el" href="class_i_radio_model.html">IRadioModel</a>* RadioBase::createRadioModel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implemented in <a class="el" href="class_ieee80211_radio2.html#b1">Ieee80211Radio2</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b18" doxytag="RadioBase::createReceptionModel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual <a class="el" href="class_i_reception_model.html">IReceptionModel</a>* RadioBase::createReceptionModel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implemented in <a class="el" href="class_ieee80211_radio2.html#b0">Ieee80211Radio2</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b13" doxytag="RadioBase::encapsMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> * RadioBase::encapsMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Encapsulates a MAC frame into an Air Frame. 
<p>
This function encapsulates messages from the upper layer into an <a class="el" href="class_air_frame.html">AirFrame</a>. <div class="fragment"><pre class="fragment">00203 {
00204     <a class="code" href="class_phy_control_info.html">PhyControlInfo</a> *ctrl = dynamic_cast&lt;PhyControlInfo *&gt;(frame-&gt;removeControlInfo());
00205     ASSERT(!ctrl || ctrl-&gt;<a class="code" href="class_phy_control_info.html#a6">channelNumber</a>()==-1); <span class="comment">// per-packet channel switching not supported</span>
00206 
00207     <span class="comment">// Note: we don't set length() of the AirFrame, because duration will be used everywhere instead</span>
00208     <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = <a class="code" href="class_radio_base.html#b16">createCapsulePkt</a>();
00209     airframe-&gt;setName(frame-&gt;name());
00210     airframe-&gt;<a class="code" href="class_air_frame.html#a8">setPSend</a>(transmitterPower);
00211     airframe-&gt;<a class="code" href="class_air_frame.html#a10">setChannelNumber</a>(<a class="code" href="class_radio_base.html#b14">channelNumber</a>());
00212     airframe-&gt;encapsulate(frame);
00213     airframe-&gt;<a class="code" href="class_air_frame.html#a14">setBitrate</a>(ctrl ? ctrl-&gt;<a class="code" href="class_phy_control_info.html#a8">bitrate</a>() : <a class="code" href="class_radio_base.html#p5">rs</a>.getBitrate());
00214     airframe-&gt;<a class="code" href="class_air_frame.html#a12">setDuration</a>(<a class="code" href="class_radio_base.html#p0">radioModel</a>-&gt;<a class="code" href="class_i_radio_model.html#a2">calcDuration</a>(airframe));
00215     airframe-&gt;<a class="code" href="class_air_frame.html#a17">setSenderPos</a>(<a class="code" href="class_channel_access.html#b1">myPosition</a>());
00216     <span class="keyword">delete</span> ctrl;
00217 
00218     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Frame ("</span> &lt;&lt; frame-&gt;className() &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; frame-&gt;name()
00219        &lt;&lt; <span class="stringliteral">" will be transmitted at "</span> &lt;&lt; (airframe-&gt;<a class="code" href="class_air_frame.html#a13">getBitrate</a>()/1e6) &lt;&lt; <span class="stringliteral">"Mbps\n"</span>;
00220     <span class="keywordflow">return</span> airframe;
00221 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="RadioBase::finish"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::finish           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00105 {
00106 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b6" doxytag="RadioBase::handleCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::handleCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>msgkind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>cPolymorphic *&nbsp;</td>
          <td class="mdname" nowrap> <em>ctrl</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00301 {
00302     <span class="keywordflow">if</span> (msgkind==PHY_C_CONFIGURERADIO)
00303     {
00304         <span class="comment">// extract new channel number</span>
00305         <a class="code" href="class_phy_control_info.html">PhyControlInfo</a> *phyCtrl = check_and_cast&lt;PhyControlInfo *&gt;(ctrl);
00306         <span class="keywordtype">int</span> <a class="code" href="class_radio_base.html#p6">newChannel</a> = phyCtrl-&gt;<a class="code" href="class_phy_control_info.html#a6">channelNumber</a>();
00307         <span class="keywordtype">double</span> <a class="code" href="class_radio_base.html#p7">newBitrate</a> = phyCtrl-&gt;<a class="code" href="class_phy_control_info.html#a8">bitrate</a>();
00308         <span class="keyword">delete</span> ctrl;
00309 
00310         <span class="keywordflow">if</span> (newChannel!=-1)
00311         {
00312             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Command received: change to channel #"</span> &lt;&lt; newChannel &lt;&lt; <span class="stringliteral">"\n"</span>;
00313 
00314             <span class="comment">// do it</span>
00315             <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a3">getChannel</a>()==newChannel)
00316                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Right on that channel, nothing to do\n"</span>; <span class="comment">// fine, nothing to do</span>
00317             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a1">getState</a>()==<a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a>) {
00318                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"We're transmitting right now, remembering to change after it's completed\n"</span>;
00319                 this-&gt;newChannel = newChannel;
00320             } <span class="keywordflow">else</span>
00321                 <a class="code" href="class_radio_base.html#a1">changeChannel</a>(newChannel); <span class="comment">// change channel right now</span>
00322         }
00323         <span class="keywordflow">if</span> (newBitrate!=-1)
00324         {
00325             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Command received: change bitrate to "</span> &lt;&lt; (newBitrate/1e6) &lt;&lt; <span class="stringliteral">"Mbps\n"</span>;
00326 
00327             <span class="comment">// do it</span>
00328             <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a5">getBitrate</a>()==newBitrate)
00329                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Right at that bitrate, nothing to do\n"</span>; <span class="comment">// fine, nothing to do</span>
00330             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a1">getState</a>()==<a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a>) {
00331                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"We're transmitting right now, remembering to change after it's completed\n"</span>;
00332                 this-&gt;newBitrate = newBitrate;
00333             } <span class="keywordflow">else</span>
00334                 <a class="code" href="class_radio_base.html#a2">setBitrate</a>(newBitrate); <span class="comment">// change bitrate right now</span>
00335         }
00336     }
00337     <span class="keywordflow">else</span>
00338     {
00339         error(<span class="stringliteral">"unknown command (msgkind=%d)"</span>, msgkind);
00340     }
00341 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b8" doxytag="RadioBase::handleLowerMsgEnd"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::handleLowerMsgEnd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unbuffer the frame and update noise levels and snr information. 
<p>
This function is called right after the transmission is over, i.e. right after unbuffering. The noise level of the channel and the snr information of the buffered messages have to be updated.<p>
Additionally the <a class="el" href="class_radio_state.html">RadioState</a> has to be updated.<p>
If the corresponding <a class="el" href="class_air_frame.html">AirFrame</a> was not only noise the corresponding SnrList and the <a class="el" href="class_air_frame.html">AirFrame</a> are sent to the decider. <div class="fragment"><pre class="fragment">00488 {
00489     <span class="comment">// check if message has to be send to the decider</span>
00490     <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> == airframe)
00491     {
00492         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"reception of frame over, preparing to send packet to upper layer\n"</span>;
00493         <span class="comment">// get Packet and list out of the receive buffer:</span>
00494         <a class="code" href="_snr_list_8h.html#a0">SnrList</a> list;
00495         list = <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o2">sList</a>;
00496 
00497         <span class="comment">// delete the pointer to indicate that no message is currently</span>
00498         <span class="comment">// being received and clear the list</span>
00499         <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> = NULL;
00500         <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o2">sList</a>.clear();
00501 
00502         <span class="comment">// delete the frame from the recvBuff</span>
00503         <a class="code" href="class_radio_base.html#p4">recvBuff</a>.erase(airframe);
00504 
00505         <span class="comment">//XXX send up the frame:</span>
00506         <span class="comment">//if (radioModel-&gt;isReceivedCorrectly(airframe, list))</span>
00507         <span class="comment">//    sendUp(airframe);</span>
00508         <span class="comment">//else</span>
00509         <span class="comment">//    delete airframe;</span>
00510         <span class="keywordflow">if</span> (!<a class="code" href="class_radio_base.html#p0">radioModel</a>-&gt;<a class="code" href="class_i_radio_model.html#a3">isReceivedCorrectly</a>(airframe, list))
00511         {
00512             airframe-&gt;encapsulatedMsg()-&gt;setKind(list.size()&gt;1 ? <a class="code" href="_ieee80211_consts_8h.html#a1">COLLISION</a> : <a class="code" href="_ieee80211_consts_8h.html#a0">BITERROR</a>);
00513             airframe-&gt;setName(list.size()&gt;1 ? <span class="stringliteral">"COLLISION"</span> : <span class="stringliteral">"BITERROR"</span>);
00514         }
00515         <a class="code" href="class_radio_base.html#b11">sendUp</a>(airframe);
00516     }
00517     <span class="comment">// all other messages are noise</span>
00518     <span class="keywordflow">else</span>
00519     {
00520         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"reception of noise message over, removing recvdPower from noiseLevel....\n"</span>;
00521         <span class="comment">// get the rcvdPower and subtract it from the noiseLevel</span>
00522         <a class="code" href="class_radio_base.html#p8">noiseLevel</a> -= <a class="code" href="class_radio_base.html#p4">recvBuff</a>[airframe];
00523 
00524         <span class="comment">// delete message from the recvBuff</span>
00525         <a class="code" href="class_radio_base.html#p4">recvBuff</a>.erase(airframe);
00526 
00527         <span class="comment">// update snr info for message currently being received if any</span>
00528         <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> != NULL)
00529         {
00530             <a class="code" href="class_radio_base.html#b15">addNewSnr</a>();
00531         }
00532 
00533         <span class="comment">// message should be deleted</span>
00534         <span class="keyword">delete</span> airframe;
00535         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"message deleted\n"</span>;
00536     }
00537 
00538     <span class="comment">// check the RadioState and update if necessary</span>
00539     <span class="comment">// change to idle if noiseLevel smaller than threshold and state was</span>
00540     <span class="comment">// not idle before</span>
00541     <span class="comment">// do not change state if currently sending or receiving a message!!!</span>
00542     <span class="keywordflow">if</span> (noiseLevel &lt; sensitivity &amp;&amp; <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a1">getState</a>() == <a class="code" href="class_radio_state.html#w4w1">RadioState::RECV</a> &amp;&amp; <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> == NULL)
00543     {
00544         <span class="comment">// publish the new RadioState:</span>
00545         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"new RadioState is IDLE\n"</span>;
00546         <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">setState</a>(RadioState::IDLE);
00547         <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00548     }
00549 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="RadioBase::handleLowerMsgStart"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::handleLowerMsgStart           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Buffer the frame and update noise levels and snr information. 
<p>
This function is called right after a packet arrived, i.e. right before it is buffered for 'transmission time'.<p>
First the receive power of the packet has to be calculated and is stored in the recvBuff. Afterwards it has to be decided whether the packet is just noise or a "real" packet that needs to be received.<p>
The message is not treated as noise if all of the following conditions apply:<p>
<ol type=1>
<li>the power of the received signal is higher than the sensitivity.</li><li>the host is currently not sending a message</li><li>no other packet is already being received</li></ol>
<p>
If all conditions apply a new SnrList is created and the <a class="el" href="class_radio_state.html">RadioState</a> is changed to RECV.<p>
If the packet is just noise the receive power is added to the noise Level of the channel. Additionally the snr information of the currently being received message (if any) has to be updated as well as the <a class="el" href="class_radio_state.html">RadioState</a>. <div class="fragment"><pre class="fragment">00409 {
00410     <span class="comment">// Calculate the receive power of the message</span>
00411 
00412     <span class="comment">// calculate distance</span>
00413     <span class="keyword">const</span> <a class="code" href="class_coord.html">Coord</a>&amp; myPos = <a class="code" href="class_channel_access.html#b1">myPosition</a>();
00414     <span class="keyword">const</span> <a class="code" href="class_coord.html">Coord</a>&amp; framePos = airframe-&gt;<a class="code" href="class_air_frame.html#a15">getSenderPos</a>();
00415     <span class="keywordtype">double</span> distance = myPos.<a class="code" href="class_coord.html#a7">distance</a>(framePos);
00416 
00417     <span class="comment">// calculate receive power</span>
00418     <span class="keywordtype">double</span> rcvdPower = <a class="code" href="class_radio_base.html#p1">receptionModel</a>-&gt;<a class="code" href="class_i_reception_model.html#a1">calculateReceivedPower</a>(airframe-&gt;<a class="code" href="class_air_frame.html#a7">getPSend</a>(), <a class="code" href="class_radio_base.html#p9">carrierFrequency</a>, distance);
00419 
00420     <span class="comment">// store the receive power in the recvBuff</span>
00421     <a class="code" href="class_radio_base.html#p4">recvBuff</a>[airframe] = rcvdPower;
00422 
00423     <span class="comment">// if receive power is bigger than sensitivity and if not sending</span>
00424     <span class="comment">// and currently not receiving another message and the message has</span>
00425     <span class="comment">// arrived in time</span>
00426     <span class="comment">// NOTE: a message may have arrival time in the past here when we are</span>
00427     <span class="comment">// processing ongoing transmissions during a channel change</span>
00428     <span class="keywordflow">if</span> (airframe-&gt;arrivalTime() == simTime() &amp;&amp; rcvdPower &gt;= <a class="code" href="class_radio_base.html#p11">sensitivity</a> &amp;&amp; <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a1">getState</a>() != <a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a> &amp;&amp; <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> == NULL)
00429     {
00430         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"receiving frame "</span> &lt;&lt; airframe-&gt;name() &lt;&lt; endl;
00431 
00432         <span class="comment">// Put frame and related SnrList in receive buffer</span>
00433         <a class="code" href="_snr_list_8h.html#a0">SnrList</a> snrList;        <span class="comment">//defined in SnrList.h!!</span>
00434         <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> = airframe;
00435         <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o1">rcvdPower</a> = rcvdPower;
00436         <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o2">sList</a> = snrList;
00437 
00438         <span class="comment">// add initial snr value</span>
00439         <a class="code" href="class_radio_base.html#b15">addNewSnr</a>();
00440 
00441         <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a1">getState</a>() != <a class="code" href="class_radio_state.html#w4w1">RadioState::RECV</a>)
00442         {
00443             <span class="comment">// publish new RadioState</span>
00444             <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">setState</a>(RadioState::RECV);
00445             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"publish new RadioState:RECV\n"</span>;
00446             <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00447         }
00448     }
00449     <span class="comment">// receive power is too low or another message is being sent or received</span>
00450     <span class="keywordflow">else</span>
00451     {
00452         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"frame "</span> &lt;&lt; airframe-&gt;name() &lt;&lt; <span class="stringliteral">" is just noise\n"</span>;
00453         <span class="comment">//add receive power to the noise level</span>
00454         <a class="code" href="class_radio_base.html#p8">noiseLevel</a> += rcvdPower;
00455 
00456         <span class="comment">// if a message is being received add a new snr value</span>
00457         <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> != NULL)
00458         {
00459             <span class="comment">// update snr info for currently being received message</span>
00460             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"add new snr value to snr list of message being received\n"</span>;
00461             <a class="code" href="class_radio_base.html#b15">addNewSnr</a>();
00462         }
00463 
00464         <span class="comment">// update the RadioState if the noiseLevel exceeded the threshold</span>
00465         <span class="comment">// and the radio is currently not in receive or in send mode</span>
00466         <span class="keywordflow">if</span> (noiseLevel &gt;= sensitivity &amp;&amp; <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a1">getState</a>() == <a class="code" href="class_radio_state.html#w4w0">RadioState::IDLE</a>)
00467         {
00468             <span class="comment">// publish new RadioState</span>
00469             <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">setState</a>(RadioState::RECV);
00470             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"publish new RadioState:RECV\n"</span>;
00471             <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00472         }
00473     }
00474 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="RadioBase::handleMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::handleMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The basic handle message function.<p>
Depending on the gate a message arrives handleMessage just calls different handle*Msg functions to further process the message.<p>
Messages from the channel are also buffered here in order to simulate a transmission delay<p>
You should not make any changes in this function but implement all your functionality into the handle*Msg functions called from here.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_radio_base.html#b4">handleUpperMsg</a>, <a class="el" href="class_radio_base.html#b7">handleLowerMsgStart</a>, <a class="el" href="class_radio_base.html#b8">handleLowerMsgEnd</a>, <a class="el" href="class_radio_base.html#b5">handleSelfMsg</a> </dd></dl>
<div class="fragment"><pre class="fragment">00134 {
00135     <span class="comment">// handle commands</span>
00136     <span class="keywordflow">if</span> (msg-&gt;arrivalGateId()==<a class="code" href="class_radio_base.html#z125_1">uppergateIn</a> &amp;&amp; msg-&gt;length()==0)
00137     {
00138         cPolymorphic *ctrl = msg-&gt;removeControlInfo();
00139         <span class="keywordflow">if</span> (msg-&gt;kind()==0)
00140             error(<span class="stringliteral">"Message '%s' with length==0 is supposed to be a command, but msg kind is also zero"</span>, msg-&gt;name());
00141         <a class="code" href="class_radio_base.html#b6">handleCommand</a>(msg-&gt;kind(), ctrl);
00142         <span class="keyword">delete</span> msg;
00143         <span class="keywordflow">return</span>;
00144     }
00145 
00146     <span class="keywordflow">if</span> (msg-&gt;arrivalGateId() == <a class="code" href="class_radio_base.html#z125_1">uppergateIn</a>)
00147     {
00148         <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = <a class="code" href="class_radio_base.html#b13">encapsMsg</a>(msg);
00149         <a class="code" href="class_radio_base.html#b4">handleUpperMsg</a>(airframe);
00150     }
00151     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;isSelfMessage())
00152     {
00153         <span class="keywordflow">if</span> (msg-&gt;kind()==<a class="code" href="_radio_base_8cc.html#a1">MK_RECEPTION_COMPLETE</a>)
00154         {
00155             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"frame is completely received now\n"</span>;
00156 
00157             <span class="comment">// unbuffer the message</span>
00158             <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = <a class="code" href="class_radio_base.html#b10">unbufferMsg</a>(msg);
00159 
00160             <a class="code" href="class_radio_base.html#b8">handleLowerMsgEnd</a>(airframe);
00161         }
00162         <span class="keywordflow">else</span>
00163             <a class="code" href="class_radio_base.html#b5">handleSelfMsg</a>(msg);
00164     }
00165     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (check_and_cast&lt;AirFrame *&gt;(msg)-&gt;getChannelNumber() == <a class="code" href="class_radio_base.html#b14">channelNumber</a>())
00166     {
00167         <span class="comment">// must be an AirFrame</span>
00168         <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = (<a class="code" href="class_air_frame.html">AirFrame</a> *) msg;
00169         <a class="code" href="class_radio_base.html#b7">handleLowerMsgStart</a>(airframe);
00170         <a class="code" href="class_radio_base.html#b9">bufferMsg</a>(airframe);
00171     }
00172     <span class="keywordflow">else</span>
00173     {
00174         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"listening to different channel when receiving message -- dropping it\n"</span>;
00175         <span class="keyword">delete</span> msg;
00176     }
00177 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="RadioBase::handleSelfMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::handleSelfMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The only self message that can arrive is a timer to indicate that sending of a message is completed.<p>
The <a class="el" href="class_radio_state.html">RadioState</a> has to be changed based on the noise level on the channel. If the noise level is bigger than the sensitivity switch to receive mode odtherwise to idle mode. <div class="fragment"><pre class="fragment">00352 {
00353     <span class="keywordflow">if</span> (msg-&gt;kind() == <a class="code" href="_radio_base_8cc.html#a0">MK_TRANSMISSION_OVER</a>)
00354     {
00355         <span class="keywordflow">if</span> (noiseLevel &lt; sensitivity)
00356         {
00357             <span class="comment">// set the RadioState to IDLE</span>
00358             <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">setState</a>(RadioState::IDLE);
00359             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"transmission over, switch to idle mode (state:IDLE)\n"</span>;
00360             <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00361         }
00362         <span class="keywordflow">else</span>
00363         {
00364             <span class="comment">// set the RadioState to RECV</span>
00365             <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">setState</a>(RadioState::RECV);
00366             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"transmission over but noise level too high, switch to recv mode (state:RECV)\n"</span>;
00367             <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00368         }
00369 
00370         <span class="comment">// delete the timer</span>
00371         <span class="keyword">delete</span> msg;
00372 
00373         <span class="comment">// switch channel if it needs be</span>
00374         <span class="keywordflow">if</span> (newChannel!=-1)
00375         {
00376             <a class="code" href="class_radio_base.html#a1">changeChannel</a>(newChannel);
00377             <a class="code" href="class_radio_base.html#p6">newChannel</a> = -1;
00378         }
00379     }
00380     <span class="keywordflow">else</span>
00381         error(<span class="stringliteral">"Internal error: unknown self-message `%s'"</span>, msg-&gt;name());
00382 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="RadioBase::handleUpperMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::handleUpperMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
If a message is already being transmitted, an error is raised.<p>
Otherwise the <a class="el" href="class_radio_state.html">RadioState</a> is set to TRANSMIT and a timer is started. When this timer expires the <a class="el" href="class_radio_state.html">RadioState</a> will be set back to RECV (or IDLE respectively) again.<p>
If the host is receiving a packet this packet is from now on only considered as noise. <div class="fragment"><pre class="fragment">00265 {
00266     <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a1">getState</a>() == <a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a>)
00267         error(<span class="stringliteral">"Trying to send a message while already transmitting -- MAC should "</span>
00268               <span class="stringliteral">"take care this does not happen"</span>);
00269 
00270     <span class="comment">// if a packet was being received, it is corrupted now as should be treated as noise</span>
00271     <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> != NULL)
00272     {
00273         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Sending a message while receiving another. The received one is now corrupted.\n"</span>;
00274 
00275         <span class="comment">// remove the snr information stored for the message currently being</span>
00276         <span class="comment">// received. This message is treated as noise now and the</span>
00277         <span class="comment">// receive power has to be added to the noiseLevel</span>
00278 
00279         <span class="comment">// delete the pointer to indicate that no message is being received</span>
00280         <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> = NULL;
00281         <span class="comment">// clear the snr list</span>
00282         <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o2">sList</a>.clear();
00283         <span class="comment">// add the receive power to the noise level</span>
00284         <a class="code" href="class_radio_base.html#p8">noiseLevel</a> += <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o1">rcvdPower</a>;
00285     }
00286 
00287     <span class="comment">// now we are done with all the exception handling and can take care</span>
00288     <span class="comment">// about the "real" stuff</span>
00289 
00290     <span class="comment">// change radio status</span>
00291     <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">setState</a>(RadioState::TRANSMIT);
00292     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending, changing RadioState to TRANSMIT\n"</span>;
00293     <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00294 
00295     cMessage *timer = <span class="keyword">new</span> cMessage(NULL, MK_TRANSMISSION_OVER);
00296     scheduleAt(simTime() + airframe-&gt;<a class="code" href="class_air_frame.html#a11">getDuration</a>(), timer);
00297     <a class="code" href="class_radio_base.html#b12">sendDown</a>(airframe);
00298 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="RadioBase::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize variables and publish the radio status. 
<p>

<p>
Reimplemented from <a class="el" href="class_channel_access.html#b2">ChannelAccess</a>.<div class="fragment"><pre class="fragment">00041 {
00042     <a class="code" href="class_channel_access.html#b2">ChannelAccess::initialize</a>(stage);
00043 
00044     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Initializing RadioBase, stage="</span> &lt;&lt; stage &lt;&lt; endl;
00045 
00046     <span class="keywordflow">if</span> (stage == 0)
00047     {
00048         <a class="code" href="class_radio_base.html#z125_1">uppergateIn</a> = findGate(<span class="stringliteral">"uppergateIn"</span>);
00049         <a class="code" href="class_radio_base.html#z125_0">uppergateOut</a> = findGate(<span class="stringliteral">"uppergateOut"</span>);
00050 
00051         <span class="comment">// read parameters</span>
00052         <a class="code" href="class_radio_base.html#p2">transmitterPower</a> = par(<span class="stringliteral">"transmitterPower"</span>);
00053         <span class="keywordflow">if</span> (transmitterPower &gt; (<span class="keywordtype">double</span>) (<a class="code" href="class_channel_access.html#p0">cc</a>-&gt;par(<span class="stringliteral">"pMax"</span>)))
00054             error(<span class="stringliteral">"transmitterPower cannot be bigger than pMax in ChannelControl!"</span>);
00055         <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a6">setBitrate</a>(par(<span class="stringliteral">"bitrate"</span>));
00056         <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a4">setChannel</a>(par(<span class="stringliteral">"channelNumber"</span>));
00057         <a class="code" href="class_radio_base.html#p10">thermalNoise</a> = <a class="code" href="class_f_w_math.html#e7">FWMath::dBm2mW</a>(par(<span class="stringliteral">"thermalNoise"</span>));
00058         <a class="code" href="class_radio_base.html#p9">carrierFrequency</a> = <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;par(<span class="stringliteral">"carrierFrequency"</span>);  <span class="comment">// taken from ChannelControl</span>
00059         <a class="code" href="class_radio_base.html#p11">sensitivity</a> = <a class="code" href="class_f_w_math.html#e7">FWMath::dBm2mW</a>(par(<span class="stringliteral">"sensitivity"</span>));
00060 
00061         <span class="comment">// initialize noiseLevel</span>
00062         <a class="code" href="class_radio_base.html#p8">noiseLevel</a> = <a class="code" href="class_radio_base.html#p10">thermalNoise</a>;
00063 
00064         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Initialized channel with noise: "</span> &lt;&lt; <a class="code" href="class_radio_base.html#p8">noiseLevel</a> &lt;&lt; <span class="stringliteral">" sensitivity: "</span> &lt;&lt; <a class="code" href="class_radio_base.html#p11">sensitivity</a> &lt;&lt;
00065             endl;
00066 
00067         <span class="comment">// initialize the pointer of the snrInfo with NULL to indicate</span>
00068         <span class="comment">// that currently no message is received</span>
00069         <a class="code" href="class_radio_base.html#p3">snrInfo</a>.<a class="code" href="struct_radio_base_1_1_snr_struct.html#o0">ptr</a> = NULL;
00070 
00071         <span class="comment">// no channel switch pending</span>
00072         <a class="code" href="class_radio_base.html#p6">newChannel</a> = -1;
00073 
00074         <span class="comment">// Initialize radio state. If thermal noise is already to high, radio</span>
00075         <span class="comment">// state has to be initialized as RECV</span>
00076         <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">setState</a>(RadioState::IDLE);
00077         <span class="keywordflow">if</span> (noiseLevel &gt;= sensitivity)
00078             rs.setState(<a class="code" href="class_radio_state.html">RadioState</a>::RECV);
00079 
00080         WATCH(noiseLevel);
00081         WATCH(rs);
00082 
00083         receptionModel = createReceptionModel();
00084         receptionModel-&gt;initializeFrom(this);
00085 
00086         radioModel = createRadioModel();
00087         radioModel-&gt;initializeFrom(this);
00088     }
00089     else if (stage == 1)
00090     {
00091         <span class="comment">// tell initial value to MAC; must be done in stage 1, because they</span>
00092         <span class="comment">// subscribe in stage 0</span>
00093         <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00094         <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIO_CHANNEL_CHANGED, &amp;rs);
00095     }
00096     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stage == 2)
00097     {
00098         <span class="comment">// tell initial channel number to ChannelControl; should be done in</span>
00099         <span class="comment">// stage==2 or later, because base class initializes myHostRef in that stage</span>
00100         <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;<a class="code" href="class_channel_control.html#a5">updateHostChannel</a>(myHostRef, <a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a3">getChannel</a>());
00101     }
00102 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b12" doxytag="RadioBase::sendDown"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::sendDown           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to the channel. 
<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_channel_access.html#b0">sendToChannel</a> </dd></dl>
<div class="fragment"><pre class="fragment">00237 {
00238     <a class="code" href="class_channel_access.html#b0">sendToChannel</a>(airframe);
00239 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b11" doxytag="RadioBase::sendUp"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::sendUp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to the upper layer. 
<p>
<div class="fragment"><pre class="fragment">00224 {
00225     cMessage *frame = airframe-&gt;decapsulate();
00226     <span class="keyword">delete</span> airframe;
00227     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending up frame "</span> &lt;&lt; frame-&gt;name() &lt;&lt; endl;
00228     send(frame, uppergateOut);
00229 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="RadioBase::setBitrate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void RadioBase::setBitrate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bitrate</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
change the bitrate to the given value. This method throws an error if the radio state is transmit. 
<p>
<div class="fragment"><pre class="fragment">00644 {
00645     <span class="keywordflow">if</span> (<a class="code" href="class_radio_base.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a5">getBitrate</a>() == bitrate)
00646         <span class="keywordflow">return</span>;
00647     <span class="keywordflow">if</span> (bitrate &lt; 0)
00648         error("setBitrate(): bitrate cannot be negative (%g)", bitrate);
00649     if (rs.getState() == <a class="code" href="class_radio_state.html">RadioState</a>::TRANSMIT)
00650         error("changing the bitrate while transmitting is not allowed");
00651 
00652     EV &lt;&lt; "Setting bitrate to " &lt;&lt; (bitrate/1e6) &lt;&lt; "Mbps\n";
00653     rs.setBitrate(bitrate);
00654 
00655     <span class="comment">//XXX fire some notification?</span>
00656 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b10" doxytag="RadioBase::unbufferMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> * RadioBase::unbufferMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unbuffers a message after 'transmission time'. 
<p>
Get the context pointer to the now completely received <a class="el" href="class_air_frame.html">AirFrame</a> and delete the self message <div class="fragment"><pre class="fragment">00246 {
00247     <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = (<a class="code" href="class_air_frame.html">AirFrame</a> *) msg-&gt;contextPointer();
00248     <span class="comment">//delete the self message</span>
00249     <span class="keyword">delete</span> msg;
00250 
00251     <span class="keywordflow">return</span> airframe;
00252 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p9" doxytag="RadioBase::carrierFrequency"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_radio_base.html#p9">RadioBase::carrierFrequency</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Configuration: The carrier frequency used. It is read from the <a class="el" href="class_channel_control.html">ChannelControl</a> module. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p7" doxytag="RadioBase::newBitrate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_radio_base.html#p7">RadioBase::newBitrate</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: if not -1, we have to switch to that bitrate once we finished transmitting. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p6" doxytag="RadioBase::newChannel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_radio_base.html#p6">RadioBase::newChannel</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: if not -1, we have to switch to that channel once we finished transmitting. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p8" doxytag="RadioBase::noiseLevel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_radio_base.html#p8">RadioBase::noiseLevel</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: the current noise level of the channel. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="RadioBase::radioModel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_radio_model.html">IRadioModel</a>* <a class="el" href="class_radio_base.html#p0">RadioBase::radioModel</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="RadioBase::receptionModel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_reception_model.html">IReceptionModel</a>* <a class="el" href="class_radio_base.html#p1">RadioBase::receptionModel</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p4" doxytag="RadioBase::recvBuff"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_radio_base.html#x0">RecvBuff</a> <a class="el" href="class_radio_base.html#p4">RadioBase::recvBuff</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: A buffer to store a pointer to a message and the related receive power. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p5" doxytag="RadioBase::rs"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_radio_state.html">RadioState</a> <a class="el" href="class_radio_base.html#p5">RadioBase::rs</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: the current <a class="el" href="class_radio_state.html">RadioState</a> of the NIC; includes channel number. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p11" doxytag="RadioBase::sensitivity"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_radio_base.html#p11">RadioBase::sensitivity</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Configuration: Defines up to what Power level (in dBm) a message can be understood. If the level of a received packet is lower, it is only treated as noise. Can be specified in omnetpp.ini. Default: -85 dBm. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="RadioBase::snrInfo"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="struct_radio_base_1_1_snr_struct.html">SnrStruct</a> <a class="el" href="class_radio_base.html#p3">RadioBase::snrInfo</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: SnrInfo stores the snrList and the the recvdPower for the message currently being received, together with a pointer to the message. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p10" doxytag="RadioBase::thermalNoise"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_radio_base.html#p10">RadioBase::thermalNoise</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Configuration: Thermal noise on the channel. Can be specified in omnetpp.ini. Default: -100 dBm. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p2" doxytag="RadioBase::transmitterPower"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_radio_base.html#p2">RadioBase::transmitterPower</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
power used to transmit messages 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z125_1" doxytag="RadioBase::uppergateIn"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_radio_base.html#z125_1">RadioBase::uppergateIn</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z125_0" doxytag="RadioBase::uppergateOut"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_radio_base.html#z125_0">RadioBase::uppergateOut</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
gate id 
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_radio_base_8h.html">RadioBase.h</a><li><a class="el" href="_radio_base_8cc.html">RadioBase.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sun Sep 3 10:47:09 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
