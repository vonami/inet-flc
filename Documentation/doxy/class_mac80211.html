<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: Mac80211 Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>Mac80211 Class Reference</h1><code>#include &lt;Mac80211.h&gt;</code>
<p>
<p>Inheritance diagram for Mac80211:
<p><center><img src="class_mac80211.png" usemap="#Mac80211_map" border="0" alt=""></center>
<map name="Mac80211_map">
<area href="class_wireless_mac_base.html" alt="WirelessMacBase" shape="rect" coords="0,0,113,24">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="123,0,236,24">
</map>
<a href="class_mac80211-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
An implementation of the 802.11b MAC. 
<p>
For more info, see the NED file.<p>
<dl compact><dt><b>Author:</b></dt><dd>David Raguin </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#a0">Mac80211</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#a1">~Mac80211</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b0">numInitStages</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and some variables.  <a href="#b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b1">initialize</a> (int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and some variables.  <a href="#b1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b2">registerInterface</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register the interface in <a class="el" href="class_interface_table.html">InterfaceTable</a>.  <a href="#b2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b3">receiveChangeNotification</a> (int category, cPolymorphic *details)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called by the <a class="el" href="class_notification_board.html">NotificationBoard</a> whenever a change occurs we're interested in.  <a href="#b3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b4">handleSelfMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle self messages such as timer...  <a href="#b4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b5">handleUpperMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from upper layer.  <a href="#b5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b6">handleLowerMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from lower layer.  <a href="#b6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b7">handleEndContentionTimer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle end of contention  <a href="#b7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b8">handleMsgNotForMe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle a message that is not for me or errornous  <a href="#b8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b9">handleMsgForMe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle a message that was meant for me  <a href="#b9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b10">handleBroadcastMsg</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b11">handleEndTransmissionTimer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle the end of a transmission...  <a href="#b11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b12">handleEndSifsTimer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle end of SIFS  <a href="#b12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b13">handleTimeoutTimer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle time out  <a href="#b13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b14">handleNavTimer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">NAV timer expired, the exchange of messages of other stations is done.  <a href="#b14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b15">handleRTSframe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b16">handleDATAframe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b17">handleACKframe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b18">handleCTSframe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b19">sendDATAframe</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send data frame  <a href="#b19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b20">sendACKframe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Acknoledgement  <a href="#b20"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b21">sendCTSframe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send CTS frame  <a href="#b21"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b22">sendRTSframe</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send RTS frame  <a href="#b22"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b23">sendBROADCASTframe</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send broadcast frame  <a href="#b23"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b24">encapsMsg</a> (cMessage *netw)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">encapsulate packet  <a href="#b24"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b25">decapsulateAndSendUp</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">decapsulate packet and send to higher layer  <a href="#b25"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b26">buildDATAframe</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">build a data frame  <a href="#b26"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b27">buildACKframe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">build an ACK  <a href="#b27"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b28">buildCTSframe</a> (<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">build a CTS frame  <a href="#b28"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b29">buildRTSframe</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">build an RTS frame  <a href="#b29"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b30">buildBROADCASTframe</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">build a broadcast frame  <a href="#b30"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b31">beginNewCycle</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">start a new contention period  <a href="#b31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b32">backoff</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute a backoff value.  <a href="#b32"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b33">contentionWindow</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute a new contention window.  <a href="#b33"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b34">testMaxAttempts</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Test if maximum number of retries to transmit is exceeded.  <a href="#b34"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b35">timeOut</a> (<a class="el" href="_consts80211_8h.html#a24">_802_11frameType</a> type, double last_frame_duration)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return a timeOut value for a certain type of frame  <a href="#b35"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b36">packetDuration</a> (int bits)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">computes the duration of a transmission over the physical channel  <a href="#b36"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b37">stateName</a> (<a class="el" href="class_mac80211.html#y14">State</a> <a class="el" href="class_mac80211.html#p8">state</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produce a readable name of the given state.  <a href="#b37"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b38">timerTypeName</a> (int type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produce a readable name of the given timer type.  <a href="#b38"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b39">pktTypeName</a> (int type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produce a readable name of the given packet type.  <a href="#b39"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#b40">setState</a> (<a class="el" href="class_mac80211.html#y14">State</a> <a class="el" href="class_mac80211.html#p8">state</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the state, and produces a log message in between.  <a href="#b40"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_m_a_c_address.html">MACAddress</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p0">myMacAddr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mac address  <a href="#p0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p1">timeout</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet.  <a href="#p1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p2">nav</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timer used for the defer time of a node. Also called NAV : networks allocation vector.  <a href="#p2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p3">contention</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timer used for contention periods.  <a href="#p3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p4">endTransmission</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timer used to indicate the end of the transmission of an ACK or a BROADCAST packet.  <a href="#p4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p5">endSifs</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timer used to indicate the end of a SIFS.  <a href="#p5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p6">EIFS</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">extended interframe space  <a href="#p6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p7">BW</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Variable to store the current backoff value.  <a href="#p7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_mac80211.html#y14">State</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p8">state</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Current state of the MAC.  <a href="#p8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_radio_state.html#w4">RadioState::State</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p9">radioState</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Current state of the radio (kept updated by <a class="el" href="class_mac80211.html#b3">receiveChangeNotification()</a>).  <a href="#p9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p10">maxQueueSize</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximal number of packets in the queue; should be set in the omnetpp.ini.  <a href="#p10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p11">nextIsBroadcast</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Boolean used to know if the next packet is a broadcast packet.  <a href="#p11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_mac80211.html#y0">MacPktList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p12">fromUpperLayer</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffering of messages from upper layer.  <a href="#p12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p13">retryCounter</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of frame transmission attempt.  <a href="#p13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p14">tryWithoutBackoff</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If there's a new packet to send and the channel is free, no backoff is needed.  <a href="#p14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p15">rtsCts</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">true if Rts/Cts is used, false if not; can be set in omnetpp.ini  <a href="#p15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p16">delta</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Very small value used in timer scheduling in order to avoid multiple changements of state in the same simulation time.  <a href="#p16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p17">bitrate</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The bitrate should be set in omnetpp.ini; be sure to use a valid 802.11 bitrate.  <a href="#p17"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#p18">broadcastBackoff</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Should be set in the omnetpp.ini.  <a href="#p18"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Private Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::list&lt; <a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#y0">MacPktList</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#y13">timerType</a> { <br>
&nbsp;&nbsp;<a class="el" href="class_mac80211.html#y13y1">TIMEOUT</a>, 
<a class="el" href="class_mac80211.html#y13y2">NAV</a>, 
<a class="el" href="class_mac80211.html#y13y3">CONTENTION</a>, 
<a class="el" href="class_mac80211.html#y13y4">END_TRANSMISSION</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="class_mac80211.html#y13y5">END_SIFS</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mac80211.html#y14">State</a> { <br>
&nbsp;&nbsp;<a class="el" href="class_mac80211.html#y14y6">WFDATA</a> =  0, 
<a class="el" href="class_mac80211.html#y14y7">QUIET</a> =  1, 
<a class="el" href="class_mac80211.html#y14y8">IDLE</a> =  2, 
<a class="el" href="class_mac80211.html#y14y9">CONTEND</a> =  3, 
<br>
&nbsp;&nbsp;<a class="el" href="class_mac80211.html#y14y10">WFCTS</a> =  4, 
<a class="el" href="class_mac80211.html#y14y11">WFACK</a> =  5, 
<a class="el" href="class_mac80211.html#y14y12">BUSY</a> =  6
<br>
 }</td></tr>

</table>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="y0" doxytag="Mac80211::MacPktList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef std::list&lt;<a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a>*&gt; <a class="el" href="class_mac80211.html#y0">Mac80211::MacPktList</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="y14" doxytag="Mac80211::State"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="class_mac80211.html#y14">Mac80211::State</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Definition of the states <dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="y14y6" doxytag="WFDATA"></a>WFDATA</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y14y7" doxytag="QUIET"></a>QUIET</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y14y8" doxytag="IDLE"></a>IDLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y14y9" doxytag="CONTEND"></a>CONTEND</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y14y10" doxytag="WFCTS"></a>WFCTS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y14y11" doxytag="WFACK"></a>WFACK</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y14y12" doxytag="BUSY"></a>BUSY</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>
<div class="fragment"><pre class="fragment">00054                {
00055       <a class="code" href="class_mac80211.html#y14y6">WFDATA</a> = 0, <span class="comment">// waiting for data packet</span>
00056       <a class="code" href="class_mac80211.html#y14y7">QUIET</a> = 1,  <span class="comment">// waiting for the communication between two other nodes to end</span>
00057       <a class="code" href="class_mac80211.html#y14y8">IDLE</a> = 2,   <span class="comment">// no packet to send, no packet receiving</span>
00058       <a class="code" href="class_mac80211.html#y14y9">CONTEND</a> = 3,<span class="comment">// contention state (battle for the channel)</span>
00059       <a class="code" href="class_mac80211.html#y14y10">WFCTS</a> = 4,  <span class="comment">// RTS sent, waiting for CTS</span>
00060       <a class="code" href="class_mac80211.html#y14y11">WFACK</a> = 5,  <span class="comment">// DATA packet sent, waiting for ACK</span>
00061       <a class="code" href="class_mac80211.html#y14y12">BUSY</a> = 6    <span class="comment">// during transmission of an ACK or a BROADCAST packet</span>
00062     };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="y13" doxytag="Mac80211::timerType"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="class_mac80211.html#y13">Mac80211::timerType</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Definition of the timer types <dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="y13y1" doxytag="TIMEOUT"></a>TIMEOUT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y13y2" doxytag="NAV"></a>NAV</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y13y3" doxytag="CONTENTION"></a>CONTENTION</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y13y4" doxytag="END_TRANSMISSION"></a>END_TRANSMISSION</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="y13y5" doxytag="END_SIFS"></a>END_SIFS</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>
<div class="fragment"><pre class="fragment">00045                    {
00046       <a class="code" href="class_mac80211.html#y13y1">TIMEOUT</a>,
00047       <a class="code" href="class_mac80211.html#y13y2">NAV</a>,
00048       <a class="code" href="class_mac80211.html#y13y3">CONTENTION</a>,
00049       <a class="code" href="class_mac80211.html#y13y4">END_TRANSMISSION</a>,
00050       <a class="code" href="class_mac80211.html#y13y5">END_SIFS</a>
00051     };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="Mac80211::Mac80211"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Mac80211::Mac80211           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00032 {
00033     <a class="code" href="class_mac80211.html#p1">timeout</a> = <a class="code" href="class_mac80211.html#p2">nav</a> = <a class="code" href="class_mac80211.html#p3">contention</a> = <a class="code" href="class_mac80211.html#p4">endTransmission</a> = <a class="code" href="class_mac80211.html#p5">endSifs</a> = NULL;
00034 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="Mac80211::~Mac80211"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Mac80211::~<a class="el" href="class_mac80211.html">Mac80211</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00037 {
00038     cancelAndDelete(timeout);
00039     cancelAndDelete(nav);
00040     cancelAndDelete(contention);
00041     cancelAndDelete(endTransmission);
00042     cancelAndDelete(endSifs);
00043 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b32" doxytag="Mac80211::backoff"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Mac80211::backoff           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Compute a backoff value. 
<p>
Compute the backoff value. <div class="fragment"><pre class="fragment">00843 {
00844     <span class="comment">// the MAC has won the previous contention. We have to compute a new</span>
00845     <span class="comment">// backoff window</span>
00846     <span class="keywordflow">if</span> (BW == 0) {
00847         <span class="keywordtype">int</span> CW = <a class="code" href="class_mac80211.html#b33">contentionWindow</a>();
00848         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"generating backoff for CW: "</span> &lt;&lt; CW &lt;&lt; endl;
00849         <a class="code" href="class_mac80211.html#p7">BW</a> = ((double) intrand(CW + 1)) * <a class="code" href="_ieee80211_consts_8h.html#a5">ST</a>;
00850     }
00851     <span class="comment">// CW is the contention window (see the function). ST is the</span>
00852     <span class="comment">// slot time.  else we take the old value of BW, in order to give a</span>
00853     <span class="comment">// bigger priority to a node which has lost a previous contention</span>
00854     <span class="comment">// period.</span>
00855     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"backing off for: "</span> &lt;&lt; <a class="code" href="class_mac80211.html#p7">BW</a> + <a class="code" href="_ieee80211_consts_8h.html#a7">DIFS</a> &lt;&lt; endl;
00856     <span class="keywordflow">return</span> <a class="code" href="class_mac80211.html#p7">BW</a>;
00857 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b31" doxytag="Mac80211::beginNewCycle"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::beginNewCycle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
start a new contention period 
<p>
Start a new contention period if the channel is free and if there's a packet to send. Called at the end of a deferring period, a busy period, or after a failure. Called by the HandleMsgForMe(), HandleTimer() HandleUpperMsg(), and, without RTS/CTS, by <a class="el" href="class_mac80211.html#b8">handleMsgNotForMe()</a>. <div class="fragment"><pre class="fragment">00795 {
00796     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"beginning new contention cycle\n"</span>;
00797 
00798     <span class="comment">// before trying to send one more time a packet, test if the</span>
00799     <span class="comment">// maximum retry limit is reached. If it is the case, then</span>
00800     <span class="comment">// delete the packet and send the next packet.</span>
00801     <a class="code" href="class_mac80211.html#b34">testMaxAttempts</a>();
00802 
00803     <span class="keywordflow">if</span> (!<a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.empty())
00804     {
00805 
00806         <span class="comment">// look if the next packet is unicast or broadcast</span>
00807         <a class="code" href="class_mac80211.html#p11">nextIsBroadcast</a> = (((<a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *) <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front())-&gt;getDestAddr().isBroadcast());
00808 
00809         <span class="comment">// print("next is broadcast = "&lt;&lt;nextIsBroadcast);</span>
00810 
00811         <span class="comment">// if the channel is free then wait a random time and transmit</span>
00812         <span class="keywordflow">if</span> (radioState == RadioState::IDLE)
00813         {
00814             <span class="comment">// if channel is idle AND I was not the last one that transmitted</span>
00815             <span class="comment">// data: no backoff</span>
00816             <span class="keywordflow">if</span> (tryWithoutBackoff)
00817             {
00818                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"trying to send without backoff...\n"</span>;
00819                 scheduleAt(simTime() + DIFS, contention);
00820             }
00821             <span class="keywordflow">else</span>
00822             {
00823                 <span class="comment">// backoff!</span>
00824                 scheduleAt(simTime() + <a class="code" href="class_mac80211.html#b32">backoff</a>() + DIFS, contention);
00825             }
00826         }
00827         <a class="code" href="class_mac80211.html#p14">tryWithoutBackoff</a> = <span class="keyword">false</span>;
00828 
00829         <span class="comment">// else wait until the channel gets free; the state is now contend</span>
00830         <a class="code" href="class_mac80211.html#b40">setState</a>(CONTEND);
00831     }
00832     <span class="keywordflow">else</span>
00833     {
00834         <a class="code" href="class_mac80211.html#p14">tryWithoutBackoff</a> = <span class="keyword">false</span>;
00835         <a class="code" href="class_mac80211.html#b40">setState</a>(IDLE);
00836     }
00837 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b27" doxytag="Mac80211::buildACKframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> * Mac80211::buildACKframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
build an ACK 
<p>
Build an ACK frame. Called by <a class="el" href="class_mac80211.html#b20">sendACKframe()</a> <div class="fragment"><pre class="fragment">00723 {
00724     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *frame = <span class="keyword">new</span> <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a>(<span class="stringliteral">"wlan-ack"</span>);
00725     frame-&gt;setKind(ACK);
00726     frame-&gt;setLength(LENGTH_ACK);
00727 
00728     <span class="comment">// the dest address must be the src adress of the RTS or the DATA</span>
00729     <span class="comment">// packet received. The src adress is the adress of the node</span>
00730     frame-&gt;<a class="code" href="class_mac_pkt.html#a12">setSrcAddr</a>(myMacAddr);
00731     frame-&gt;<a class="code" href="class_mac_pkt.html#a9">setDestAddr</a>(af-&gt;<a class="code" href="class_mac_pkt.html#a10">getSrcAddr</a>());
00732     frame-&gt;<a class="code" href="class_mac80211_pkt.html#a12">setDuration</a>(0);
00733 
00734     <span class="keywordflow">return</span> frame;
00735 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b30" doxytag="Mac80211::buildBROADCASTframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> * Mac80211::buildBROADCASTframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
build a broadcast frame 
<p>
Build a BROADCAST frame. Called <a class="el" href="class_mac80211.html#b23">sendBROADCASTframe()</a> <div class="fragment"><pre class="fragment">00779 {
00780     <span class="comment">// send a copy of the frame in front of the queue</span>
00781     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *frame = (<a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *) (<a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front())-&gt;dup();
00782     frame-&gt;setKind(BROADCAST);
00783     <span class="keywordflow">return</span> frame;
00784 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b28" doxytag="Mac80211::buildCTSframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> * Mac80211::buildCTSframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
build a CTS frame 
<p>
Build a CTS frame. Called by <a class="el" href="class_mac80211.html#b21">sendCTSframe()</a> <div class="fragment"><pre class="fragment">00761 {
00762     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *frame = <span class="keyword">new</span> <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a>(<span class="stringliteral">"wlan-cts"</span>);
00763     frame-&gt;setKind(CTS);
00764     frame-&gt;setLength(LENGTH_CTS);
00765 
00766     <span class="comment">// the dest adress must be the src adress of the RTS received. The</span>
00767     <span class="comment">// src adress is the adress of the node</span>
00768     frame-&gt;<a class="code" href="class_mac_pkt.html#a12">setSrcAddr</a>(myMacAddr);
00769     frame-&gt;<a class="code" href="class_mac_pkt.html#a9">setDestAddr</a>(af-&gt;<a class="code" href="class_mac_pkt.html#a10">getSrcAddr</a>());
00770     frame-&gt;<a class="code" href="class_mac80211_pkt.html#a12">setDuration</a>(af-&gt;<a class="code" href="class_mac80211_pkt.html#a11">getDuration</a>() - <a class="code" href="_ieee80211_consts_8h.html#a6">SIFS</a> - <a class="code" href="class_mac80211.html#b36">packetDuration</a>(LENGTH_CTS));
00771 
00772     <span class="keywordflow">return</span> frame;
00773 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b26" doxytag="Mac80211::buildDATAframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> * Mac80211::buildDATAframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
build a data frame 
<p>
Build a DATA frame. Called by <a class="el" href="class_mac80211.html#b19">sendDATAframe()</a> <div class="fragment"><pre class="fragment">00705 {
00706     <span class="comment">// build a copy of the frame in front of the queue</span>
00707     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *frame = (<a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *) (<a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front())-&gt;dup();
00708     frame-&gt;<a class="code" href="class_mac_pkt.html#a12">setSrcAddr</a>(myMacAddr);
00709     frame-&gt;setKind(DATA);
00710     <span class="keywordflow">if</span> (rtsCts)
00711         frame-&gt;setDuration(SIFS + packetDuration(LENGTH_ACK));
00712     else
00713         frame-&gt;setDuration(0);
00714 
00715     return frame;
00716 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b29" doxytag="Mac80211::buildRTSframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> * Mac80211::buildRTSframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
build an RTS frame 
<p>
Build a RTS frame. Called by <a class="el" href="class_mac80211.html#b22">sendRTSframe()</a> <div class="fragment"><pre class="fragment">00742 {
00743     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *frame = <span class="keyword">new</span> <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a>(<span class="stringliteral">"wlan-rts"</span>);
00744     frame-&gt;setKind(RTS);
00745     frame-&gt;setLength(LENGTH_RTS);
00746 
00747     <span class="comment">// the src adress and dest address are copied in the frame in the queue (frame to be sent)</span>
00748     frame-&gt;<a class="code" href="class_mac_pkt.html#a12">setSrcAddr</a>(((<a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *) <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front())-&gt;getSrcAddr());
00749     frame-&gt;<a class="code" href="class_mac_pkt.html#a9">setDestAddr</a>(((<a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *) <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front())-&gt;getDestAddr());
00750     frame-&gt;<a class="code" href="class_mac80211_pkt.html#a12">setDuration</a>(3 * SIFS + <a class="code" href="class_mac80211.html#b36">packetDuration</a>(LENGTH_CTS) +
00751                        <a class="code" href="class_mac80211.html#b36">packetDuration</a>(<a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front()-&gt;length()) +
00752                        <a class="code" href="class_mac80211.html#b36">packetDuration</a>(LENGTH_ACK));
00753 
00754     <span class="keywordflow">return</span> frame;
00755 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b33" doxytag="Mac80211::contentionWindow"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Mac80211::contentionWindow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Compute a new contention window. 
<p>
Compute the contention window with the binary backoff algorithm. Use the variable counter (attempts to transmit packet), the constant values CWmax (contention window maximum) and m (parameter for the initial backoff window, usally m=7). Called by <a class="el" href="class_mac80211.html#b32">backoff()</a> <div class="fragment"><pre class="fragment">00867 {
00868     <span class="comment">// the next packet is an unicast packet</span>
00869     <span class="keywordflow">if</span> (!nextIsBroadcast)
00870     {
00871         <span class="keywordtype">int</span> cw = (<a class="code" href="_ieee80211_consts_8h.html#a10">CW_MIN</a> + 1) * (1 &lt;&lt; (<a class="code" href="class_mac80211.html#p13">retryCounter</a> - 1)) - 1;
00872         <span class="comment">// return the calculated value or CWmax if the maximal value is reached</span>
00873         <span class="keywordflow">if</span> (cw &lt;= CW_MAX)
00874             return cw;
00875         else
00876             return CW_MAX;
00877     }
00878 
00879     <span class="comment">// the next packet is broadcast : the contention window must be maximal</span>
00880     else
00881         return broadcastBackoff;
00882 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b25" doxytag="Mac80211::decapsulateAndSendUp"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::decapsulateAndSendUp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
decapsulate packet and send to higher layer 
<p>
<div class="fragment"><pre class="fragment">00190 {
00191     cMessage *msg = frame-&gt;decapsulate();
00192     <span class="comment">// FIXME TBD set control info</span>
00193     <span class="keyword">delete</span> frame;
00194     <a class="code" href="class_wireless_mac_base.html#z123_1">sendUp</a>(msg);
00195 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b24" doxytag="Mac80211::encapsMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> * Mac80211::encapsMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>netw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
encapsulate packet 
<p>
Encapsulates the received network-layer packet into a <a class="el" href="class_mac_pkt.html">MacPkt</a> and set all needed header fields. <div class="fragment"><pre class="fragment">00171 {
00172     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *pkt = <span class="keyword">new</span> <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a>(netw-&gt;name());
00173     pkt-&gt;setLength(272);        <span class="comment">// headerLength, including final CRC-field</span>
00174 
00175     <span class="comment">// copy dest address from the control info</span>
00176     <a class="code" href="class_ieee802_ctrl.html">Ieee802Ctrl</a> *ctrl = check_and_cast&lt;Ieee802Ctrl *&gt;(netw-&gt;removeControlInfo());
00177     pkt-&gt;<a class="code" href="class_mac_pkt.html#a9">setDestAddr</a>(ctrl-&gt;<a class="code" href="class_ieee802_ctrl.html#a9">getDest</a>());
00178     <span class="keyword">delete</span> ctrl;
00179 
00180     <span class="comment">// set the src address to own mac address (nic module id())</span>
00181     pkt-&gt;<a class="code" href="class_mac_pkt.html#a12">setSrcAddr</a>(myMacAddr);
00182 
00183     <span class="comment">// encapsulate the network packet</span>
00184     pkt-&gt;encapsulate(netw);
00185 
00186     <span class="keywordflow">return</span> pkt;
00187 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b17" doxytag="Mac80211::handleACKframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleACKframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle a frame which is expected to be an ACK.Called by HandleMsgForMe(MAcawFrame* af) <div class="fragment"><pre class="fragment">00445 {
00446     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"handling Ack frame\n"</span>;
00447 
00448     <span class="comment">// cancel time-out event</span>
00449     cancelEvent(timeout);
00450 
00451     <span class="comment">// the transmission is acknowledged : initialize long_retry_counter</span>
00452     <a class="code" href="class_mac80211.html#p13">retryCounter</a> = 1;
00453 
00454     <span class="comment">// removes the acknowledged packet from the queue</span>
00455     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *temp = <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front();
00456     <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.pop_front();
00457     <span class="keyword">delete</span> temp;
00458 
00459     <span class="comment">// if thre's a packet to send and if the channel is free then start a new contention period</span>
00460     <a class="code" href="class_mac80211.html#b31">beginNewCycle</a>();
00461 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b10" doxytag="Mac80211::handleBroadcastMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleBroadcastMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle a broadcast packet. This packet is simply passed to the upper layer. No acknowledgement is needed. Called by handleLowerMsg(Mac80211Pkt *af) <div class="fragment"><pre class="fragment">00484 {
00485     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"handle broadcast\n"</span>;
00486     <span class="keywordflow">if</span> (state == BUSY)
00487         error("logic error: node is currently transmitting, can not receive "
00488               "(does the physical layer do its job correctly?)");
00489 
00490     decapsulateAndSendUp(af);
00491     if (state == CONTEND)
00492         beginNewCycle();
00493 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b18" doxytag="Mac80211::handleCTSframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleCTSframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle a CTS frame. Called by HandleMsgForMe(Mac80211Pkt* af) <div class="fragment"><pre class="fragment">00468 {
00469     <span class="comment">// cancel time-out event</span>
00470     cancelEvent(timeout);
00471 
00472     <span class="comment">// wait a short interframe space</span>
00473     <a class="code" href="class_mac80211.html#p5">endSifs</a>-&gt;setContextPointer(af);
00474     scheduleAt(simTime() + SIFS, endSifs);
00475 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b16" doxytag="Mac80211::handleDATAframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleDATAframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle a frame which expected to be a DATA frame. Called by HandleMsgForMe() <div class="fragment"><pre class="fragment">00424 {
00425     <span class="keywordflow">if</span> (rtsCts)
00426         cancelEvent(timeout);  <span class="comment">// cancel time-out event</span>
00427 
00428     <span class="comment">// make a copy</span>
00429     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *copy = (<a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *) af-&gt;dup();
00430 
00431     <span class="comment">// pass the packet to the upper layer</span>
00432     decapsulateAndSendUp(af);
00433 
00434     <span class="comment">// wait a short interframe space</span>
00435     endSifs-&gt;setContextPointer(copy);
00436     scheduleAt(simTime() + SIFS, endSifs);
00437 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="Mac80211::handleEndContentionTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleEndContentionTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handle end of contention 
<p>
The node has won the contention, and is now allowed to send an RTS/DATA or Broadcast packet. The backoff value is deleted and will be newly computed in the next contention period <div class="fragment"><pre class="fragment">00502 {
00503     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"end contention period\n"</span>;
00504 
00505     <span class="keywordflow">if</span> (state != CONTEND)
00506         error("logic error: expiration of the contention timer outside of CONTEND state, should not happen");
00507 
00508     <span class="comment">// the node has won the channel, the backoff window is deleted and</span>
00509     <span class="comment">// will be new calculated in the next contention period</span>
00510     BW = 0;
00511     <span class="comment">// unicast packet</span>
00512     if (!nextIsBroadcast)
00513     {
00514         <span class="keywordflow">if</span> (rtsCts)
00515         {
00516             <span class="comment">// send a RTS</span>
00517             <a class="code" href="class_mac80211.html#b22">sendRTSframe</a>();
00518             <a class="code" href="class_mac80211.html#b40">setState</a>(WFCTS);
00519         }
00520         <span class="keywordflow">else</span>
00521         {
00522             <a class="code" href="class_mac80211.html#b19">sendDATAframe</a>();
00523             <a class="code" href="class_mac80211.html#b40">setState</a>(WFACK);
00524         }
00525 
00526         <span class="comment">// broadcast packet</span>
00527     }
00528     <span class="keywordflow">else</span>
00529     {
00530         <a class="code" href="class_mac80211.html#b23">sendBROADCASTframe</a>();
00531 
00532         <span class="comment">// removes the packet from the queue without waiting for an acknowledgement</span>
00533         <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *temp = <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front();
00534         <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.pop_front();
00535         <span class="keyword">delete</span>(temp);
00536     }
00537 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b12" doxytag="Mac80211::handleEndSifsTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleEndSifsTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handle end of SIFS 
<p>
Handle the end sifs timer. Then sends a CTS, a DATA, or an ACK frame <div class="fragment"><pre class="fragment">00572 {
00573     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *frame = (<a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *) <a class="code" href="class_mac80211.html#p5">endSifs</a>-&gt;contextPointer();
00574 
00575     <span class="keywordflow">switch</span> (frame-&gt;kind())
00576     {
00577     <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#a24a17">RTS</a>:
00578         <a class="code" href="class_mac80211.html#b21">sendCTSframe</a>(frame);
00579         <span class="keywordflow">break</span>;
00580     <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#a24a18">CTS</a>:
00581         <a class="code" href="class_mac80211.html#b19">sendDATAframe</a>();
00582         <span class="keywordflow">break</span>;
00583     <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#a24a15">DATA</a>:
00584         <a class="code" href="class_mac80211.html#b20">sendACKframe</a>(frame);
00585         <span class="keywordflow">break</span>;
00586     <span class="keywordflow">default</span>:
00587         error(<span class="stringliteral">"logic error: end sifs timer when previously received packet is not RTS/CTS/DATA"</span>);
00588     }
00589 
00590     <span class="comment">// don't need previous frame any more</span>
00591     <span class="keyword">delete</span> frame;
00592 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b11" doxytag="Mac80211::handleEndTransmissionTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleEndTransmissionTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handle the end of a transmission... 
<p>
Handle the end of transmission timer (end of the transmission of an ACK or a broadcast packet). Called by HandleTimer(cMessage* msg) <div class="fragment"><pre class="fragment">00600 {
00601     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"transmission of ACK/BROADCAST is over\n"</span>;
00602     <span class="keywordflow">if</span> (state != BUSY)
00603         error("logic error: expiration of the end transmission timer outside the BUSY state, should not happen");
00604 
00605     <span class="comment">// if there's a packet to send and if the channel is free, then start a new contention period</span>
00606     beginNewCycle();
00607 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b6" doxytag="Mac80211::handleLowerMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleLowerMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages from lower layer. 
<p>
Handle all messages from lower layer. Checks the destination MAC adress of the packet. Then calls one of the three functions : <a class="el" href="class_mac80211.html#b8">handleMsgNotForMe()</a>, <a class="el" href="class_mac80211.html#b10">handleBroadcastMsg()</a>, or <a class="el" href="class_mac80211.html#b9">handleMsgForMe()</a>. Called by <a class="el" href="class_wireless_mac_base.html#b1">handleMessage()</a>. 
<p>
Implements <a class="el" href="class_wireless_mac_base.html#z121_2">WirelessMacBase</a>.<div class="fragment"><pre class="fragment">00204 {
00205     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *af = check_and_cast&lt;Mac80211Pkt *&gt;(msg);
00206 
00207     <span class="comment">// end of the reception</span>
00208     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"frame "</span> &lt;&lt; af &lt;&lt; <span class="stringliteral">" received, kind = "</span> &lt;&lt; <a class="code" href="class_mac80211.html#b39">pktTypeName</a>(af-&gt;kind()) &lt;&lt; <span class="stringliteral">"\n"</span>;
00209 
00210     <span class="keywordflow">switch</span> (af-&gt;kind())
00211     {
00212     <span class="keywordflow">case</span> <a class="code" href="_ieee80211_consts_8h.html#a1">COLLISION</a>: <span class="comment">// packet lost or bit error</span>
00213         <span class="keyword">delete</span> af;
00214         <span class="keywordflow">if</span> (state == CONTEND)
00215             beginNewCycle();
00216         break;
00217 
00218     case BITERROR:
00219         handleMsgNotForMe(af);
00220         break;
00221 
00222     case BROADCAST: <span class="comment">// broadcast packet</span>
00223         handleBroadcastMsg(af);
00224         break;
00225 
00226     default: <span class="comment">// other packet</span>
00227         if (af-&gt;getDestAddr() == myMacAddr)  <span class="comment">// FIXME verify broadcast dest addr works!</span>
00228             handleMsgForMe(af);
00229         else
00230             handleMsgNotForMe(af);
00231     }
00232 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b9" doxytag="Mac80211::handleMsgForMe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleMsgForMe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handle a message that was meant for me 
<p>
Handle a packet for the node. The result of this reception is a function of the type of the received message (RTS,CTS,DATA, or ACK), and of the current state of the MAC (WFDATA, CONTEND, IDLE, WFCTS, or WFACK). Called by <a class="el" href="class_mac80211.html#b6">handleLowerMsg()</a> <div class="fragment"><pre class="fragment">00347 {
00348     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"handle msg for me in state = "</span> &lt;&lt; <a class="code" href="class_mac80211.html#b37">stateName</a>(state) &lt;&lt; <span class="stringliteral">" with type = "</span> &lt;&lt; <a class="code" href="class_mac80211.html#b39">pktTypeName</a>(af-&gt;kind()) &lt;&lt; <span class="stringliteral">"\n"</span>;
00349 
00350     <span class="keywordflow">switch</span> (state)
00351     {
00352     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y14y8">IDLE</a>:     <span class="comment">// waiting for the end of the contention period</span>
00353     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y14y9">CONTEND</a>:  <span class="comment">// or waiting for RTS</span>
00354 
00355         <span class="comment">// RTS or DATA accepted</span>
00356         <span class="keywordflow">if</span> (af-&gt;kind() == <a class="code" href="_consts80211_8h.html#a24a17">RTS</a>)
00357             <a class="code" href="class_mac80211.html#b15">handleRTSframe</a>(af);
00358         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (af-&gt;kind() == <a class="code" href="_consts80211_8h.html#a24a15">DATA</a>)
00359             <a class="code" href="class_mac80211.html#b16">handleDATAframe</a>(af);
00360         <span class="keywordflow">else</span>
00361             <span class="comment">// TODO: what if a late ACK has arrived?</span>
00362             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"in handleMsgForMe() IDLE/CONTEND, strange message, darf das?\n"</span>;
00363         <span class="keywordflow">break</span>;
00364 
00365     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y14y6">WFDATA</a>:  <span class="comment">// waiting for DATA</span>
00366 
00367         <span class="keywordflow">if</span> (af-&gt;kind() == <a class="code" href="_consts80211_8h.html#a24a15">DATA</a>)
00368             <a class="code" href="class_mac80211.html#b16">handleDATAframe</a>(af);
00369         <span class="keywordflow">else</span>
00370             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"in handleMsgForMe() WFDATA, strange message, darf das?\n"</span>;
00371         <span class="keywordflow">break</span>;
00372 
00373     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y14y11">WFACK</a>:  <span class="comment">// waiting for ACK</span>
00374 
00375         <span class="keywordflow">if</span> (af-&gt;kind() == <a class="code" href="_consts80211_8h.html#a24a19">ACK</a>)
00376             <a class="code" href="class_mac80211.html#b17">handleACKframe</a>(af);
00377         <span class="keywordflow">else</span>
00378             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"in handleMsgForMe() WFACK, strange message, darf das?\n"</span>;
00379         <span class="keyword">delete</span> af;
00380         <span class="keywordflow">break</span>;
00381 
00382     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y14y10">WFCTS</a>:  <span class="comment">// The MAC is waiting for CTS</span>
00383 
00384         <span class="keywordflow">if</span> (af-&gt;kind() == <a class="code" href="_consts80211_8h.html#a24a18">CTS</a>)
00385             <a class="code" href="class_mac80211.html#b18">handleCTSframe</a>(af);
00386         <span class="keywordflow">else</span>
00387             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"in handleMsgForMe() WFCTS, strange message, darf das?\n"</span>;
00388         <span class="keywordflow">break</span>;
00389 
00390 
00391     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y14y7">QUIET</a>: <span class="comment">// the node is currently deferring.</span>
00392 
00393         <span class="comment">// cannot handle any packet with its MAC adress</span>
00394         <span class="keyword">delete</span> af;
00395         <span class="keywordflow">break</span>;
00396 
00397     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y14y12">BUSY</a>: <span class="comment">// currently transmitting an ACK or a BROADCAST packet</span>
00398         error(<span class="stringliteral">"logic error: node is currently transmitting, can not receive "</span>
00399               <span class="stringliteral">"(does the physical layer do its job correctly?)"</span>);
00400         <span class="keywordflow">break</span>;
00401 
00402     <span class="keywordflow">default</span>:
00403         error(<span class="stringliteral">"unknown state %d"</span>, state);
00404     }
00405 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b8" doxytag="Mac80211::handleMsgNotForMe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleMsgNotForMe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handle a message that is not for me or errornous 
<p>
Handle all ACKs,RTS, CTS, or DATA not for the node. If RTS/CTS is used the node must stay quiet until the current handshake between the two communicating nodes is over. This is done by scheduling the timer message nav (Network Allocation Vector). Without RTS/CTS a new contention is started. If an error occured the node must defer for EIFS. Called by <a class="el" href="class_mac80211.html#b6">handleLowerMsg()</a> <div class="fragment"><pre class="fragment">00281 {
00282     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"handle msg not for me\n"</span>;
00283 
00284     <span class="comment">// if this packet  can not be correctly read</span>
00285     <span class="keywordflow">if</span> (af-&gt;kind() == <a class="code" href="_ieee80211_consts_8h.html#a0">BITERROR</a>)
00286         af-&gt;<a class="code" href="class_mac80211_pkt.html#a12">setDuration</a>(EIFS);
00287 
00288     <span class="comment">// if the duration of the packet is null, then do nothing (to avoid</span>
00289     <span class="comment">// the unuseful scheduling of a self message)</span>
00290     <span class="keywordflow">if</span> (af-&gt;<a class="code" href="class_mac80211_pkt.html#a11">getDuration</a>() != 0)
00291     {
00292 
00293         <span class="comment">// the node is already deferring</span>
00294         <span class="keywordflow">if</span> (state == QUIET)
00295         {
00296             <span class="comment">// the current value of the NAV is not sufficient</span>
00297             <span class="keywordflow">if</span> (<a class="code" href="class_mac80211.html#p2">nav</a>-&gt;arrivalTime() &lt; simTime() + af-&gt;<a class="code" href="class_mac80211_pkt.html#a11">getDuration</a>())
00298             {
00299                 cancelEvent(nav);
00300                 scheduleAt(simTime() + af-&gt;<a class="code" href="class_mac80211_pkt.html#a11">getDuration</a>(), <a class="code" href="class_mac80211.html#p2">nav</a>);
00301                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"NAV timer started for: "</span> &lt;&lt; af-&gt;<a class="code" href="class_mac80211_pkt.html#a11">getDuration</a>() &lt;&lt; <span class="stringliteral">" State QUIET\n"</span>;
00302             }
00303         }
00304 
00305         <span class="comment">// other states</span>
00306         <span class="keywordflow">else</span>
00307         {
00308             <span class="comment">// if the MAC wait for another frame, it can delete its time out</span>
00309             <span class="comment">// (exchange is aborted)</span>
00310             <span class="keywordflow">if</span> (<a class="code" href="class_mac80211.html#p1">timeout</a>-&gt;isScheduled())
00311                 cancelEvent(timeout);
00312 
00313             <span class="comment">// is state == WFCTS or WFACK, the data transfer has failed ...</span>
00314 
00315             <span class="comment">// the node must defer for the time of the transmission</span>
00316             scheduleAt(simTime() + af-&gt;<a class="code" href="class_mac80211_pkt.html#a11">getDuration</a>(), <a class="code" href="class_mac80211.html#p2">nav</a>);
00317             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"NAV timer started, not QUIET: "</span> &lt;&lt; af-&gt;<a class="code" href="class_mac80211_pkt.html#a11">getDuration</a>() &lt;&lt; endl;
00318             <a class="code" href="class_mac80211.html#b40">setState</a>(QUIET);
00319 
00320         }
00321     }
00322     <span class="keywordflow">if</span> (!rtsCts)
00323     {                           <span class="comment">// todo: Nachgucken: was passiert bei Error ohne rtsCts!</span>
00324         <span class="keywordflow">if</span> (state == CONTEND)
00325         {
00326             <span class="keywordflow">if</span> (af-&gt;kind() == <a class="code" href="_ieee80211_consts_8h.html#a0">BITERROR</a>)
00327             {
00328                 <span class="keywordflow">if</span> (<a class="code" href="class_mac80211.html#p3">contention</a>-&gt;isScheduled())
00329                     cancelEvent(contention);
00330                 scheduleAt(simTime() + <a class="code" href="class_mac80211.html#b32">backoff</a>() + EIFS, contention);
00331             }
00332             <span class="keywordflow">else</span>
00333                 <a class="code" href="class_mac80211.html#b31">beginNewCycle</a>();
00334         }
00335     }
00336     <span class="keyword">delete</span> af;
00337 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b14" doxytag="Mac80211::handleNavTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleNavTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
NAV timer expired, the exchange of messages of other stations is done. 
<p>
Handle the NAV timer (end of a defering period). Called by HandleTimer(cMessage* msg) <div class="fragment"><pre class="fragment">00544 {
00545     <span class="keywordflow">if</span> (state != QUIET)
00546         error("logic error: expiration of the NAV timer outside of the state QUIET, should not happen");
00547 
00548     <span class="comment">// if there's a packet to send and if the channel is free, then start a new contention period</span>
00549     beginNewCycle();
00550 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b15" doxytag="Mac80211::handleRTSframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleRTSframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle aframe wich is expected to be an RTS. Called by HandleMsgForMe() <div class="fragment"><pre class="fragment">00412 {
00413     <span class="comment">// wait a short interframe space</span>
00414     <a class="code" href="class_mac80211.html#p5">endSifs</a>-&gt;setContextPointer(af);
00415     scheduleAt(simTime() + SIFS, endSifs);
00416 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="Mac80211::handleSelfMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleSelfMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle self messages such as timer... 
<p>
handle timers 
<p>
Implements <a class="el" href="class_wireless_mac_base.html#z121_0">WirelessMacBase</a>.<div class="fragment"><pre class="fragment">00238 {
00239     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"processing self message with type = "</span> &lt;&lt; <a class="code" href="class_mac80211.html#b38">timerTypeName</a>(msg-&gt;kind()) &lt;&lt; endl;
00240 
00241     <span class="keywordflow">switch</span> (msg-&gt;kind())
00242     {
00243     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y13y5">END_SIFS</a>:
00244         <a class="code" href="class_mac80211.html#b12">handleEndSifsTimer</a>();   <span class="comment">// noch zu betrachten</span>
00245         <span class="keywordflow">break</span>;
00246 
00247     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y13y4">END_TRANSMISSION</a>:
00248         <a class="code" href="class_mac80211.html#b11">handleEndTransmissionTimer</a>();   <span class="comment">// noch zu betrachten</span>
00249         <span class="keywordflow">break</span>;
00250 
00251     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y13y3">CONTENTION</a>:
00252         <a class="code" href="class_mac80211.html#b7">handleEndContentionTimer</a>();
00253         <span class="keywordflow">break</span>;
00254 
00255         <span class="comment">// the MAC was waiting for a CTS, a DATA, or an ACK packet but the timer has expired.</span>
00256     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y13y1">TIMEOUT</a>:
00257         <a class="code" href="class_mac80211.html#b13">handleTimeoutTimer</a>();   <span class="comment">// noch zu betrachten..</span>
00258         <span class="keywordflow">break</span>;
00259 
00260         <span class="comment">// the MAC was waiting because an other communication had won the channel. This communication is now over</span>
00261     <span class="keywordflow">case</span> <a class="code" href="class_mac80211.html#y13y2">NAV</a>:
00262         <a class="code" href="class_mac80211.html#b14">handleNavTimer</a>();       <span class="comment">// noch zu betrachten...</span>
00263         <span class="keywordflow">break</span>;
00264 
00265     <span class="keywordflow">default</span>:
00266         error(<span class="stringliteral">"unknown timer type"</span>);
00267     }
00268 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b13" doxytag="Mac80211::handleTimeoutTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleTimeoutTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handle time out 
<p>
Handle the time out timer. Called by handleTimer(cMessage* msg) <div class="fragment"><pre class="fragment">00557 {
00558     <span class="comment">// if (state == WFCTS || state == WFACK)testMaxAttempts();</span>
00559 
00560     <span class="comment">// if there's a packet to send and if the channel is free then</span>
00561     <span class="comment">// start a new contention period</span>
00562     <span class="keywordflow">if</span> (state != QUIET)
00563         beginNewCycle();
00564 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="Mac80211::handleUpperMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::handleUpperMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages from upper layer. 
<p>
This implementation does not support fragmentation, so it is tested if the maximum length of the MPDU is exceeded. 
<p>
Implements <a class="el" href="class_wireless_mac_base.html#z121_1">WirelessMacBase</a>.<div class="fragment"><pre class="fragment">00138 {
00139     <span class="keywordflow">if</span> (msg-&gt;byteLength() &gt; 2312)
00140         error(<span class="stringliteral">"packet from higher layer (%s)%s is too long for 802.11b, %d bytes (fragmentation is not supported yet)"</span>,
00141               msg-&gt;className(), msg-&gt;name(), msg-&gt;byteLength());
00142 
00143     <span class="keywordflow">if</span> (maxQueueSize &amp;&amp; <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.size() == <a class="code" href="class_mac80211.html#p10">maxQueueSize</a>)
00144     {
00145         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"packet "</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">" received from higher layer but MAC queue is full, deleting\n"</span>;
00146         <span class="keyword">delete</span> msg;
00147         <span class="keywordflow">return</span>;
00148     }
00149 
00150     <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *mac = <a class="code" href="class_mac80211.html#b24">encapsMsg</a>(msg);
00151     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"packet "</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">" received from higher layer, dest="</span> &lt;&lt; mac-&gt;<a class="code" href="class_mac_pkt.html#a7">getDestAddr</a>() &lt;&lt; <span class="stringliteral">", encapsulated\n"</span>;
00152 
00153     <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.push_back(mac);
00154     <span class="comment">// If the MAC is in the IDLE state, then start a new contention period</span>
00155     <span class="keywordflow">if</span> (state == IDLE &amp;&amp; !<a class="code" href="class_mac80211.html#p5">endSifs</a>-&gt;isScheduled())
00156     {
00157         <a class="code" href="class_mac80211.html#p14">tryWithoutBackoff</a> = <span class="keyword">true</span>;
00158         <a class="code" href="class_mac80211.html#b31">beginNewCycle</a>();
00159     }
00160     <span class="keywordflow">else</span>
00161     {
00162         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"enqueued, will be transmitted later\n"</span>;
00163     }
00164 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="Mac80211::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialization of the module and some variables. 
<p>

<p>
Reimplemented from <a class="el" href="class_wireless_mac_base.html#b0">WirelessMacBase</a>.<div class="fragment"><pre class="fragment">00046 {
00047     <a class="code" href="class_wireless_mac_base.html#b0">WirelessMacBase::initialize</a>(stage);
00048 
00049     <span class="keywordflow">if</span> (stage == 0)
00050     {
00051         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Initializing stage 0\n"</span>;
00052         <a class="code" href="class_mac80211.html#p10">maxQueueSize</a> = par(<span class="stringliteral">"maxQueueSize"</span>);
00053 
00054         <span class="comment">// subscribe for the information of the carrier sense</span>
00055         <a class="code" href="class_wireless_mac_base.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z22_0">subscribe</a>(<span class="keyword">this</span>, NF_RADIOSTATE_CHANGED);
00056 
00057         <span class="comment">// timers</span>
00058         <a class="code" href="class_mac80211.html#p1">timeout</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"timeout"</span>, TIMEOUT);
00059         <a class="code" href="class_mac80211.html#p2">nav</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"NAV"</span>, NAV);
00060         <a class="code" href="class_mac80211.html#p3">contention</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"contention"</span>, CONTENTION);
00061         <a class="code" href="class_mac80211.html#p4">endTransmission</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"transmission"</span>, END_TRANSMISSION);
00062         <a class="code" href="class_mac80211.html#p5">endSifs</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"end SIFS"</span>, END_SIFS);
00063 
00064         <a class="code" href="class_mac80211.html#p7">BW</a> = 0;
00065         <a class="code" href="class_mac80211.html#p8">state</a> = <a class="code" href="class_mac80211.html#y14y8">IDLE</a>;
00066         <a class="code" href="class_mac80211.html#p13">retryCounter</a> = 1;
00067         <a class="code" href="class_mac80211.html#p18">broadcastBackoff</a> = par(<span class="stringliteral">"broadcastBackoff"</span>);
00068         <a class="code" href="class_mac80211.html#p15">rtsCts</a> = par(<span class="stringliteral">"rtsCts"</span>);
00069         <a class="code" href="class_mac80211.html#p17">bitrate</a> = par(<span class="stringliteral">"bitrate"</span>);
00070         <a class="code" href="class_mac80211.html#p16">delta</a> = 1E-9; <span class="comment">//XXX it's rather "epsilon", but this delta business looks a bit dodgy a solution anyway</span>
00071 
00072         <a class="code" href="class_mac80211.html#p9">radioState</a> = <a class="code" href="class_radio_state.html#w4w0">RadioState::IDLE</a>; <span class="comment">// until 1st receiveChangeNotification()</span>
00073 
00074         <a class="code" href="class_mac80211.html#p6">EIFS</a> = <a class="code" href="_ieee80211_consts_8h.html#a6">SIFS</a> + <a class="code" href="_ieee80211_consts_8h.html#a7">DIFS</a> + <a class="code" href="class_mac80211.html#b36">packetDuration</a>(LENGTH_ACK);
00075         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"SIFS: "</span> &lt;&lt; <a class="code" href="_ieee80211_consts_8h.html#a6">SIFS</a> &lt;&lt; <span class="stringliteral">" DIFS: "</span> &lt;&lt; <a class="code" href="_ieee80211_consts_8h.html#a7">DIFS</a> &lt;&lt; <span class="stringliteral">" EIFS: "</span> &lt;&lt; <a class="code" href="class_mac80211.html#p6">EIFS</a> &lt;&lt; endl;
00076 
00077         <span class="comment">// get registered in InterfaceTable</span>
00078         <a class="code" href="class_mac80211.html#b2">registerInterface</a>();
00079 
00080         WATCH(state);
00081         WATCH(radioState);
00082     }
00083 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="Mac80211::numInitStages"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual int Mac80211::numInitStages           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialization of the module and some variables. 
<p>
<div class="fragment"><pre class="fragment">00070 {<span class="keywordflow">return</span> 2;}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b36" doxytag="Mac80211::packetDuration"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Mac80211::packetDuration           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bits</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
computes the duration of a transmission over the physical channel 
<p>
Computes the duration of the transmission of a frame over the physical channel. 'bits' should be the total length of the MAC packet in bits. <div class="fragment"><pre class="fragment">00997 {
00998     <span class="keywordflow">return</span> bits / <a class="code" href="class_mac80211.html#p17">bitrate</a> + <a class="code" href="_ieee80211_consts_8h.html#a12">PHY_HEADER_LENGTH</a> / <a class="code" href="_ieee80211_consts_8h.html#a14">BITRATE_HEADER</a>;
00999 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b39" doxytag="Mac80211::pktTypeName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char * Mac80211::pktTypeName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>type</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Produce a readable name of the given packet type. 
<p>
<div class="fragment"><pre class="fragment">01036 {
01037 <span class="preprocessor">#define CASE(x) case x: s=#x; break</span>
01038 <span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = <span class="stringliteral">"???"</span>;
01039     <span class="keywordflow">switch</span> (type)
01040     {
01041         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(TIMEOUT);
01042         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(DATA);
01043         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(BROADCAST);
01044         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(RTS);
01045         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(CTS);
01046         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(ACK);
01047         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(ACKRTS);
01048         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(BEGIN_RECEPTION);
01049         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(BITERROR);
01050         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(COLLISION);
01051     }
01052     <span class="keywordflow">return</span> s;
01053 <span class="preprocessor">#undef CASE</span>
01054 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="Mac80211::receiveChangeNotification"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::receiveChangeNotification           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>category</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>cPolymorphic *&nbsp;</td>
          <td class="mdname" nowrap> <em>details</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called by the <a class="el" href="class_notification_board.html">NotificationBoard</a> whenever a change occurs we're interested in. 
<p>
Handle change nofitications. In this layer it is usually information about the radio channel, i.e. if it is IDLE etc. 
<p>
Implements <a class="el" href="class_i_notifiable.html#a1">INotifiable</a>.<div class="fragment"><pre class="fragment">00910 {
00911     Enter_Method(<span class="stringliteral">"receiveChangeNotification(%s, %s)"</span>, <a class="code" href="_notifier_consts_8cc.html#a0">notificationCategoryName</a>(category),
00912                  details?details-&gt;info().c_str() : <span class="stringliteral">"n/a"</span>);
00913     <a class="code" href="_notifier_consts_8cc.html#a1">printNotificationBanner</a>(category, details);
00914 
00915     <span class="keywordflow">if</span> (category == NF_RADIOSTATE_CHANGED)
00916     {
00917         <span class="comment">// update the local copy of the radio state</span>
00918         <a class="code" href="class_mac80211.html#p9">radioState</a> = check_and_cast&lt;RadioState *&gt;(details)-&gt;getState();
00919 
00920         <span class="comment">// NOTE: we may be invoked during INIT STAGE 1 too, when SnrEval notifies us</span>
00921         <span class="comment">// about the initial radio state. This function has to work correctly</span>
00922         <span class="comment">// even when called during initialization phase!</span>
00923 
00924         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"** Radio state update in "</span> &lt;&lt; className() &lt;&lt; <span class="stringliteral">": "</span> &lt;&lt; details-&gt;info()
00925            &lt;&lt; <span class="stringliteral">" (at T="</span> &lt;&lt; simtimeToStr(simTime()) &lt;&lt; <span class="stringliteral">")\n"</span>;
00926 
00927         <span class="comment">// beginning of a reception</span>
00928         <span class="keywordflow">if</span> (radioState == RadioState::RECV)
00929         {
00930             <span class="comment">// if there's a contention period</span>
00931             <span class="keywordflow">if</span> (<a class="code" href="class_mac80211.html#p3">contention</a>-&gt;isScheduled())
00932             {
00933                 <span class="comment">// update the backoff window in order to give higher priority in</span>
00934                 <span class="comment">// the next battle</span>
00935                 <span class="keywordflow">if</span> (simTime() - <a class="code" href="class_mac80211.html#p3">contention</a>-&gt;sendingTime() &gt;= <a class="code" href="_ieee80211_consts_8h.html#a7">DIFS</a>)
00936                 {
00937                     <a class="code" href="class_mac80211.html#p7">BW</a> = <a class="code" href="class_mac80211.html#p3">contention</a>-&gt;arrivalTime() - simTime();
00938                     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Backoff window made smaller, new BW: "</span> &lt;&lt; <a class="code" href="class_mac80211.html#p7">BW</a> &lt;&lt; endl;
00939                 }
00940                 cancelEvent(contention);
00941             }
00942 
00943             <span class="comment">// if there's a SIFS period</span>
00944             <span class="keywordflow">if</span> (<a class="code" href="class_mac80211.html#p5">endSifs</a>-&gt;isScheduled())
00945             {
00946                 <span class="comment">// delete the previously received frame</span>
00947                 <span class="keyword">delete</span> (<a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *)<a class="code" href="class_mac80211.html#p5">endSifs</a>-&gt;contextPointer();
00948 
00949                 <span class="comment">// cancel the next transmission</span>
00950                 cancelEvent(endSifs);
00951 
00952                 <span class="comment">// state in now IDLE or CONTEND</span>
00953                 <span class="keywordflow">if</span> (<a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.empty())
00954                     <a class="code" href="class_mac80211.html#b40">setState</a>(IDLE);
00955                 <span class="keywordflow">else</span>
00956                     <a class="code" href="class_mac80211.html#b40">setState</a>(CONTEND);
00957             }
00958         }
00959     }
00960 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="Mac80211::registerInterface"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::registerInterface           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register the interface in <a class="el" href="class_interface_table.html">InterfaceTable</a>. 
<p>
<div class="fragment"><pre class="fragment">00087 {
00088     <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *e = <span class="keyword">new</span> <a class="code" href="class_interface_entry.html">InterfaceEntry</a>();
00089 
00090     <span class="comment">// interface name: NetworkInterface module's name without special characters ([])</span>
00091     <span class="keywordtype">char</span> *interfaceName = <span class="keyword">new</span> <span class="keywordtype">char</span>[strlen(parentModule()-&gt;fullName()) + 1];
00092     <span class="keywordtype">char</span> *d = interfaceName;
00093     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *s = parentModule()-&gt;fullName(); *s; s++)
00094         if (isalnum(*s))
00095             *d++ = *s;
00096     *d = '\0';
00097 
00098     e-&gt;setName(interfaceName);
00099     delete [] interfaceName;
00100 
00101     const <span class="keywordtype">char</span> *addrstr = par("address");
00102     if (!strcmp(addrstr, "auto"))
00103     {
00104         <span class="comment">// assign automatic address</span>
00105         <a class="code" href="class_mac80211.html#p0">myMacAddr</a> = <a class="code" href="class_m_a_c_address.html#e0">MACAddress::generateAutoAddress</a>();
00106 
00107         <span class="comment">// change module parameter from "auto" to concrete address</span>
00108         par(<span class="stringliteral">"address"</span>).setStringValue(<a class="code" href="class_mac80211.html#p0">myMacAddr</a>.<a class="code" href="class_m_a_c_address.html#a14">str</a>().c_str());
00109     }
00110     <span class="keywordflow">else</span>
00111     {
00112         <a class="code" href="class_mac80211.html#p0">myMacAddr</a>.<a class="code" href="class_m_a_c_address.html#a6">setAddress</a>(addrstr);
00113     }
00114     e-&gt;<a class="code" href="class_interface_entry.html#a31">setMACAddress</a>(myMacAddr);
00115 
00116     <span class="comment">// generate interface identifier for IPv6</span>
00117     e-&gt;<a class="code" href="class_interface_entry.html#a32">setInterfaceToken</a>(<a class="code" href="class_mac80211.html#p0">myMacAddr</a>.<a class="code" href="class_m_a_c_address.html#a19">formInterfaceIdentifier</a>());
00118 
00119     <span class="comment">// MTU on 802.11 = ?</span>
00120     e-&gt;<a class="code" href="class_interface_entry.html#a24">setMtu</a>(1500);            <span class="comment">// FIXME</span>
00121 
00122     <span class="comment">// capabilities</span>
00123     e-&gt;<a class="code" href="class_interface_entry.html#a26">setBroadcast</a>(<span class="keyword">true</span>);
00124     e-&gt;<a class="code" href="class_interface_entry.html#a27">setMulticast</a>(<span class="keyword">true</span>);
00125     e-&gt;<a class="code" href="class_interface_entry.html#a28">setPointToPoint</a>(<span class="keyword">false</span>);
00126 
00127     <span class="comment">// add</span>
00128     <a class="code" href="class_interface_table.html">InterfaceTable</a> *ift = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a>().get();
00129     ift-&gt;<a class="code" href="class_interface_table.html#a3">addInterface</a>(e, <span class="keyword">this</span>);
00130 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b20" doxytag="Mac80211::sendACKframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::sendACKframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Acknoledgement 
<p>
Send an ACK frame.Called by HandleEndSifsTimer() <div class="fragment"><pre class="fragment">00637 {
00638     <span class="comment">// the MAC must wait the end of the transmission before beginning an</span>
00639     <span class="comment">// other contention period</span>
00640     scheduleAt(simTime() + <a class="code" href="class_mac80211.html#b36">packetDuration</a>(LENGTH_ACK) + delta, endTransmission);
00641 
00642     <span class="comment">// send ACK frame</span>
00643     <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(<a class="code" href="class_mac80211.html#b27">buildACKframe</a>(af));
00644     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sent ACK frame!\n"</span>;
00645 
00646     <span class="comment">// update state and display</span>
00647     <a class="code" href="class_mac80211.html#b40">setState</a>(BUSY);
00648 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b23" doxytag="Mac80211::sendBROADCASTframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::sendBROADCASTframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send broadcast frame 
<p>
Send a BROADCAST frame.Called by handleContentionTimer() <div class="fragment"><pre class="fragment">00689 {
00690     <span class="comment">// the MAC must wait the end of the transmission before beginning any</span>
00691     <span class="comment">// other contention period</span>
00692     scheduleAt(simTime() + <a class="code" href="class_mac80211.html#b36">packetDuration</a>(<a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front()-&gt;length()), <a class="code" href="class_mac80211.html#p4">endTransmission</a>);
00693     <span class="comment">// send ACK frame</span>
00694     <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(<a class="code" href="class_mac80211.html#b30">buildBROADCASTframe</a>());
00695 
00696     <span class="comment">// update state and display</span>
00697     <a class="code" href="class_mac80211.html#b40">setState</a>(BUSY);
00698 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b21" doxytag="Mac80211::sendCTSframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::sendCTSframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211_pkt.html">Mac80211Pkt</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send CTS frame 
<p>
Send a CTS frame.Called by HandleEndSifsTimer() <div class="fragment"><pre class="fragment">00674 {
00675     <span class="comment">// schedule time-out</span>
00676     scheduleAt(simTime() + <a class="code" href="class_mac80211.html#b35">timeOut</a>(CTS, af-&gt;<a class="code" href="class_mac80211_pkt.html#a11">getDuration</a>()), <a class="code" href="class_mac80211.html#p1">timeout</a>);
00677 
00678     <span class="comment">// send CTS frame</span>
00679     <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(<a class="code" href="class_mac80211.html#b28">buildCTSframe</a>(af));
00680 
00681     <span class="comment">// update state and display</span>
00682     <a class="code" href="class_mac80211.html#b40">setState</a>(WFDATA);
00683 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b19" doxytag="Mac80211::sendDATAframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::sendDATAframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send data frame 
<p>
Send a DATA frame. Called by HandleEndSifsTimer() or <a class="el" href="class_mac80211.html#b7">handleEndContentionTimer()</a> <div class="fragment"><pre class="fragment">00615 {
00616     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending data frame\n"</span>;
00617 
00618     <span class="comment">// schedule time out</span>
00619     scheduleAt(simTime() + <a class="code" href="class_mac80211.html#b35">timeOut</a>(DATA, 0), timeout);
00620 
00621     <span class="keywordflow">if</span> (!rtsCts)
00622         <span class="comment">// retryCounter incremented</span>
00623         retryCounter++;
00624 
00625     <span class="comment">// send DATA frame</span>
00626     sendDown(buildDATAframe());
00627 
00628     <span class="comment">// update state and display</span>
00629     setState(WFACK);
00630 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b22" doxytag="Mac80211::sendRTSframe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::sendRTSframe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send RTS frame 
<p>
Send a RTS frame.Called by handleContentionTimer() <div class="fragment"><pre class="fragment">00655 {
00656     <span class="comment">// schedule time-out</span>
00657     scheduleAt(simTime() + <a class="code" href="class_mac80211.html#b35">timeOut</a>(RTS, 0), timeout);
00658 
00659     <span class="comment">// long_retry_counter incremented</span>
00660     <a class="code" href="class_mac80211.html#p13">retryCounter</a>++;
00661 
00662     <span class="comment">// send RTS frame</span>
00663     <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(<a class="code" href="class_mac80211.html#b29">buildRTSframe</a>());
00664 
00665     <span class="comment">// update state and display</span>
00666     <a class="code" href="class_mac80211.html#b40">setState</a>(WFCTS);
00667 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b40" doxytag="Mac80211::setState"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::setState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211.html#y14">State</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>state</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sets the state, and produces a log message in between. 
<p>
<div class="fragment"><pre class="fragment">01057 {
01058     <span class="keywordflow">if</span> (state==newState)
01059         EV &lt;&lt; "staying in state " &lt;&lt; stateName(state) &lt;&lt; "\n";
01060     else
01061         EV &lt;&lt; "state " &lt;&lt; stateName(state) &lt;&lt; " --&gt; " &lt;&lt; stateName(newState) &lt;&lt; "\n";
01062     state = newState;
01063 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b37" doxytag="Mac80211::stateName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char * Mac80211::stateName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211.html#y14">State</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>state</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Produce a readable name of the given state. 
<p>
<div class="fragment"><pre class="fragment">01002 {
01003 <span class="preprocessor">#define CASE(x) case x: s=#x; break</span>
01004 <span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = <span class="stringliteral">"???"</span>;
01005     <span class="keywordflow">switch</span> (state)
01006     {
01007         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(WFDATA);
01008         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(QUIET);
01009         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(IDLE);
01010         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(CONTEND);
01011         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(WFCTS);
01012         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(WFACK);
01013         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(BUSY);
01014     }
01015     <span class="keywordflow">return</span> s;
01016 <span class="preprocessor">#undef CASE</span>
01017 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b34" doxytag="Mac80211::testMaxAttempts"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Mac80211::testMaxAttempts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Test if maximum number of retries to transmit is exceeded. 
<p>
Test if the maximal retry limit is reached, and delete the frame to send in this case. <div class="fragment"><pre class="fragment">00891 {
00892     <span class="keywordflow">if</span> (retryCounter &gt; RETRY_LIMIT)
00893     {
00894         <span class="comment">// initialize counter</span>
00895         <a class="code" href="class_mac80211.html#p13">retryCounter</a> = 1;
00896         <span class="comment">// reportLost(fromUpperLayer.front());</span>
00897 
00898         <span class="comment">// delete the frame to transmit</span>
00899         <a class="code" href="class_mac80211_pkt.html">Mac80211Pkt</a> *temp = <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front();
00900         <a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.pop_front();
00901         <span class="keyword">delete</span>(temp);
00902     }
00903 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b35" doxytag="Mac80211::timeOut"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Mac80211::timeOut           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="_consts80211_8h.html#a24">_802_11frameType</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>last_frame_duration</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
return a timeOut value for a certain type of frame 
<p>
Return a time-out value for a type of frame. Called by SendRTSframe, sendCTSframe, etc. <div class="fragment"><pre class="fragment">00968 {
00969     <span class="keywordtype">double</span> time_out = 0;
00970     <span class="keywordflow">switch</span> (type)
00971     {
00972     <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#a24a17">RTS</a>:
00973         time_out = <a class="code" href="_ieee80211_consts_8h.html#a6">SIFS</a> + <a class="code" href="class_mac80211.html#b36">packetDuration</a>(LENGTH_RTS) + <a class="code" href="class_mac80211.html#b36">packetDuration</a>(LENGTH_CTS) + <a class="code" href="class_mac80211.html#p16">delta</a>;
00974         <span class="keywordflow">break</span>;
00975     <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#a24a18">CTS</a>:
00976         time_out = last_frame_duration - <a class="code" href="class_mac80211.html#b36">packetDuration</a>(LENGTH_ACK) - 2 * <a class="code" href="_ieee80211_consts_8h.html#a6">SIFS</a> + delta;
00977         <span class="keywordflow">break</span>;
00978     <span class="keywordflow">case</span> <a class="code" href="_consts80211_8h.html#a24a15">DATA</a>:
00979         time_out =
00980             <a class="code" href="_ieee80211_consts_8h.html#a6">SIFS</a> + <a class="code" href="class_mac80211.html#b36">packetDuration</a>(<a class="code" href="class_mac80211.html#p12">fromUpperLayer</a>.front()-&gt;length()) + <a class="code" href="class_mac80211.html#b36">packetDuration</a>(LENGTH_ACK) +
00981             delta + 0.1;
00982         <span class="comment">//XXX: I have added some time here, because propagation delay of AirFrames caused problems</span>
00983         <span class="comment">// the timeout periods should be carefully revised with special care for the deltas?! --Levy</span>
00984         <span class="keywordflow">break</span>;
00985     <span class="keywordflow">default</span>:
00986         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Unused frame type was given when calling timeOut(), this should not happen!\n"</span>;
00987     }
00988     <span class="keywordflow">return</span> time_out;
00989 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b38" doxytag="Mac80211::timerTypeName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char * Mac80211::timerTypeName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>type</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Produce a readable name of the given timer type. 
<p>
<div class="fragment"><pre class="fragment">01020 {
01021 <span class="preprocessor">#define CASE(x) case x: s=#x; break</span>
01022 <span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = <span class="stringliteral">"???"</span>;
01023     <span class="keywordflow">switch</span> (type)
01024     {
01025         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(TIMEOUT);
01026         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(NAV);
01027         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(CONTENTION);
01028         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(END_TRANSMISSION);
01029         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(END_SIFS);
01030     }
01031     <span class="keywordflow">return</span> s;
01032 <span class="preprocessor">#undef CASE</span>
01033 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p17" doxytag="Mac80211::bitrate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_mac80211.html#p17">Mac80211::bitrate</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The bitrate should be set in omnetpp.ini; be sure to use a valid 802.11 bitrate. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p18" doxytag="Mac80211::broadcastBackoff"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_mac80211.html#p18">Mac80211::broadcastBackoff</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Should be set in the omnetpp.ini. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p7" doxytag="Mac80211::BW"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_mac80211.html#p7">Mac80211::BW</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Variable to store the current backoff value. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="Mac80211::contention"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_mac80211.html#p3">Mac80211::contention</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Timer used for contention periods. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p16" doxytag="Mac80211::delta"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_mac80211.html#p16">Mac80211::delta</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Very small value used in timer scheduling in order to avoid multiple changements of state in the same simulation time. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p6" doxytag="Mac80211::EIFS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_mac80211.html#p6">Mac80211::EIFS</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
extended interframe space 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p5" doxytag="Mac80211::endSifs"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_mac80211.html#p5">Mac80211::endSifs</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Timer used to indicate the end of a SIFS. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p4" doxytag="Mac80211::endTransmission"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_mac80211.html#p4">Mac80211::endTransmission</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Timer used to indicate the end of the transmission of an ACK or a BROADCAST packet. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p12" doxytag="Mac80211::fromUpperLayer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211.html#y0">MacPktList</a> <a class="el" href="class_mac80211.html#p12">Mac80211::fromUpperLayer</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Buffering of messages from upper layer. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p10" doxytag="Mac80211::maxQueueSize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_mac80211.html#p10">Mac80211::maxQueueSize</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Maximal number of packets in the queue; should be set in the omnetpp.ini. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="Mac80211::myMacAddr"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_m_a_c_address.html">MACAddress</a> <a class="el" href="class_mac80211.html#p0">Mac80211::myMacAddr</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
mac address 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p2" doxytag="Mac80211::nav"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_mac80211.html#p2">Mac80211::nav</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Timer used for the defer time of a node. Also called NAV : networks allocation vector. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p11" doxytag="Mac80211::nextIsBroadcast"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="class_mac80211.html#p11">Mac80211::nextIsBroadcast</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Boolean used to know if the next packet is a broadcast packet. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p9" doxytag="Mac80211::radioState"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_radio_state.html#w4">RadioState::State</a> <a class="el" href="class_mac80211.html#p9">Mac80211::radioState</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Current state of the radio (kept updated by <a class="el" href="class_mac80211.html#b3">receiveChangeNotification()</a>). 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p13" doxytag="Mac80211::retryCounter"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_mac80211.html#p13">Mac80211::retryCounter</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Number of frame transmission attempt. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p15" doxytag="Mac80211::rtsCts"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="class_mac80211.html#p15">Mac80211::rtsCts</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
true if Rts/Cts is used, false if not; can be set in omnetpp.ini 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p8" doxytag="Mac80211::state"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_mac80211.html#y14">State</a> <a class="el" href="class_mac80211.html#p8">Mac80211::state</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Current state of the MAC. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="Mac80211::timeout"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_mac80211.html#p1">Mac80211::timeout</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p14" doxytag="Mac80211::tryWithoutBackoff"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="class_mac80211.html#p14">Mac80211::tryWithoutBackoff</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
If there's a new packet to send and the channel is free, no backoff is needed. 
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_mac80211_8h.html">Mac80211.h</a><li><a class="el" href="_mac80211_8cc.html">Mac80211.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:26 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
