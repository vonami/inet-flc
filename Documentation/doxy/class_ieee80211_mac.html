<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: Ieee80211Mac Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>Ieee80211Mac Class Reference</h1><code>#include &lt;Ieee80211Mac.h&gt;</code>
<p>
<p>Inheritance diagram for Ieee80211Mac:
<p><center><img src="class_ieee80211_mac.png" usemap="#Ieee80211Mac_map" border="0" alt=""></center>
<map name="Ieee80211Mac_map">
<area href="class_wireless_mac_base.html" alt="WirelessMacBase" shape="rect" coords="0,0,113,24">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="123,0,236,24">
</map>
<a href="class_ieee80211_mac-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
IEEE 802.11b Media Access Control Layer.<p>
Various comments in the code refer to the Wireless LAN Medium Access Control (MAC) and Physical Layer(PHY) Specifications ANSI/IEEE Std 802.11, 1999 Edition (R2003)<p>
For more info, see the NED file.<p>
TODO: support fragmentation TODO: PCF mode TODO: CF period TODO: pass radio power to upper layer TODO: transmission complete notification to upper layer TODO: STA TCF timer syncronization, see Chapter 11 pp 123<p>
Parts of the implementation have been taken over from the Mobility Framework's <a class="el" href="class_mac80211.html">Mac80211</a> module. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Ieee80211Mac state variables</h2></td></tr>
<tr><td colspan="2">Various state information checked and modified according to the state machine. <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_0">State</a> { <br>
&nbsp;&nbsp;<a class="el" href="class_ieee80211_mac.html#z69_0x0">IDLE</a>, 
<a class="el" href="class_ieee80211_mac.html#z69_0x1">DEFER</a>, 
<a class="el" href="class_ieee80211_mac.html#z69_0x2">WAITDIFS</a>, 
<a class="el" href="class_ieee80211_mac.html#z69_0x3">BACKOFF</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="class_ieee80211_mac.html#z69_0x4">WAITACK</a>, 
<a class="el" href="class_ieee80211_mac.html#z69_0x5">WAITBROADCAST</a>, 
<a class="el" href="class_ieee80211_mac.html#z69_0x6">WAITCTS</a>, 
<a class="el" href="class_ieee80211_mac.html#z69_0x7">WAITSIFS</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="class_ieee80211_mac.html#z69_0x8">RECEIVE</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_1">Mode</a> { <a class="el" href="class_ieee80211_mac.html#z69_1x9">DCF</a>, 
<a class="el" href="class_ieee80211_mac.html#z69_1x10">PCF</a>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cFSM&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_2">fsm</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_mac.html#z69_1">Mode</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_3">mode</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_4">sequenceNumber</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_5">lastReceiveFailed</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_6">backoff</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_7">nav</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_8">backoffPeriod</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_9">retryCounter</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_radio_state.html#w4">RadioState::State</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_10">radioState</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_mac.html#y0">Ieee80211DataOrMgmtFrameList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_11">transmissionQueue</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_mac.html#y1">Ieee80211ASFTupleList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_12">asfTuplesList</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_passive_queue.html">IPassiveQueue</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_13">queueModule</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z69_14">pendingRadioConfigMsg</a></td></tr>

<tr><td colspan="2"><br><h2>Configuration parameters</h2></td></tr>
<tr><td colspan="2">These are filled in during the initialization phase and not supposed to change afterwards. <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_m_a_c_address.html">MACAddress</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z67_0">address</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z67_1">bitrate</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z67_2">basicBitrate</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z67_3">maxQueueSize</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z67_4">rtsThreshold</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z67_5">retryLimit</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z67_6">cwMinData</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z67_7">cwMinBroadcast</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z67_8">fragmentationThreshold</a> = 2346</td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Construction functions</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z75_0">Ieee80211Mac</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z75_1">~Ieee80211Mac</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#b0">setBasicBitrate</a> (<a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attaches a <a class="el" href="class_phy_control_info.html">PhyControlInfo</a> to the frame which will cause it to be sent at basicBitrate not bitrate (e.g. 2Mbps instead of 11Mbps). Used with ACK, CTS, RTS.  <a href="#b0"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Initialization functions</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z77_0">numInitStages</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and its variables.  <a href="#z77_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z77_1">initialize</a> (int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and some variables.  <a href="#z77_1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z77_2">registerInterface</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z77_3">initializeQueueModule</a> ()</td></tr>

<tr><td colspan="2"><div class="groupHeader">Message handing functions</div></td></tr>
<tr><td colspan="2"><div class="groupText">Functions called from other classes to notify about state changes and to handle messages. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z79_0">receiveChangeNotification</a> (int category, cPolymorphic *details)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called by the <a class="el" href="class_notification_board.html">NotificationBoard</a> whenever a change occurs we're interested in.  <a href="#z79_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z79_1">handleCommand</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle commands (msg kind+control info) coming from upper layers.  <a href="#z79_1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z79_2">handleSelfMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle timer self messages.  <a href="#z79_2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z79_3">handleUpperMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from upper layer.  <a href="#z79_3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z79_4">handleLowerMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from lower (physical) layer.  <a href="#z79_4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z79_5">handleWithFSM</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle all kinds of messages and notifications with the state machine.  <a href="#z79_5"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Timing functions</div></td></tr>
<tr><td colspan="2"><div class="groupText">Calculate various timings based on transmission rate and physical layer charactersitics. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z81_1">SlotPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z81_2">DIFSPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z81_3">EIFSPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z81_4">PIFSPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z81_5">BackoffPeriod</a> (<a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *msg, int r)</td></tr>

<tr><td colspan="2"><div class="groupHeader">Timer functions</div></td></tr>
<tr><td colspan="2"><div class="groupText">These functions have the side effect of starting the corresponding timers. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_0">scheduleSIFSPeriod</a> (<a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_1">scheduleDIFSPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_2">cancelDIFSPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_3">scheduleDataTimeoutPeriod</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_4">scheduleBroadcastTimeoutPeriod</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_5">cancelTimeoutPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_6">scheduleCTSTimeoutPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_7">scheduleReservePeriod</a> (<a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Schedule network allocation period according to 9.2.5.4.  <a href="#z83_7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_8">invalidateBackoffPeriod</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generates a new backoff period based on the contention window.  <a href="#z83_8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_9">isInvalidBackoffPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_10">generateBackoffPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_11">decreaseBackoffPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_12">scheduleBackoffPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z83_13">cancelBackoffPeriod</a> ()</td></tr>

<tr><td colspan="2"><div class="groupHeader">Frame transmission functions</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z85_0">sendACKFrameOnEndSIFS</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z85_1">sendACKFrame</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z85_2">sendRTSFrame</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frameToSend)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z85_3">sendCTSFrameOnEndSIFS</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z85_4">sendCTSFrame</a> (<a class="el" href="class_ieee80211_r_t_s_frame.html">Ieee80211RTSFrame</a> *rtsFrame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z85_5">sendDataFrameOnEndSIFS</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frameToSend)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z85_6">sendDataFrame</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frameToSend)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z85_7">sendBroadcastFrame</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frameToSend)</td></tr>

<tr><td colspan="2"><div class="groupHeader">Frame builder functions</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z87_0">buildDataFrame</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frameToSend)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_a_c_k_frame.html">Ieee80211ACKFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z87_1">buildACKFrame</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frameToACK)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_r_t_s_frame.html">Ieee80211RTSFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z87_2">buildRTSFrame</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frameToSend)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_c_t_s_frame.html">Ieee80211CTSFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z87_3">buildCTSFrame</a> (<a class="el" href="class_ieee80211_r_t_s_frame.html">Ieee80211RTSFrame</a> *rtsFrame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z87_4">buildBroadcastFrame</a> (<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frameToSend)</td></tr>

<tr><td colspan="2"><div class="groupHeader">Utility functions</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_0">finishCurrentTransmission</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_1">giveUpCurrentTransmission</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_2">retryCurrentTransmission</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_3">sendDownPendingRadioConfigMsg</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send down the change channel message to the physical layer if there is any.  <a href="#z89_3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_4">setMode</a> (<a class="el" href="class_ieee80211_mac.html#z69_1">Mode</a> <a class="el" href="class_ieee80211_mac.html#z69_3">mode</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change the current MAC operation mode.  <a href="#z89_4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_5">currentTransmission</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the current frame being transmitted.  <a href="#z89_5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_6">resetStateVariables</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset backoff, backoffPeriod and retryCounter for IDLE state.  <a href="#z89_6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_7">isMediumStateChange</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by the state machine to identify medium state change events. This message is currently optimized away and not sent through the kernel.  <a href="#z89_7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_8">isMediumFree</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tells if the medium is free according to the physical and virtual carrier sense algorithm.  <a href="#z89_8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_9">isBroadcast</a> (<a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true if message is a broadcast message.  <a href="#z89_9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_10">isForUs</a> (<a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true if message destination address is ours.  <a href="#z89_10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_11">isDataOrMgmtFrame</a> (<a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if the frame is a data or management frame.  <a href="#z89_11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_12">frameReceivedBeforeSIFS</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the last frame received before the SIFS period.  <a href="#z89_12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_13">popTransmissionQueue</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deletes frame at the front of queue.  <a href="#z89_13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_14">frameDuration</a> (<a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Computes the duration (in seconds) of the transmission of a frame over the physical channel. 'bits' should be the total length of the MAC frame in bits, but excluding the physical layer framing (preamble etc.).  <a href="#z89_14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_15">frameDuration</a> (int bits, double <a class="el" href="class_ieee80211_mac.html#z67_1">bitrate</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_16">logState</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Logs all state information.  <a href="#z89_16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z89_17">modeName</a> (int <a class="el" href="class_ieee80211_mac.html#z69_3">mode</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produce a readable name of the given MAC operation mode.  <a href="#z89_17"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Timer messages</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z71_0">endSIFS</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z71_1">endDIFS</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z71_2">endBackoff</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z71_3">endTimeout</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z71_4">endReserve</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z71_5">mediumStateChange</a></td></tr>

<tr><td colspan="2"><div class="groupHeader">Statistics</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_0">numRetry</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_1">numSentWithoutRetry</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_2">numGivenUp</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_3">numCollision</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_4">numSent</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_5">numReceived</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_6">numSentBroadcast</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_7">numReceivedBroadcast</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cOutVector&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_8">stateVector</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cOutVector&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#z73_9">radioStateVector</a></td></tr>

<tr><td colspan="2"><br><h2>Private Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::list&lt; <a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#y0">Ieee80211DataOrMgmtFrameList</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::list&lt; <a class="el" href="struct_ieee80211_mac_1_1_ieee80211_a_s_f_tuple.html">Ieee80211ASFTuple</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mac.html#y1">Ieee80211ASFTupleList</a></td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ieee80211_mac_1_1_ieee80211_a_s_f_tuple.html">Ieee80211ASFTuple</a></td></tr>

</table>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="y1" doxytag="Ieee80211Mac::Ieee80211ASFTupleList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef std::list&lt;<a class="el" href="struct_ieee80211_mac_1_1_ieee80211_a_s_f_tuple.html">Ieee80211ASFTuple</a>*&gt; <a class="el" href="class_ieee80211_mac.html#y1">Ieee80211Mac::Ieee80211ASFTupleList</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="y0" doxytag="Ieee80211Mac::Ieee80211DataOrMgmtFrameList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef std::list&lt;<a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a>*&gt; <a class="el" href="class_ieee80211_mac.html#y0">Ieee80211Mac::Ieee80211DataOrMgmtFrameList</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="z69_1" doxytag="Ieee80211Mac::Mode"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="class_ieee80211_mac.html#z69_1">Ieee80211Mac::Mode</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
80211 MAC operation modes <dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="z69_1x9" doxytag="DCF"></a>DCF</em>&nbsp;</td><td>
Distributed Coordination Function. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="z69_1x10" doxytag="PCF"></a>PCF</em>&nbsp;</td><td>
Point Coordination Function. </td></tr>
</table>
</dl>
<div class="fragment"><pre class="fragment">00129               {
00130         <a class="code" href="class_ieee80211_mac.html#z69_1x9">DCF</a>,  
00131         <a class="code" href="class_ieee80211_mac.html#z69_1x10">PCF</a>,  
00132     };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z69_0" doxytag="Ieee80211Mac::State"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="class_ieee80211_mac.html#z69_0">Ieee80211Mac::State</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
the 80211 MAC state machine <dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="z69_0x0" doxytag="IDLE"></a>IDLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="z69_0x1" doxytag="DEFER"></a>DEFER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="z69_0x2" doxytag="WAITDIFS"></a>WAITDIFS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="z69_0x3" doxytag="BACKOFF"></a>BACKOFF</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="z69_0x4" doxytag="WAITACK"></a>WAITACK</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="z69_0x5" doxytag="WAITBROADCAST"></a>WAITBROADCAST</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="z69_0x6" doxytag="WAITCTS"></a>WAITCTS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="z69_0x7" doxytag="WAITSIFS"></a>WAITSIFS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="z69_0x8" doxytag="RECEIVE"></a>RECEIVE</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>
<div class="fragment"><pre class="fragment">00115                {
00116         <a class="code" href="class_ieee80211_mac.html#z69_0x0">IDLE</a>,
00117         <a class="code" href="class_ieee80211_mac.html#z69_0x1">DEFER</a>,
00118         <a class="code" href="class_ieee80211_mac.html#z69_0x2">WAITDIFS</a>,
00119         <a class="code" href="class_ieee80211_mac.html#z69_0x3">BACKOFF</a>,
00120         <a class="code" href="class_ieee80211_mac.html#z69_0x4">WAITACK</a>,
00121         <a class="code" href="class_ieee80211_mac.html#z69_0x5">WAITBROADCAST</a>,
00122         <a class="code" href="class_ieee80211_mac.html#z69_0x6">WAITCTS</a>,
00123         <a class="code" href="class_ieee80211_mac.html#z69_0x7">WAITSIFS</a>,
00124         <a class="code" href="class_ieee80211_mac.html#z69_0x8">RECEIVE</a>,
00125     };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="z75_0" doxytag="Ieee80211Mac::Ieee80211Mac"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Ieee80211Mac::Ieee80211Mac           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00031 {
00032     <a class="code" href="class_ieee80211_mac.html#z71_0">endSIFS</a> = NULL;
00033     <a class="code" href="class_ieee80211_mac.html#z71_1">endDIFS</a> = NULL;
00034     <a class="code" href="class_ieee80211_mac.html#z71_2">endBackoff</a> = NULL;
00035     <a class="code" href="class_ieee80211_mac.html#z71_3">endTimeout</a> = NULL;
00036     <a class="code" href="class_ieee80211_mac.html#z71_4">endReserve</a> = NULL;
00037     <a class="code" href="class_ieee80211_mac.html#z71_5">mediumStateChange</a> = NULL;
00038     <a class="code" href="class_ieee80211_mac.html#z69_14">pendingRadioConfigMsg</a> = NULL;
00039 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z75_1" doxytag="Ieee80211Mac::~Ieee80211Mac"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Ieee80211Mac::~<a class="el" href="class_ieee80211_mac.html">Ieee80211Mac</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00042 {
00043     cancelAndDelete(endSIFS);
00044     cancelAndDelete(endDIFS);
00045     cancelAndDelete(endBackoff);
00046     cancelAndDelete(endTimeout);
00047     cancelAndDelete(endReserve);
00048     cancelAndDelete(mediumStateChange);
00049 
00050     <span class="keywordflow">if</span> (pendingRadioConfigMsg)
00051         delete pendingRadioConfigMsg;
00052 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="z81_5" doxytag="Ieee80211Mac::BackoffPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t Ieee80211Mac::BackoffPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>r</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00605 {
00606     <span class="keywordtype">int</span> cw;
00607 
00608     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"generating backoff slot number for retry: "</span> &lt;&lt; r &lt;&lt; endl; 
00609 
00610     <span class="keywordflow">if</span> (<a class="code" href="class_ieee80211_mac.html#z89_9">isBroadcast</a>(msg))
00611         cw = cwMinBroadcast;
00612     else
00613     {
00614         ASSERT(0 &lt;= r &amp;&amp; r &lt;= retryLimit);
00615 
00616         cw = (<a class="code" href="class_ieee80211_mac.html#z67_6">cwMinData</a> + 1) * (1 &lt;&lt; r) - 1;
00617 
00618         <span class="keywordflow">if</span> (cw &gt; CW_MAX)
00619             cw = CW_MAX;
00620     }
00621 
00622     <span class="keywordtype">int</span> c = intrand(cw + 1);
00623 
00624     EV &lt;&lt; "generated backoff slot number: " &lt;&lt; c &lt;&lt; " , cw: " &lt;&lt; cw &lt;&lt; endl;
00625 
00626     return ((<span class="keywordtype">double</span>)c) * SlotPeriod();
00627 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z87_1" doxytag="Ieee80211Mac::buildACKFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_a_c_k_frame.html">Ieee80211ACKFrame</a> * Ieee80211Mac::buildACKFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frameToACK</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00827 {
00828     <a class="code" href="class_ieee80211_a_c_k_frame.html">Ieee80211ACKFrame</a> *frame = <span class="keyword">new</span> <a class="code" href="class_ieee80211_a_c_k_frame.html">Ieee80211ACKFrame</a>(<span class="stringliteral">"wlan-ack"</span>);
00829     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a23">setReceiverAddress</a>(frameToACK-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a7">getTransmitterAddress</a>());
00830 
00831     <span class="keywordflow">if</span> (!frameToACK-&gt;<a class="code" href="class_ieee80211_frame.html#a15">getMoreFragments</a>())
00832         frame-&gt;<a class="code" href="class_ieee80211_frame.html#a18">setDuration</a>(0);
00833     <span class="keywordflow">else</span>
00834         frame-&gt;<a class="code" href="class_ieee80211_frame.html#a18">setDuration</a>(frameToACK-&gt;<a class="code" href="class_ieee80211_frame.html#a17">getDuration</a>() - <a class="code" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a>() - <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(LENGTH_ACK, basicBitrate));
00835 
00836     <span class="keywordflow">return</span> frame;
00837 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z87_4" doxytag="Ieee80211Mac::buildBroadcastFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> * Ieee80211Mac::buildBroadcastFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frameToSend</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00861 {
00862     <a class="code" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frame = (<a class="code" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *)frameToSend-&gt;<a class="code" href="class_ieee80211_data_or_mgmt_frame.html#a4">dup</a>();
00863     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a18">setDuration</a>(0);
00864     <span class="keywordflow">return</span> frame;
00865 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z87_3" doxytag="Ieee80211Mac::buildCTSFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_c_t_s_frame.html">Ieee80211CTSFrame</a> * Ieee80211Mac::buildCTSFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_r_t_s_frame.html">Ieee80211RTSFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>rtsFrame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00852 {
00853     <a class="code" href="class_ieee80211_c_t_s_frame.html">Ieee80211CTSFrame</a> *frame = <span class="keyword">new</span> <a class="code" href="class_ieee80211_c_t_s_frame.html">Ieee80211CTSFrame</a>(<span class="stringliteral">"wlan-cts"</span>);
00854     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a23">setReceiverAddress</a>(rtsFrame-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a7">getTransmitterAddress</a>());
00855     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a18">setDuration</a>(rtsFrame-&gt;<a class="code" href="class_ieee80211_frame.html#a17">getDuration</a>() - <a class="code" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a>() - <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(LENGTH_CTS, basicBitrate));
00856 
00857     <span class="keywordflow">return</span> frame;
00858 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z87_0" doxytag="Ieee80211Mac::buildDataFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> * Ieee80211Mac::buildDataFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frameToSend</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00812 {
00813     <a class="code" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frame = (<a class="code" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *)frameToSend-&gt;<a class="code" href="class_ieee80211_data_or_mgmt_frame.html#a4">dup</a>();
00814 
00815     <span class="keywordflow">if</span> (<a class="code" href="class_ieee80211_mac.html#z89_9">isBroadcast</a>(frameToSend))
00816         frame-&gt;setDuration(0);
00817     else if (!frameToSend-&gt;getMoreFragments())
00818         frame-&gt;setDuration(SIFSPeriod() + frameDuration(LENGTH_ACK, basicBitrate));
00819     else
00820         <span class="comment">// FIXME: shouldn't we use the next frame to be sent?</span>
00821         frame-&gt;setDuration(3 * SIFSPeriod() + 2 * frameDuration(LENGTH_ACK, basicBitrate) + frameDuration(frameToSend));
00822 
00823     return frame;
00824 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z87_2" doxytag="Ieee80211Mac::buildRTSFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_r_t_s_frame.html">Ieee80211RTSFrame</a> * Ieee80211Mac::buildRTSFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frameToSend</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00840 {
00841     <a class="code" href="class_ieee80211_r_t_s_frame.html">Ieee80211RTSFrame</a> *frame = <span class="keyword">new</span> <a class="code" href="class_ieee80211_r_t_s_frame.html">Ieee80211RTSFrame</a>(<span class="stringliteral">"wlan-rts"</span>);
00842     frame-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a9">setTransmitterAddress</a>(address);
00843     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a23">setReceiverAddress</a>(frameToSend-&gt;<a class="code" href="class_ieee80211_frame.html#a21">getReceiverAddress</a>());
00844     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a18">setDuration</a>(3 * <a class="code" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a>() + <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(LENGTH_CTS, basicBitrate) +
00845                        <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(frameToSend) +
00846                        <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(LENGTH_ACK, basicBitrate));
00847 
00848     <span class="keywordflow">return</span> frame;
00849 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_13" doxytag="Ieee80211Mac::cancelBackoffPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::cancelBackoffPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00746 {
00747     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"cancelling Backoff period\n"</span>;
00748     cancelEvent(endBackoff);
00749 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_2" doxytag="Ieee80211Mac::cancelDIFSPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::cancelDIFSPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00654 {
00655     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"cancelling DIFS period\n"</span>;
00656     cancelEvent(endDIFS);
00657 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_5" doxytag="Ieee80211Mac::cancelTimeoutPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::cancelTimeoutPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00672 {
00673     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"cancelling timeout period\n"</span>;
00674     cancelEvent(endTimeout);
00675 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_5" doxytag="Ieee80211Mac::currentTransmission"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> * Ieee80211Mac::currentTransmission           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the current frame being transmitted. 
<p>
<div class="fragment"><pre class="fragment">00903 {
00904     <span class="keywordflow">return</span> (<a class="code" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *)transmissionQueue.front();
00905 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_11" doxytag="Ieee80211Mac::decreaseBackoffPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::decreaseBackoffPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00731 {
00732     <span class="comment">// see spec 9.2.5.2</span>
00733     simtime_t elapsedBackoffTime = simTime() - <a class="code" href="class_ieee80211_mac.html#z71_2">endBackoff</a>-&gt;sendingTime();
00734     <a class="code" href="class_ieee80211_mac.html#z69_8">backoffPeriod</a> -= ((int)(elapsedBackoffTime / <a class="code" href="class_ieee80211_mac.html#z81_1">SlotPeriod</a>())) * <a class="code" href="class_ieee80211_mac.html#z81_1">SlotPeriod</a>();
00735     ASSERT(backoffPeriod &gt;= 0);
00736     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"backoff period decreased to "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z69_8">backoffPeriod</a> &lt;&lt; endl;
00737 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z81_2" doxytag="Ieee80211Mac::DIFSPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t Ieee80211Mac::DIFSPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00594 {
00595     <span class="keywordflow">return</span> <a class="code" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a>() + 2 * <a class="code" href="class_ieee80211_mac.html#z81_1">SlotPeriod</a>();
00596 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z81_3" doxytag="Ieee80211Mac::EIFSPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t Ieee80211Mac::EIFSPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00599 {
00600 <span class="comment">// FIXME:   return SIFSPeriod() + DIFSPeriod() + (8 * ACKSize + aPreambleLength + aPLCPHeaderLength) / lowestDatarate;</span>
00601     <span class="keywordflow">return</span> <a class="code" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a>() + <a class="code" href="class_ieee80211_mac.html#z81_2">DIFSPeriod</a>() + (8 * <a class="code" href="_ieee80211_consts_8h.html#a4">LENGTH_ACK</a> + <a class="code" href="_ieee80211_consts_8h.html#a12">PHY_HEADER_LENGTH</a>) / 1E+6;
00602 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_0" doxytag="Ieee80211Mac::finishCurrentTransmission"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::finishCurrentTransmission           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00880 {
00881     <a class="code" href="class_ieee80211_mac.html#z89_13">popTransmissionQueue</a>();
00882     <a class="code" href="class_ieee80211_mac.html#z89_6">resetStateVariables</a>();
00883 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_15" doxytag="Ieee80211Mac::frameDuration"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Ieee80211Mac::frameDuration           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>bits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>bitrate</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00989 {
00990     <span class="keywordflow">return</span> bits / bitrate + <a class="code" href="_ieee80211_consts_8h.html#a12">PHY_HEADER_LENGTH</a> / <a class="code" href="_ieee80211_consts_8h.html#a14">BITRATE_HEADER</a>;
00991 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_14" doxytag="Ieee80211Mac::frameDuration"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Ieee80211Mac::frameDuration           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Computes the duration (in seconds) of the transmission of a frame over the physical channel. 'bits' should be the total length of the MAC frame in bits, but excluding the physical layer framing (preamble etc.). 
<p>
<div class="fragment"><pre class="fragment">00984 {
00985     <span class="keywordflow">return</span> <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(msg-&gt;length(), <a class="code" href="class_ieee80211_mac.html#z67_1">bitrate</a>);
00986 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_12" doxytag="Ieee80211Mac::frameReceivedBeforeSIFS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> * Ieee80211Mac::frameReceivedBeforeSIFS           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the last frame received before the SIFS period. 
<p>
<div class="fragment"><pre class="fragment">00964 {
00965     <span class="keywordflow">return</span> (<a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *)endSIFS-&gt;contextPointer();
00966 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_10" doxytag="Ieee80211Mac::generateBackoffPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::generateBackoffPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00724 {
00725     <a class="code" href="class_ieee80211_mac.html#z69_8">backoffPeriod</a> = <a class="code" href="class_ieee80211_mac.html#z81_5">BackoffPeriod</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>(), retryCounter);
00726     ASSERT(backoffPeriod &gt;= 0);
00727     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"backoff period set to "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z69_8">backoffPeriod</a> &lt;&lt; endl;
00728 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_1" doxytag="Ieee80211Mac::giveUpCurrentTransmission"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::giveUpCurrentTransmission           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00886 {
00887     <a class="code" href="class_ieee80211_mac.html#z89_13">popTransmissionQueue</a>();
00888     <a class="code" href="class_ieee80211_mac.html#z89_6">resetStateVariables</a>();
00889     <a class="code" href="class_ieee80211_mac.html#z73_2">numGivenUp</a>++;
00890 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z79_1" doxytag="Ieee80211Mac::handleCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::handleCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle commands (msg kind+control info) coming from upper layers. 
<p>
<div class="fragment"><pre class="fragment">00250 {
00251     <span class="keywordflow">if</span> (msg-&gt;kind()==<a class="code" href="_phy_control_info__m_8h.html#a4a1">PHY_C_CONFIGURERADIO</a>)
00252     {
00253         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Passing on command "</span> &lt;&lt; msg-&gt;name() &lt;&lt; <span class="stringliteral">" to physical layer\n"</span>;
00254         <span class="keywordflow">if</span> (pendingRadioConfigMsg != NULL)
00255         {
00256             <span class="comment">// merge contents of the old command into the new one, then delete it</span>
00257             <a class="code" href="class_phy_control_info.html">PhyControlInfo</a> *pOld = check_and_cast&lt;PhyControlInfo *&gt;(<a class="code" href="class_ieee80211_mac.html#z69_14">pendingRadioConfigMsg</a>-&gt;controlInfo());
00258             <a class="code" href="class_phy_control_info.html">PhyControlInfo</a> *pNew = check_and_cast&lt;PhyControlInfo *&gt;(msg-&gt;controlInfo());
00259             <span class="keywordflow">if</span> (pNew-&gt;<a class="code" href="class_phy_control_info.html#a6">channelNumber</a>()==-1 &amp;&amp; pOld-&gt;<a class="code" href="class_phy_control_info.html#a6">channelNumber</a>()!=-1)
00260                 pNew-&gt;<a class="code" href="class_phy_control_info.html#a7">setChannelNumber</a>(pOld-&gt;<a class="code" href="class_phy_control_info.html#a6">channelNumber</a>());
00261             <span class="keywordflow">if</span> (pNew-&gt;<a class="code" href="class_phy_control_info.html#a8">bitrate</a>()==-1 &amp;&amp; pOld-&gt;<a class="code" href="class_phy_control_info.html#a8">bitrate</a>()!=-1)
00262                 pNew-&gt;<a class="code" href="class_phy_control_info.html#a9">setBitrate</a>(pOld-&gt;<a class="code" href="class_phy_control_info.html#a8">bitrate</a>());
00263             <span class="keyword">delete</span> <a class="code" href="class_ieee80211_mac.html#z69_14">pendingRadioConfigMsg</a>;
00264             <a class="code" href="class_ieee80211_mac.html#z69_14">pendingRadioConfigMsg</a> = NULL;
00265         }
00266 
00267         <span class="keywordflow">if</span> (<a class="code" href="class_ieee80211_mac.html#z69_2">fsm</a>.state() == <a class="code" href="class_ieee80211_mac.html#z69_0x0">IDLE</a> || <a class="code" href="class_ieee80211_mac.html#z69_2">fsm</a>.state() == <a class="code" href="class_ieee80211_mac.html#z69_0x1">DEFER</a> || <a class="code" href="class_ieee80211_mac.html#z69_2">fsm</a>.state() == <a class="code" href="class_ieee80211_mac.html#z69_0x3">BACKOFF</a>)
00268         {
00269             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Sending it down immediately\n"</span>;
00270             <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(msg);
00271         }
00272         <span class="keywordflow">else</span>
00273         {
00274             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Delaying "</span> &lt;&lt; msg-&gt;name() &lt;&lt; <span class="stringliteral">" until next IDLE or DEFER state\n"</span>;
00275             <a class="code" href="class_ieee80211_mac.html#z69_14">pendingRadioConfigMsg</a> = msg;
00276         }
00277     }
00278     <span class="keywordflow">else</span>
00279     {
00280         error(<span class="stringliteral">"Unrecognized command from mgmt layer: (%s)%s msgkind=%d"</span>, msg-&gt;className(), msg-&gt;name(), msg-&gt;kind());
00281     }
00282 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z79_4" doxytag="Ieee80211Mac::handleLowerMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::handleLowerMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages from lower (physical) layer. 
<p>

<p>
Implements <a class="el" href="class_wireless_mac_base.html#z121_2">WirelessMacBase</a>.<div class="fragment"><pre class="fragment">00285 {
00286     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"received message from lower layer: "</span> &lt;&lt; msg &lt;&lt; endl;
00287 
00288     <a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *frame = dynamic_cast&lt;Ieee80211Frame *&gt;(msg);
00289     <span class="keywordflow">if</span> (!frame)
00290         error("message from physical layer (%s)%s is not a subclass of <a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a>",
00291               msg-&gt;className(), msg-&gt;name());
00292 
00293     EV &lt;&lt; "Self address: " &lt;&lt; address
00294        &lt;&lt; ", receiver address: " &lt;&lt; frame-&gt;getReceiverAddress()
00295        &lt;&lt; ", received frame is for us: " &lt;&lt; isForUs(frame) &lt;&lt; endl;
00296 
00297     <a class="code" href="class_ieee80211_two_address_frame.html">Ieee80211TwoAddressFrame</a> *twoAddressFrame = dynamic_cast&lt;<a class="code" href="class_ieee80211_two_address_frame.html">Ieee80211TwoAddressFrame</a> *&gt;(msg);
00298     ASSERT(!twoAddressFrame || twoAddressFrame-&gt;getTransmitterAddress() != address);
00299 
00300     handleWithFSM(msg);
00301 
00302     <span class="comment">// if we are the owner then we did not send this message up</span>
00303     if (msg-&gt;owner() == this)
00304         delete msg;
00305 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z79_2" doxytag="Ieee80211Mac::handleSelfMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::handleSelfMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle timer self messages. 
<p>

<p>
Implements <a class="el" href="class_wireless_mac_base.html#z121_0">WirelessMacBase</a>.<div class="fragment"><pre class="fragment">00204 {
00205     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"received self message: "</span> &lt;&lt; msg &lt;&lt; endl;
00206 
00207     <span class="keywordflow">if</span> (msg == endReserve)
00208         nav = false;
00209 
00210     handleWithFSM(msg);
00211 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z79_3" doxytag="Ieee80211Mac::handleUpperMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::handleUpperMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages from upper layer. 
<p>

<p>
Implements <a class="el" href="class_wireless_mac_base.html#z121_1">WirelessMacBase</a>.<div class="fragment"><pre class="fragment">00214 {
00215     <span class="comment">// check if it's a command from the mgmt layer</span>
00216     <span class="keywordflow">if</span> (msg-&gt;length()==0 &amp;&amp; msg-&gt;kind()!=0)
00217     {
00218         <a class="code" href="class_ieee80211_mac.html#z79_1">handleCommand</a>(msg);
00219         <span class="keywordflow">return</span>;
00220     }
00221 
00222     <span class="comment">// check for queue overflow</span>
00223     <span class="keywordflow">if</span> (maxQueueSize &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z69_11">transmissionQueue</a>.size() == <a class="code" href="class_ieee80211_mac.html#z67_3">maxQueueSize</a>)
00224     {
00225         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"message "</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">" received from higher layer but MAC queue is full, dropping message\n"</span>;
00226         <span class="keyword">delete</span> msg;
00227         <span class="keywordflow">return</span>;
00228     }
00229 
00230     <span class="comment">// must be a Ieee80211DataOrMgmtFrame, within the max size because we don't support fragmentation</span>
00231     <a class="code" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *frame = check_and_cast&lt;Ieee80211DataOrMgmtFrame *&gt;(msg);
00232     <span class="keywordflow">if</span> (frame-&gt;byteLength() &gt; <a class="code" href="class_ieee80211_mac.html#z67_8">fragmentationThreshold</a>)
00233         error(<span class="stringliteral">"message from higher layer (%s)%s is too long for 802.11b, %d bytes (fragmentation is not supported yet)"</span>,
00234               msg-&gt;className(), msg-&gt;name(), msg-&gt;byteLength());
00235     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"frame "</span> &lt;&lt; frame &lt;&lt; <span class="stringliteral">" received from higher layer, receiver = "</span> &lt;&lt; frame-&gt;<a class="code" href="class_ieee80211_frame.html#a21">getReceiverAddress</a>() &lt;&lt; endl;
00236 
00237     ASSERT(!frame-&gt;<a class="code" href="class_ieee80211_frame.html#a21">getReceiverAddress</a>().<a class="code" href="class_m_a_c_address.html#a13">isUnspecified</a>());
00238 
00239     <span class="comment">// fill in missing fields (receiver address, seq number), and insert into the queue</span>
00240     frame-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a9">setTransmitterAddress</a>(address);
00241     frame-&gt;<a class="code" href="class_ieee80211_data_or_mgmt_frame.html#a13">setSequenceNumber</a>(sequenceNumber);
00242     <a class="code" href="class_ieee80211_mac.html#z69_4">sequenceNumber</a> = (<a class="code" href="class_ieee80211_mac.html#z69_4">sequenceNumber</a>+1) % 4096;  <span class="comment">//XXX seqNum must be checked upon reception of frames!</span>
00243 
00244     <a class="code" href="class_ieee80211_mac.html#z69_11">transmissionQueue</a>.push_back(frame);
00245 
00246     <a class="code" href="class_ieee80211_mac.html#z79_5">handleWithFSM</a>(frame);
00247 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z79_5" doxytag="Ieee80211Mac::handleWithFSM"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::handleWithFSM           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle all kinds of messages and notifications with the state machine. 
<p>
Msg can be upper, lower, self or NULL (when radio state changes) <div class="fragment"><pre class="fragment">00330 {
00331     <span class="comment">// skip those cases where there's nothing to do, so the switch looks simpler</span>
00332     <span class="keywordflow">if</span> (<a class="code" href="class_wireless_mac_base.html#z121_3">isUpperMsg</a>(msg) &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z69_2">fsm</a>.state() != <a class="code" href="class_ieee80211_mac.html#z69_0x0">IDLE</a>)
00333     {
00334         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"deferring upper message transmission in "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z69_2">fsm</a>.stateName() &lt;&lt; <span class="stringliteral">" state\n"</span>;
00335         <span class="keywordflow">return</span>;
00336     }
00337 
00338     <a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *frame = dynamic_cast&lt;Ieee80211Frame*&gt;(msg);
00339     <span class="keywordtype">int</span> frameType = frame ? frame-&gt;<a class="code" href="class_ieee80211_frame.html#a7">getType</a>() : -1;
00340     <span class="keywordtype">int</span> msgKind = msg-&gt;kind();
00341     <a class="code" href="class_ieee80211_mac.html#z89_16">logState</a>();
00342     <a class="code" href="class_ieee80211_mac.html#z73_8">stateVector</a>.record(<a class="code" href="class_ieee80211_mac.html#z69_2">fsm</a>.state());
00343 
00344     <span class="keywordflow">if</span> (frame &amp;&amp; <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(frame))
00345     {
00346         <a class="code" href="class_ieee80211_mac.html#z69_5">lastReceiveFailed</a> =(msgKind == <a class="code" href="_ieee80211_consts_8h.html#a1">COLLISION</a> || msgKind == <a class="code" href="_ieee80211_consts_8h.html#a0">BITERROR</a>);
00347         <a class="code" href="class_ieee80211_mac.html#z83_7">scheduleReservePeriod</a>(frame);
00348     }
00349 
00350     <a class="code" href="_f_s_m_a_8h.html#a0">FSMA_Switch</a>(fsm)
00351     {
00352         <a class="code" href="_f_s_m_a_8h.html#a2">FSMA_State</a>(IDLE)
00353         {
00354             <a class="code" href="_f_s_m_a_8h.html#a6">FSMA_Enter</a>(<a class="code" href="class_ieee80211_mac.html#z89_3">sendDownPendingRadioConfigMsg</a>());
00355             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Data-Ready,
00356                                   <a class="code" href="class_wireless_mac_base.html#z121_3">isUpperMsg</a>(msg),
00357                                   DEFER,
00358                 <a class="code" href="class_ieee80211_mac.html#z83_8">invalidateBackoffPeriod</a>();
00359             );
00360             <a class="code" href="_f_s_m_a_8h.html#a4">FSMA_No_Event_Transition</a>(Immediate-Data-Ready,
00361                                      !<a class="code" href="class_ieee80211_mac.html#z69_11">transmissionQueue</a>.empty(),
00362                                      <a class="code" href="class_ieee80211_mac.html#z69_0x1">DEFER</a>,
00363                 <a class="code" href="class_ieee80211_mac.html#z83_8">invalidateBackoffPeriod</a>();
00364             );
00365             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Receive,
00366                                   <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg),
00367                                   RECEIVE,
00368             );
00369         }
00370         <a class="code" href="_f_s_m_a_8h.html#a2">FSMA_State</a>(DEFER)
00371         {
00372             <a class="code" href="_f_s_m_a_8h.html#a6">FSMA_Enter</a>(<a class="code" href="class_ieee80211_mac.html#z89_3">sendDownPendingRadioConfigMsg</a>());
00373             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Wait-DIFS,
00374                                   <a class="code" href="class_ieee80211_mac.html#z89_7">isMediumStateChange</a>(msg) &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_8">isMediumFree</a>(),
00375                                   WAITDIFS,
00376             ;);
00377             <a class="code" href="_f_s_m_a_8h.html#a4">FSMA_No_Event_Transition</a>(Immediate-Wait-DIFS,
00378                                      <a class="code" href="class_ieee80211_mac.html#z89_8">isMediumFree</a>() || !backoff,
00379                                      WAITDIFS,
00380             ;);
00381             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Receive,
00382                                   <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg),
00383                                   RECEIVE,
00384             ;);
00385         }
00386         <a class="code" href="_f_s_m_a_8h.html#a2">FSMA_State</a>(WAITDIFS)
00387         {
00388             <a class="code" href="_f_s_m_a_8h.html#a6">FSMA_Enter</a>(<a class="code" href="class_ieee80211_mac.html#z83_1">scheduleDIFSPeriod</a>());
00389             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Immediate-Transmit-RTS,
00390                                   msg == endDIFS &amp;&amp; !<a class="code" href="class_ieee80211_mac.html#z89_9">isBroadcast</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>())
00391                                   &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()-&gt;byteLength() &gt;= rtsThreshold &amp;&amp; !backoff,
00392                                   WAITCTS,
00393                 <a class="code" href="class_ieee80211_mac.html#z85_2">sendRTSFrame</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>());
00394                 <a class="code" href="class_ieee80211_mac.html#z83_2">cancelDIFSPeriod</a>();
00395             );
00396             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Immediate-Transmit-Broadcast,
00397                                   msg == endDIFS &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_9">isBroadcast</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()) &amp;&amp; !backoff,
00398                                   WAITBROADCAST,
00399                 <a class="code" href="class_ieee80211_mac.html#z85_7">sendBroadcastFrame</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>());
00400                 <a class="code" href="class_ieee80211_mac.html#z83_2">cancelDIFSPeriod</a>();
00401             );
00402             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Immediate-Transmit-Data,
00403                                   msg == endDIFS &amp;&amp; !<a class="code" href="class_ieee80211_mac.html#z89_9">isBroadcast</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()) &amp;&amp; !backoff,
00404                                   WAITACK,
00405                 <a class="code" href="class_ieee80211_mac.html#z85_6">sendDataFrame</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>());
00406                 <a class="code" href="class_ieee80211_mac.html#z83_2">cancelDIFSPeriod</a>();
00407             );
00408             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(DIFS-Over,
00409                                   msg == endDIFS,
00410                                   BACKOFF,
00411                 ASSERT(backoff);
00412                 <span class="keywordflow">if</span> (<a class="code" href="class_ieee80211_mac.html#z83_9">isInvalidBackoffPeriod</a>())
00413                     <a class="code" href="class_ieee80211_mac.html#z83_10">generateBackoffPeriod</a>();
00414             );
00415             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Busy,
00416                                   <a class="code" href="class_ieee80211_mac.html#z89_7">isMediumStateChange</a>(msg) &amp;&amp; !<a class="code" href="class_ieee80211_mac.html#z89_8">isMediumFree</a>(),
00417                                   DEFER,
00418                 backoff = <span class="keyword">true</span>;
00419                 <a class="code" href="class_ieee80211_mac.html#z83_2">cancelDIFSPeriod</a>();
00420             );
00421             <a class="code" href="_f_s_m_a_8h.html#a4">FSMA_No_Event_Transition</a>(Immediate-Busy,
00422                                      !<a class="code" href="class_ieee80211_mac.html#z89_8">isMediumFree</a>(),
00423                                      DEFER,
00424                 backoff = <span class="keyword">true</span>;
00425                 <a class="code" href="class_ieee80211_mac.html#z83_2">cancelDIFSPeriod</a>();
00426             );
00427             <span class="comment">// radio state changes before we actually get the message, so this must be here</span>
00428             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Receive,
00429                                   <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg),
00430                                   RECEIVE,
00431                 <a class="code" href="class_ieee80211_mac.html#z83_2">cancelDIFSPeriod</a>();
00432             ;);
00433         }
00434         <a class="code" href="_f_s_m_a_8h.html#a2">FSMA_State</a>(BACKOFF)
00435         {
00436             <a class="code" href="_f_s_m_a_8h.html#a6">FSMA_Enter</a>(<a class="code" href="class_ieee80211_mac.html#z83_12">scheduleBackoffPeriod</a>());
00437             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Transmit-RTS,
00438                                   msg == endBackoff &amp;&amp; !<a class="code" href="class_ieee80211_mac.html#z89_9">isBroadcast</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>())
00439                                   &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()-&gt;byteLength() &gt;= rtsThreshold,
00440                                   WAITCTS,
00441                 <a class="code" href="class_ieee80211_mac.html#z85_2">sendRTSFrame</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>());
00442             );
00443             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Transmit-Broadcast,
00444                                   msg == endBackoff &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_9">isBroadcast</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()),
00445                                   WAITBROADCAST,
00446                 <a class="code" href="class_ieee80211_mac.html#z85_7">sendBroadcastFrame</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>());
00447             );
00448             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Transmit-Data,
00449                                   msg == endBackoff &amp;&amp; !<a class="code" href="class_ieee80211_mac.html#z89_9">isBroadcast</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()),
00450                                   WAITACK,
00451                 <a class="code" href="class_ieee80211_mac.html#z85_6">sendDataFrame</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>());
00452             );
00453             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Backoff-Busy,
00454                                   <a class="code" href="class_ieee80211_mac.html#z89_7">isMediumStateChange</a>(msg) &amp;&amp; !<a class="code" href="class_ieee80211_mac.html#z89_8">isMediumFree</a>(),
00455                                   DEFER,
00456                 <a class="code" href="class_ieee80211_mac.html#z83_13">cancelBackoffPeriod</a>();
00457                 <a class="code" href="class_ieee80211_mac.html#z83_11">decreaseBackoffPeriod</a>();
00458             );
00459         }
00460         <a class="code" href="_f_s_m_a_8h.html#a2">FSMA_State</a>(WAITACK)
00461         {
00462             <a class="code" href="_f_s_m_a_8h.html#a6">FSMA_Enter</a>(<a class="code" href="class_ieee80211_mac.html#z83_3">scheduleDataTimeoutPeriod</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()));
00463             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Receive-ACK,
00464                                   <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg) &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_10">isForUs</a>(frame) &amp;&amp; frameType == ST_ACK,
00465                                   IDLE,
00466                 <a class="code" href="class_ieee80211_mac.html#z83_5">cancelTimeoutPeriod</a>();
00467                 <a class="code" href="class_ieee80211_mac.html#z89_0">finishCurrentTransmission</a>();
00468                 <span class="keywordflow">if</span> (retryCounter == 0) numSentWithoutRetry++;
00469                 numSent++;
00470             );
00471             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Transmit-Data-Failed,
00472                                   msg == endTimeout &amp;&amp; retryCounter == retryLimit,
00473                                   IDLE,
00474                 <a class="code" href="class_ieee80211_mac.html#z89_1">giveUpCurrentTransmission</a>();
00475             );
00476             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Receive-ACK-Timeout,
00477                                   msg == endTimeout,
00478                                   DEFER,
00479                 <a class="code" href="class_ieee80211_mac.html#z89_2">retryCurrentTransmission</a>();
00480             );
00481         }
00482         <span class="comment">// wait until broadcast is sent</span>
00483         <a class="code" href="_f_s_m_a_8h.html#a2">FSMA_State</a>(WAITBROADCAST)
00484         {
00485             <a class="code" href="_f_s_m_a_8h.html#a6">FSMA_Enter</a>(<a class="code" href="class_ieee80211_mac.html#z83_4">scheduleBroadcastTimeoutPeriod</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()));
00486             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Transmit-Broadcast,
00487                                   msg == endTimeout,
00488                                   IDLE,
00489                 <a class="code" href="class_ieee80211_mac.html#z89_0">finishCurrentTransmission</a>();
00490                 numSentBroadcast++;
00491             );
00492         }
00493         <span class="comment">// accoriding to 9.2.5.7 CTS procedure</span>
00494         <a class="code" href="_f_s_m_a_8h.html#a2">FSMA_State</a>(WAITCTS)
00495         {
00496             <a class="code" href="_f_s_m_a_8h.html#a6">FSMA_Enter</a>(<a class="code" href="class_ieee80211_mac.html#z83_6">scheduleCTSTimeoutPeriod</a>());
00497             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Receive-CTS,
00498                                   <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg) &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_10">isForUs</a>(frame) &amp;&amp; frameType == ST_CTS,
00499                                   WAITSIFS,
00500                 <a class="code" href="class_ieee80211_mac.html#z83_5">cancelTimeoutPeriod</a>();
00501             );
00502             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Transmit-RTS-Failed,
00503                                   msg == endTimeout &amp;&amp; retryCounter == retryLimit,
00504                                   IDLE,
00505                 <a class="code" href="class_ieee80211_mac.html#z89_1">giveUpCurrentTransmission</a>();
00506             );
00507             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Receive-CTS-Timeout,
00508                                   msg == endTimeout,
00509                                   DEFER,
00510                 <a class="code" href="class_ieee80211_mac.html#z89_2">retryCurrentTransmission</a>();
00511             );
00512         }
00513         <a class="code" href="_f_s_m_a_8h.html#a2">FSMA_State</a>(WAITSIFS)
00514         {
00515             <a class="code" href="_f_s_m_a_8h.html#a6">FSMA_Enter</a>(<a class="code" href="class_ieee80211_mac.html#z83_0">scheduleSIFSPeriod</a>(frame));
00516             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Transmit-CTS,
00517                                   msg == endSIFS &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_12">frameReceivedBeforeSIFS</a>()-&gt;getType() == ST_RTS,
00518                                   IDLE,
00519                 <a class="code" href="class_ieee80211_mac.html#z85_3">sendCTSFrameOnEndSIFS</a>();
00520                 <a class="code" href="class_ieee80211_mac.html#z89_6">resetStateVariables</a>();
00521             );
00522             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Transmit-DATA,
00523                                   msg == endSIFS &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_12">frameReceivedBeforeSIFS</a>()-&gt;getType() == ST_CTS,
00524                                   WAITACK,
00525                 <a class="code" href="class_ieee80211_mac.html#z85_5">sendDataFrameOnEndSIFS</a>(<a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>());
00526             );
00527             <a class="code" href="_f_s_m_a_8h.html#a3">FSMA_Event_Transition</a>(Transmit-ACK,
00528                                   msg == endSIFS &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_11">isDataOrMgmtFrame</a>(<a class="code" href="class_ieee80211_mac.html#z89_12">frameReceivedBeforeSIFS</a>()),
00529                                   IDLE,
00530                 <a class="code" href="class_ieee80211_mac.html#z85_0">sendACKFrameOnEndSIFS</a>();
00531                 <a class="code" href="class_ieee80211_mac.html#z89_6">resetStateVariables</a>();
00532             );
00533         }
00534         <span class="comment">// this is not a real state</span>
00535         <a class="code" href="_f_s_m_a_8h.html#a2">FSMA_State</a>(RECEIVE)
00536         {
00537             <a class="code" href="_f_s_m_a_8h.html#a4">FSMA_No_Event_Transition</a>(Immediate-Receive-Error,
00538                                      <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg) &amp;&amp; (msgKind == COLLISION || msgKind == BITERROR),
00539                                      IDLE,
00540                 EV &lt;&lt; <span class="stringliteral">"received frame contains bit errors or collision, next wait period is EIFS\n"</span>;
00541                 numCollision++;
00542                 <a class="code" href="class_ieee80211_mac.html#z89_6">resetStateVariables</a>();
00543             );
00544             <a class="code" href="_f_s_m_a_8h.html#a4">FSMA_No_Event_Transition</a>(Immediate-Receive-Broadcast,
00545                                      <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg) &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_9">isBroadcast</a>(frame) &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_11">isDataOrMgmtFrame</a>(frame),
00546                                      IDLE,
00547                 <a class="code" href="class_wireless_mac_base.html#z123_1">sendUp</a>(frame);
00548                 numReceivedBroadcast++;
00549                 <a class="code" href="class_ieee80211_mac.html#z89_6">resetStateVariables</a>();
00550             );
00551             <a class="code" href="_f_s_m_a_8h.html#a4">FSMA_No_Event_Transition</a>(Immediate-Receive-Data,
00552                                      <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg) &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_10">isForUs</a>(frame) &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_11">isDataOrMgmtFrame</a>(frame),
00553                                      WAITSIFS,
00554                 <a class="code" href="class_wireless_mac_base.html#z123_1">sendUp</a>(frame);
00555                 numReceived++;
00556             );
00557             <a class="code" href="_f_s_m_a_8h.html#a4">FSMA_No_Event_Transition</a>(Immediate-Receive-RTS,
00558                                      <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg) &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z89_10">isForUs</a>(frame) &amp;&amp; frameType == ST_RTS,
00559                                      WAITSIFS,
00560             );
00561             <a class="code" href="_f_s_m_a_8h.html#a4">FSMA_No_Event_Transition</a>(Immediate-Receive-Other,
00562                                      <a class="code" href="class_wireless_mac_base.html#z121_4">isLowerMsg</a>(msg),
00563                                      IDLE,
00564                 <a class="code" href="class_ieee80211_mac.html#z89_6">resetStateVariables</a>();
00565             );
00566         }
00567     }
00568 
00569     <a class="code" href="class_ieee80211_mac.html#z89_16">logState</a>();
00570     <a class="code" href="class_ieee80211_mac.html#z73_8">stateVector</a>.record(<a class="code" href="class_ieee80211_mac.html#z69_2">fsm</a>.state());
00571 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z77_1" doxytag="Ieee80211Mac::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialization of the module and some variables. 
<p>

<p>
Reimplemented from <a class="el" href="class_wireless_mac_base.html#b0">WirelessMacBase</a>.<div class="fragment"><pre class="fragment">00058 {
00059     <a class="code" href="class_wireless_mac_base.html#b0">WirelessMacBase::initialize</a>(stage);
00060 
00061     <span class="keywordflow">if</span> (stage == 0)
00062     {
00063         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Initializing stage 0\n"</span>;
00064 
00065         <span class="comment">// initialize parameters</span>
00066         <a class="code" href="class_ieee80211_mac.html#z67_3">maxQueueSize</a> = par(<span class="stringliteral">"maxQueueSize"</span>);
00067         <a class="code" href="class_ieee80211_mac.html#z67_1">bitrate</a> = par(<span class="stringliteral">"bitrate"</span>);
00068         <a class="code" href="class_ieee80211_mac.html#z67_2">basicBitrate</a> = 2e6; <span class="comment">//FIXME make it parameter</span>
00069         <a class="code" href="class_ieee80211_mac.html#z67_4">rtsThreshold</a> = par(<span class="stringliteral">"rtsThresholdBytes"</span>);
00070 
00071         <a class="code" href="class_ieee80211_mac.html#z67_5">retryLimit</a> = par(<span class="stringliteral">"retryLimit"</span>);
00072         <span class="keywordflow">if</span> (retryLimit == -1) retryLimit = 7;
00073         ASSERT(retryLimit &gt;= 0);
00074 
00075         cwMinData = par("cwMinData");
00076         if (cwMinData == -1) cwMinData = CW_MIN;
00077         ASSERT(cwMinData &gt;= 0);
00078 
00079         cwMinBroadcast = par("cwMinBroadcast");
00080         if (cwMinBroadcast == -1) cwMinBroadcast = 31;
00081         ASSERT(cwMinBroadcast &gt;= 0);
00082 
00083         const <span class="keywordtype">char</span> *addressString = par("address");
00084         if (!strcmp(addressString, "auto")) {
00085             <span class="comment">// assign automatic address</span>
00086             address = <a class="code" href="class_m_a_c_address.html#e0">MACAddress::generateAutoAddress</a>();
00087             <span class="comment">// change module parameter from "auto" to concrete address</span>
00088             par(<span class="stringliteral">"address"</span>).setStringValue(address.str().c_str());
00089         }
00090         <span class="keywordflow">else</span>
00091             <a class="code" href="class_ieee80211_mac.html#z67_0">address</a>.<a class="code" href="class_m_a_c_address.html#a6">setAddress</a>(addressString);
00092 
00093         <span class="comment">// subscribe for the information of the carrier sense</span>
00094         <a class="code" href="class_wireless_mac_base.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z22_0">subscribe</a>(<span class="keyword">this</span>, NF_RADIOSTATE_CHANGED);
00095 
00096         <span class="comment">// initalize self messages</span>
00097         <a class="code" href="class_ieee80211_mac.html#z71_0">endSIFS</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"SIFS"</span>);
00098         <a class="code" href="class_ieee80211_mac.html#z71_1">endDIFS</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"DIFS"</span>);
00099         <a class="code" href="class_ieee80211_mac.html#z71_2">endBackoff</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"Backoff"</span>);
00100         <a class="code" href="class_ieee80211_mac.html#z71_3">endTimeout</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"Timeout"</span>);
00101         <a class="code" href="class_ieee80211_mac.html#z71_4">endReserve</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"Reserve"</span>);
00102         <a class="code" href="class_ieee80211_mac.html#z71_5">mediumStateChange</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"MediumStateChange"</span>);
00103 
00104         <span class="comment">// interface</span>
00105         <a class="code" href="class_ieee80211_mac.html#z77_2">registerInterface</a>();
00106 
00107         <span class="comment">// obtain pointer to external queue</span>
00108         <a class="code" href="class_ieee80211_mac.html#z77_3">initializeQueueModule</a>();
00109 
00110         <span class="comment">// state variables</span>
00111         <a class="code" href="class_ieee80211_mac.html#z69_2">fsm</a>.setName(<span class="stringliteral">"Ieee80211Mac State Machine"</span>);
00112         <a class="code" href="class_ieee80211_mac.html#z69_3">mode</a> = <a class="code" href="class_ieee80211_mac.html#z69_1x9">DCF</a>;
00113         <a class="code" href="class_ieee80211_mac.html#z69_4">sequenceNumber</a> = 0;
00114         <a class="code" href="class_ieee80211_mac.html#z69_10">radioState</a> = <a class="code" href="class_radio_state.html#w4w0">RadioState::IDLE</a>;
00115         <a class="code" href="class_ieee80211_mac.html#z69_9">retryCounter</a> = 0;
00116         <a class="code" href="class_ieee80211_mac.html#z69_6">backoff</a> = <span class="keyword">false</span>;
00117         <a class="code" href="class_ieee80211_mac.html#z69_5">lastReceiveFailed</a> = <span class="keyword">false</span>;
00118         <a class="code" href="class_ieee80211_mac.html#z69_7">nav</a> = <span class="keyword">false</span>;
00119 
00120         <span class="comment">// statistics</span>
00121         <a class="code" href="class_ieee80211_mac.html#z73_0">numRetry</a> = 0;
00122         <a class="code" href="class_ieee80211_mac.html#z73_1">numSentWithoutRetry</a> = 0;
00123         <a class="code" href="class_ieee80211_mac.html#z73_2">numGivenUp</a> = 0;
00124         <a class="code" href="class_ieee80211_mac.html#z73_3">numCollision</a> = 0;
00125         <a class="code" href="class_ieee80211_mac.html#z73_4">numSent</a> = 0;
00126         <a class="code" href="class_ieee80211_mac.html#z73_5">numReceived</a> = 0;
00127         <a class="code" href="class_ieee80211_mac.html#z73_6">numSentBroadcast</a> = 0;
00128         <a class="code" href="class_ieee80211_mac.html#z73_7">numReceivedBroadcast</a> = 0;
00129         <a class="code" href="class_ieee80211_mac.html#z73_8">stateVector</a>.setName(<span class="stringliteral">"State"</span>);
00130         <a class="code" href="class_ieee80211_mac.html#z73_9">radioStateVector</a>.setName(<span class="stringliteral">"RadioState"</span>);
00131 
00132         <span class="comment">// initialize watches</span>
00133         WATCH(fsm);
00134         WATCH(radioState);
00135         WATCH(retryCounter);
00136         WATCH(backoff);
00137         WATCH(nav);
00138 
00139         WATCH(numRetry);
00140         WATCH(numSentWithoutRetry);
00141         WATCH(numGivenUp);
00142         WATCH(numCollision);
00143         WATCH(numSent);
00144         WATCH(numReceived);
00145         WATCH(numSentBroadcast);
00146         WATCH(numReceivedBroadcast);
00147     }
00148 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z77_3" doxytag="Ieee80211Mac::initializeQueueModule"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::initializeQueueModule           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00186 {
00187     <span class="comment">// use of external queue module is optional -- find it if there's one specified</span>
00188     <span class="keywordflow">if</span> (par(<span class="stringliteral">"queueModule"</span>).stringValue()[0])
00189     {
00190         cModule *module = parentModule()-&gt;submodule(par(<span class="stringliteral">"queueModule"</span>).stringValue());
00191         <a class="code" href="class_ieee80211_mac.html#z69_13">queueModule</a> = check_and_cast&lt;IPassiveQueue *&gt;(module);
00192 
00193         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Requesting first two frames from queue module\n"</span>;
00194         <a class="code" href="class_ieee80211_mac.html#z69_13">queueModule</a>-&gt;<a class="code" href="class_i_passive_queue.html#a1">requestPacket</a>();
00195         <span class="comment">// needed for backoff: mandatory if next message is already present</span>
00196         <a class="code" href="class_ieee80211_mac.html#z69_13">queueModule</a>-&gt;<a class="code" href="class_i_passive_queue.html#a1">requestPacket</a>();
00197     }
00198 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_8" doxytag="Ieee80211Mac::invalidateBackoffPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::invalidateBackoffPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generates a new backoff period based on the contention window. 
<p>
<div class="fragment"><pre class="fragment">00714 {
00715     <a class="code" href="class_ieee80211_mac.html#z69_8">backoffPeriod</a> = -1;
00716 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_9" doxytag="Ieee80211Mac::isBroadcast"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool Ieee80211Mac::isBroadcast           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns true if message is a broadcast message. 
<p>
<div class="fragment"><pre class="fragment">00949 {
00950     <span class="keywordflow">return</span> frame &amp;&amp; frame-&gt;<a class="code" href="class_ieee80211_frame.html#a21">getReceiverAddress</a>().<a class="code" href="class_m_a_c_address.html#a11">isBroadcast</a>();
00951 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_11" doxytag="Ieee80211Mac::isDataOrMgmtFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool Ieee80211Mac::isDataOrMgmtFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Checks if the frame is a data or management frame. 
<p>
<div class="fragment"><pre class="fragment">00959 {
00960     <span class="keywordflow">return</span> dynamic_cast&lt;Ieee80211DataOrMgmtFrame*&gt;(frame);
00961 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_10" doxytag="Ieee80211Mac::isForUs"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool Ieee80211Mac::isForUs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns true if message destination address is ours. 
<p>
<div class="fragment"><pre class="fragment">00954 {
00955     <span class="keywordflow">return</span> frame &amp;&amp; frame-&gt;<a class="code" href="class_ieee80211_frame.html#a21">getReceiverAddress</a>() == <a class="code" href="class_ieee80211_mac.html#z67_0">address</a>;
00956 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_9" doxytag="Ieee80211Mac::isInvalidBackoffPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool Ieee80211Mac::isInvalidBackoffPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00719 {
00720     <span class="keywordflow">return</span> <a class="code" href="class_ieee80211_mac.html#z69_8">backoffPeriod</a> == -1;
00721 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_8" doxytag="Ieee80211Mac::isMediumFree"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool Ieee80211Mac::isMediumFree           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Tells if the medium is free according to the physical and virtual carrier sense algorithm. 
<p>
<div class="fragment"><pre class="fragment">00944 {
00945     <span class="keywordflow">return</span> <a class="code" href="class_ieee80211_mac.html#z69_10">radioState</a> == <a class="code" href="class_radio_state.html#w4w0">RadioState::IDLE</a> &amp;&amp; !<a class="code" href="class_ieee80211_mac.html#z71_4">endReserve</a>-&gt;isScheduled();
00946 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_7" doxytag="Ieee80211Mac::isMediumStateChange"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool Ieee80211Mac::isMediumStateChange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Used by the state machine to identify medium state change events. This message is currently optimized away and not sent through the kernel. 
<p>
<div class="fragment"><pre class="fragment">00939 {
00940     <span class="keywordflow">return</span> msg == <a class="code" href="class_ieee80211_mac.html#z71_5">mediumStateChange</a> || (msg == <a class="code" href="class_ieee80211_mac.html#z71_4">endReserve</a> &amp;&amp; <a class="code" href="class_ieee80211_mac.html#z69_10">radioState</a> == <a class="code" href="class_radio_state.html#w4w0">RadioState::IDLE</a>);
00941 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_16" doxytag="Ieee80211Mac::logState"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::logState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Logs all state information. 
<p>
<div class="fragment"><pre class="fragment">00994 {
00995     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a>  &lt;&lt; <span class="stringliteral">"state information: mode = "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z89_17">modeName</a>(mode) &lt;&lt; <span class="stringliteral">", state = "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z69_2">fsm</a>.stateName()
00996         &lt;&lt; <span class="stringliteral">", backoff = "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z69_6">backoff</a> &lt;&lt; <span class="stringliteral">", backoffPeriod = "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z69_8">backoffPeriod</a>
00997         &lt;&lt; <span class="stringliteral">", retryCounter = "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z69_9">retryCounter</a> &lt;&lt; <span class="stringliteral">", radioState = "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z69_10">radioState</a>
00998         &lt;&lt; <span class="stringliteral">", nav = "</span> &lt;&lt; <a class="code" href="class_ieee80211_mac.html#z69_7">nav</a> &lt;&lt; endl;
00999 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_17" doxytag="Ieee80211Mac::modeName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char * Ieee80211Mac::modeName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>mode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Produce a readable name of the given MAC operation mode. 
<p>
<div class="fragment"><pre class="fragment">01002 {
01003 <span class="preprocessor">#define CASE(x) case x: s=#x; break</span>
01004 <span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = <span class="stringliteral">"???"</span>;
01005     <span class="keywordflow">switch</span> (mode)
01006     {
01007         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(DCF);
01008         <a class="code" href="_ether_m_a_c_8cc.html#a0">CASE</a>(PCF);
01009     }
01010     <span class="keywordflow">return</span> s;
01011 <span class="preprocessor">#undef CASE</span>
01012 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z77_0" doxytag="Ieee80211Mac::numInitStages"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual int Ieee80211Mac::numInitStages           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialization of the module and its variables. 
<p>
<div class="fragment"><pre class="fragment">00235 {<span class="keywordflow">return</span> 2;}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z81_4" doxytag="Ieee80211Mac::PIFSPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t Ieee80211Mac::PIFSPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00589 {
00590     <span class="keywordflow">return</span> <a class="code" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a>() + <a class="code" href="class_ieee80211_mac.html#z81_1">SlotPeriod</a>();
00591 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_13" doxytag="Ieee80211Mac::popTransmissionQueue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::popTransmissionQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deletes frame at the front of queue. 
<p>
<div class="fragment"><pre class="fragment">00969 {
00970     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"dropping frame from transmission queue\n"</span>;
00971     <a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *temp = <a class="code" href="class_ieee80211_mac.html#z69_11">transmissionQueue</a>.front();
00972     <a class="code" href="class_ieee80211_mac.html#z69_11">transmissionQueue</a>.pop_front();
00973     <span class="keyword">delete</span> temp;
00974 
00975     <span class="keywordflow">if</span> (queueModule)
00976     {
00977         <span class="comment">// tell queue module that we've become idle</span>
00978         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"requesting another frame from queue module\n"</span>;
00979         <a class="code" href="class_ieee80211_mac.html#z69_13">queueModule</a>-&gt;<a class="code" href="class_i_passive_queue.html#a1">requestPacket</a>();
00980     }
00981 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z79_0" doxytag="Ieee80211Mac::receiveChangeNotification"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::receiveChangeNotification           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>category</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>cPolymorphic *&nbsp;</td>
          <td class="mdname" nowrap> <em>details</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called by the <a class="el" href="class_notification_board.html">NotificationBoard</a> whenever a change occurs we're interested in. 
<p>

<p>
Implements <a class="el" href="class_i_notifiable.html#a1">INotifiable</a>.<div class="fragment"><pre class="fragment">00308 {
00309     Enter_Method_Silent();
00310     <a class="code" href="_notifier_consts_8cc.html#a1">printNotificationBanner</a>(category, details);
00311 
00312     <span class="keywordflow">if</span> (category == NF_RADIOSTATE_CHANGED)
00313     {
00314         <a class="code" href="class_radio_state.html#w4">RadioState::State</a> newRadioState = check_and_cast&lt;RadioState *&gt;(details)-&gt;getState();
00315 
00316         <span class="comment">// FIXME: double recording, because there's no sample hold in the gui</span>
00317         <a class="code" href="class_ieee80211_mac.html#z73_9">radioStateVector</a>.record(radioState);
00318         <a class="code" href="class_ieee80211_mac.html#z73_9">radioStateVector</a>.record(newRadioState);
00319 
00320         <a class="code" href="class_ieee80211_mac.html#z69_10">radioState</a> = newRadioState;
00321 
00322         <a class="code" href="class_ieee80211_mac.html#z79_5">handleWithFSM</a>(mediumStateChange);
00323     }
00324 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z77_2" doxytag="Ieee80211Mac::registerInterface"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::registerInterface           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00151 {
00152     <a class="code" href="class_interface_table.html">InterfaceTable</a> *ift = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a>().getIfExists();
00153     <span class="keywordflow">if</span> (!ift)
00154         return;
00155 
00156     <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *e = new <a class="code" href="class_interface_entry.html">InterfaceEntry</a>();
00157 
00158     <span class="comment">// interface name: NetworkInterface module's name without special characters ([])</span>
00159     <span class="keywordtype">char</span> *interfaceName = new <span class="keywordtype">char</span>[strlen(parentModule()-&gt;fullName()) + 1];
00160     <span class="keywordtype">char</span> *d = interfaceName;
00161     for (const <span class="keywordtype">char</span> *s = parentModule()-&gt;fullName(); *s; s++)
00162         if (isalnum(*s))
00163             *d++ = *s;
00164     *d = '\0';
00165 
00166     e-&gt;setName(interfaceName);
00167     delete [] interfaceName;
00168 
00169     <span class="comment">// address</span>
00170     e-&gt;setMACAddress(address);
00171     e-&gt;setInterfaceToken(address.formInterfaceIdentifier());
00172 
00173     <span class="comment">// FIXME: MTU on 802.11 = ?</span>
00174     e-&gt;setMtu(1500);
00175 
00176     <span class="comment">// capabilities</span>
00177     e-&gt;setBroadcast(true);
00178     e-&gt;setMulticast(true);
00179     e-&gt;setPointToPoint(false);
00180 
00181     <span class="comment">// add</span>
00182     ift-&gt;addInterface(e, this);
00183 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_6" doxytag="Ieee80211Mac::resetStateVariables"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::resetStateVariables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reset backoff, backoffPeriod and retryCounter for IDLE state. 
<p>
<div class="fragment"><pre class="fragment">00925 {
00926     <a class="code" href="class_ieee80211_mac.html#z69_8">backoffPeriod</a> = 0;
00927     <a class="code" href="class_ieee80211_mac.html#z69_9">retryCounter</a> = 0;
00928 
00929     <span class="keywordflow">if</span> (!<a class="code" href="class_ieee80211_mac.html#z69_11">transmissionQueue</a>.empty()) {
00930         <a class="code" href="class_ieee80211_mac.html#z69_6">backoff</a> = <span class="keyword">true</span>;
00931         <a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()-&gt;<a class="code" href="class_ieee80211_frame.html#a14">setRetry</a>(<span class="keyword">false</span>);
00932     }
00933     <span class="keywordflow">else</span> {
00934         <a class="code" href="class_ieee80211_mac.html#z69_6">backoff</a> = <span class="keyword">false</span>;
00935     }
00936 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_2" doxytag="Ieee80211Mac::retryCurrentTransmission"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::retryCurrentTransmission           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00893 {
00894     ASSERT(retryCounter &lt; retryLimit);
00895     <a class="code" href="class_ieee80211_mac.html#z89_5">currentTransmission</a>()-&gt;<a class="code" href="class_ieee80211_frame.html#a14">setRetry</a>(<span class="keyword">true</span>);
00896     <a class="code" href="class_ieee80211_mac.html#z69_9">retryCounter</a>++;
00897     <a class="code" href="class_ieee80211_mac.html#z73_0">numRetry</a>++;
00898     <a class="code" href="class_ieee80211_mac.html#z69_6">backoff</a> = <span class="keyword">true</span>;
00899     <a class="code" href="class_ieee80211_mac.html#z83_10">generateBackoffPeriod</a>();
00900 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_12" doxytag="Ieee80211Mac::scheduleBackoffPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::scheduleBackoffPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00740 {
00741     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"scheduling backoff period\n"</span>;
00742     scheduleAt(simTime() + backoffPeriod, endBackoff);
00743 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_4" doxytag="Ieee80211Mac::scheduleBroadcastTimeoutPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::scheduleBroadcastTimeoutPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00666 {
00667     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"scheduling broadcast timeout period\n"</span>;
00668     scheduleAt(simTime() + <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(frameToSend), endTimeout);
00669 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_6" doxytag="Ieee80211Mac::scheduleCTSTimeoutPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::scheduleCTSTimeoutPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00678 {
00679     scheduleAt(simTime() + <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(LENGTH_RTS, basicBitrate) + <a class="code" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a>() + <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(LENGTH_CTS, basicBitrate) + MAX_PROPAGATION_DELAY * 2, endTimeout);
00680 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_3" doxytag="Ieee80211Mac::scheduleDataTimeoutPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::scheduleDataTimeoutPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00660 {
00661     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"scheduling data timeout period\n"</span>;
00662     scheduleAt(simTime() + <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(frameToSend) + <a class="code" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a>() + <a class="code" href="class_ieee80211_mac.html#z89_14">frameDuration</a>(LENGTH_ACK, basicBitrate) + MAX_PROPAGATION_DELAY * 2, endTimeout);
00663 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_1" doxytag="Ieee80211Mac::scheduleDIFSPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::scheduleDIFSPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00640 {
00641     <span class="keywordflow">if</span> (lastReceiveFailed)
00642     {
00643         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"receiption of last frame failed, scheduling EIFS period\n"</span>;
00644         scheduleAt(simTime() + <a class="code" href="class_ieee80211_mac.html#z81_3">EIFSPeriod</a>(), endDIFS);
00645     }
00646     <span class="keywordflow">else</span>
00647     {
00648         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"scheduling DIFS period\n"</span>;
00649         scheduleAt(simTime() + <a class="code" href="class_ieee80211_mac.html#z81_2">DIFSPeriod</a>(), endDIFS);
00650     }
00651 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_7" doxytag="Ieee80211Mac::scheduleReservePeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::scheduleReservePeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Schedule network allocation period according to 9.2.5.4. 
<p>
<div class="fragment"><pre class="fragment">00683 {
00684     simtime_t reserve = frame-&gt;<a class="code" href="class_ieee80211_frame.html#a17">getDuration</a>();
00685 
00686     <span class="comment">// see spec. 7.1.3.2</span>
00687     <span class="keywordflow">if</span> (!<a class="code" href="class_ieee80211_mac.html#z89_10">isForUs</a>(frame) &amp;&amp; reserve != 0 &amp;&amp; reserve &lt; 32768)
00688     {
00689         <span class="keywordflow">if</span> (<a class="code" href="class_ieee80211_mac.html#z71_4">endReserve</a>-&gt;isScheduled()) {
00690             simtime_t oldReserve = <a class="code" href="class_ieee80211_mac.html#z71_4">endReserve</a>-&gt;arrivalTime() - simTime();
00691 
00692             <span class="keywordflow">if</span> (oldReserve &gt; reserve)
00693                 return;
00694 
00695             reserve = max(reserve, oldReserve);
00696             cancelEvent(endReserve);
00697         }
00698         else if (radioState == <a class="code" href="class_radio_state.html">RadioState</a>::IDLE)
00699         {
00700             <span class="comment">// NAV: the channel just became virtually busy according to the spec</span>
00701             scheduleAt(simTime(), mediumStateChange);
00702         }
00703 
00704         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"scheduling reserve period for: "</span> &lt;&lt; reserve &lt;&lt; endl;
00705 
00706         ASSERT(reserve &gt; 0);
00707 
00708         <a class="code" href="class_ieee80211_mac.html#z69_7">nav</a> = <span class="keyword">true</span>;
00709         scheduleAt(simTime() + reserve, endReserve);
00710     }
00711 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z83_0" doxytag="Ieee80211Mac::scheduleSIFSPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::scheduleSIFSPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00633 {
00634     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"scheduling SIFS period\n"</span>;
00635     <a class="code" href="class_ieee80211_mac.html#z71_0">endSIFS</a>-&gt;setContextPointer(frame-&gt;<a class="code" href="class_ieee80211_frame.html#a4">dup</a>());
00636     scheduleAt(simTime() + <a class="code" href="class_ieee80211_mac.html#z81_0">SIFSPeriod</a>(), endSIFS);
00637 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z85_1" doxytag="Ieee80211Mac::sendACKFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::sendACKFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00763 {
00764     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending ACK frame\n"</span>;
00765     <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(<a class="code" href="class_ieee80211_mac.html#b0">setBasicBitrate</a>(<a class="code" href="class_ieee80211_mac.html#z87_1">buildACKFrame</a>(frameToACK)));
00766 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z85_0" doxytag="Ieee80211Mac::sendACKFrameOnEndSIFS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::sendACKFrameOnEndSIFS           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00755 {
00756     <a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *frameToACK = (<a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *)<a class="code" href="class_ieee80211_mac.html#z71_0">endSIFS</a>-&gt;contextPointer();
00757     <a class="code" href="class_ieee80211_mac.html#z71_0">endSIFS</a>-&gt;setContextPointer(NULL);
00758     <a class="code" href="class_ieee80211_mac.html#z85_1">sendACKFrame</a>(check_and_cast&lt;Ieee80211DataOrMgmtFrame*&gt;(frameToACK));
00759     <span class="keyword">delete</span> frameToACK;
00760 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z85_7" doxytag="Ieee80211Mac::sendBroadcastFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::sendBroadcastFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frameToSend</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00783 {
00784     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending Broadcast frame\n"</span>;
00785     <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(<a class="code" href="class_ieee80211_mac.html#z87_4">buildBroadcastFrame</a>(frameToSend));
00786 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z85_4" doxytag="Ieee80211Mac::sendCTSFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::sendCTSFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_r_t_s_frame.html">Ieee80211RTSFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>rtsFrame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00803 {
00804     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending CTS frame\n"</span>;
00805     <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(<a class="code" href="class_ieee80211_mac.html#b0">setBasicBitrate</a>(<a class="code" href="class_ieee80211_mac.html#z87_3">buildCTSFrame</a>(rtsFrame)));
00806 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z85_3" doxytag="Ieee80211Mac::sendCTSFrameOnEndSIFS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::sendCTSFrameOnEndSIFS           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00795 {
00796     <a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *rtsFrame = (<a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *)<a class="code" href="class_ieee80211_mac.html#z71_0">endSIFS</a>-&gt;contextPointer();
00797     <a class="code" href="class_ieee80211_mac.html#z71_0">endSIFS</a>-&gt;setContextPointer(NULL);
00798     <a class="code" href="class_ieee80211_mac.html#z85_4">sendCTSFrame</a>(check_and_cast&lt;Ieee80211RTSFrame*&gt;(rtsFrame));
00799     <span class="keyword">delete</span> rtsFrame;
00800 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z85_6" doxytag="Ieee80211Mac::sendDataFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::sendDataFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frameToSend</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00777 {
00778     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending Data frame\n"</span>;
00779     <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(<a class="code" href="class_ieee80211_mac.html#z87_0">buildDataFrame</a>(frameToSend));
00780 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z85_5" doxytag="Ieee80211Mac::sendDataFrameOnEndSIFS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::sendDataFrameOnEndSIFS           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frameToSend</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00769 {
00770     <a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *ctsFrame = (<a class="code" href="class_ieee80211_frame.html">Ieee80211Frame</a> *)<a class="code" href="class_ieee80211_mac.html#z71_0">endSIFS</a>-&gt;contextPointer();
00771     <a class="code" href="class_ieee80211_mac.html#z71_0">endSIFS</a>-&gt;setContextPointer(NULL);
00772     <a class="code" href="class_ieee80211_mac.html#z85_6">sendDataFrame</a>(frameToSend);
00773     <span class="keyword">delete</span> ctsFrame;
00774 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_3" doxytag="Ieee80211Mac::sendDownPendingRadioConfigMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::sendDownPendingRadioConfigMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send down the change channel message to the physical layer if there is any. 
<p>
<div class="fragment"><pre class="fragment">00908 {
00909     <span class="keywordflow">if</span> (pendingRadioConfigMsg != NULL)
00910     {
00911         <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(pendingRadioConfigMsg);
00912         <a class="code" href="class_ieee80211_mac.html#z69_14">pendingRadioConfigMsg</a> = NULL;
00913     }
00914 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z85_2" doxytag="Ieee80211Mac::sendRTSFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::sendRTSFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_or_mgmt_frame.html">Ieee80211DataOrMgmtFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frameToSend</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00789 {
00790     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending RTS frame\n"</span>;
00791     <a class="code" href="class_wireless_mac_base.html#z123_0">sendDown</a>(<a class="code" href="class_ieee80211_mac.html#b0">setBasicBitrate</a>(<a class="code" href="class_ieee80211_mac.html#z87_2">buildRTSFrame</a>(frameToSend)));
00792 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="Ieee80211Mac::setBasicBitrate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> * Ieee80211Mac::setBasicBitrate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_frame.html">Ieee80211Frame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Attaches a <a class="el" href="class_phy_control_info.html">PhyControlInfo</a> to the frame which will cause it to be sent at basicBitrate not bitrate (e.g. 2Mbps instead of 11Mbps). Used with ACK, CTS, RTS. 
<p>
<div class="fragment"><pre class="fragment">00868 {
00869     ASSERT(frame-&gt;controlInfo()==NULL);
00870     <a class="code" href="class_phy_control_info.html">PhyControlInfo</a> *ctrl = <span class="keyword">new</span> <a class="code" href="class_phy_control_info.html">PhyControlInfo</a>();
00871     ctrl-&gt;<a class="code" href="class_phy_control_info.html#a9">setBitrate</a>(basicBitrate);
00872     frame-&gt;setControlInfo(ctrl);
00873     <span class="keywordflow">return</span> frame;
00874 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z89_4" doxytag="Ieee80211Mac::setMode"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211Mac::setMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_mac.html#z69_1">Mode</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>mode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Change the current MAC operation mode. 
<p>
<div class="fragment"><pre class="fragment">00917 {
00918     <span class="keywordflow">if</span> (mode == PCF)
00919         error("PCF mode not yet supported");
00920 
00921     this-&gt;mode = mode;
00922 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z81_0" doxytag="Ieee80211Mac::SIFSPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t Ieee80211Mac::SIFSPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00577 {
00578 <span class="comment">// TODO:   return aRxRFDelay() + aRxPLCPDelay() + aMACProcessingDelay() + aRxTxTurnaroundTime();</span>
00579     <span class="keywordflow">return</span> <a class="code" href="_ieee80211_consts_8h.html#a6">SIFS</a>;
00580 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z81_1" doxytag="Ieee80211Mac::SlotPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t Ieee80211Mac::SlotPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00583 {
00584 <span class="comment">// TODO:   return aCCATime() + aRxTxTurnaroundTime + aAirPropagationTime() + aMACProcessingDelay();</span>
00585     <span class="keywordflow">return</span> <a class="code" href="_ieee80211_consts_8h.html#a5">ST</a>;
00586 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="z67_0" doxytag="Ieee80211Mac::address"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_m_a_c_address.html">MACAddress</a> <a class="el" href="class_ieee80211_mac.html#z67_0">Ieee80211Mac::address</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
MAC address     </td>
  </tr>
</table>
<a class="anchor" name="z69_12" doxytag="Ieee80211Mac::asfTuplesList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_mac.html#y1">Ieee80211ASFTupleList</a> <a class="el" href="class_ieee80211_mac.html#z69_12">Ieee80211Mac::asfTuplesList</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
A list of last sender, sequence and fragment number tuples to identify duplicates, see spec 9.2.9. TODO: this is not yet used     </td>
  </tr>
</table>
<a class="anchor" name="z69_6" doxytag="Ieee80211Mac::backoff"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="class_ieee80211_mac.html#z69_6">Ieee80211Mac::backoff</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
True if backoff is enabled     </td>
  </tr>
</table>
<a class="anchor" name="z69_8" doxytag="Ieee80211Mac::backoffPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_ieee80211_mac.html#z69_8">Ieee80211Mac::backoffPeriod</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remaining backoff period in seconds     </td>
  </tr>
</table>
<a class="anchor" name="z67_2" doxytag="Ieee80211Mac::basicBitrate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_ieee80211_mac.html#z67_2">Ieee80211Mac::basicBitrate</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The basic bitrate (1 or 2 Mbps) is used to transmit control frames     </td>
  </tr>
</table>
<a class="anchor" name="z67_1" doxytag="Ieee80211Mac::bitrate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_ieee80211_mac.html#z67_1">Ieee80211Mac::bitrate</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The bitrate is used to send data and mgmt frames; be sure to use a valid 802.11 bitrate     </td>
  </tr>
</table>
<a class="anchor" name="z67_7" doxytag="Ieee80211Mac::cwMinBroadcast"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_ieee80211_mac.html#z67_7">Ieee80211Mac::cwMinBroadcast</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Contention window size for broadcast messages.     </td>
  </tr>
</table>
<a class="anchor" name="z67_6" doxytag="Ieee80211Mac::cwMinData"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_ieee80211_mac.html#z67_6">Ieee80211Mac::cwMinData</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Minimum contention window.     </td>
  </tr>
</table>
<a class="anchor" name="z71_2" doxytag="Ieee80211Mac::endBackoff"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_ieee80211_mac.html#z71_2">Ieee80211Mac::endBackoff</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
End of the backoff period     </td>
  </tr>
</table>
<a class="anchor" name="z71_1" doxytag="Ieee80211Mac::endDIFS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_ieee80211_mac.html#z71_1">Ieee80211Mac::endDIFS</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
End of the Data Inter-Frame Time period     </td>
  </tr>
</table>
<a class="anchor" name="z71_4" doxytag="Ieee80211Mac::endReserve"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_ieee80211_mac.html#z71_4">Ieee80211Mac::endReserve</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
End of medium reserve period (NAV) when two other nodes were communicating on the channel     </td>
  </tr>
</table>
<a class="anchor" name="z71_0" doxytag="Ieee80211Mac::endSIFS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_ieee80211_mac.html#z71_0">Ieee80211Mac::endSIFS</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
End of the Short Inter-Frame Time period     </td>
  </tr>
</table>
<a class="anchor" name="z71_3" doxytag="Ieee80211Mac::endTimeout"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_ieee80211_mac.html#z71_3">Ieee80211Mac::endTimeout</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Timeout after the transmission of an RTS, a CTS, or a DATA frame     </td>
  </tr>
</table>
<a class="anchor" name="z67_8" doxytag="Ieee80211Mac::fragmentationThreshold"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const int <a class="el" href="class_ieee80211_mac.html#z67_8">Ieee80211Mac::fragmentationThreshold</a> = 2346<code> [static, protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Messages longer than this threshold will be sent in multiple fragments. see spec 361     </td>
  </tr>
</table>
<a class="anchor" name="z69_2" doxytag="Ieee80211Mac::fsm"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cFSM <a class="el" href="class_ieee80211_mac.html#z69_2">Ieee80211Mac::fsm</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z69_5" doxytag="Ieee80211Mac::lastReceiveFailed"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="class_ieee80211_mac.html#z69_5">Ieee80211Mac::lastReceiveFailed</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Indicates that the last frame received had bit errors in it or there was a collision during receiving the frame. If this flag is set, then the MAC will wait EIFS instead of DIFS period of time in WAITDIFS state.     </td>
  </tr>
</table>
<a class="anchor" name="z67_3" doxytag="Ieee80211Mac::maxQueueSize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_ieee80211_mac.html#z67_3">Ieee80211Mac::maxQueueSize</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Maximum number of frames in the queue; should be set in the omnetpp.ini     </td>
  </tr>
</table>
<a class="anchor" name="z71_5" doxytag="Ieee80211Mac::mediumStateChange"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_ieee80211_mac.html#z71_5">Ieee80211Mac::mediumStateChange</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Radio state change self message. Currently this is optimized away and sent directly     </td>
  </tr>
</table>
<a class="anchor" name="z69_3" doxytag="Ieee80211Mac::mode"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_mac.html#z69_1">Mode</a> <a class="el" href="class_ieee80211_mac.html#z69_3">Ieee80211Mac::mode</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z69_7" doxytag="Ieee80211Mac::nav"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="class_ieee80211_mac.html#z69_7">Ieee80211Mac::nav</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
True during network allocation period. This flag is present to be able to watch this state.     </td>
  </tr>
</table>
<a class="anchor" name="z73_3" doxytag="Ieee80211Mac::numCollision"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_ieee80211_mac.html#z73_3">Ieee80211Mac::numCollision</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z73_2" doxytag="Ieee80211Mac::numGivenUp"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_ieee80211_mac.html#z73_2">Ieee80211Mac::numGivenUp</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z73_5" doxytag="Ieee80211Mac::numReceived"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_ieee80211_mac.html#z73_5">Ieee80211Mac::numReceived</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z73_7" doxytag="Ieee80211Mac::numReceivedBroadcast"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_ieee80211_mac.html#z73_7">Ieee80211Mac::numReceivedBroadcast</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z73_0" doxytag="Ieee80211Mac::numRetry"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_ieee80211_mac.html#z73_0">Ieee80211Mac::numRetry</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z73_4" doxytag="Ieee80211Mac::numSent"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_ieee80211_mac.html#z73_4">Ieee80211Mac::numSent</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z73_6" doxytag="Ieee80211Mac::numSentBroadcast"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_ieee80211_mac.html#z73_6">Ieee80211Mac::numSentBroadcast</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z73_1" doxytag="Ieee80211Mac::numSentWithoutRetry"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_ieee80211_mac.html#z73_1">Ieee80211Mac::numSentWithoutRetry</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z69_14" doxytag="Ieee80211Mac::pendingRadioConfigMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_ieee80211_mac.html#z69_14">Ieee80211Mac::pendingRadioConfigMsg</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The last change channel message received and not yet sent to the physical layer, or NULL. The message will be sent down when the state goes to IDLE or DEFER next time.     </td>
  </tr>
</table>
<a class="anchor" name="z69_13" doxytag="Ieee80211Mac::queueModule"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_passive_queue.html">IPassiveQueue</a>* <a class="el" href="class_ieee80211_mac.html#z69_13">Ieee80211Mac::queueModule</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Passive queue module to request messages from     </td>
  </tr>
</table>
<a class="anchor" name="z69_10" doxytag="Ieee80211Mac::radioState"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_radio_state.html#w4">RadioState::State</a> <a class="el" href="class_ieee80211_mac.html#z69_10">Ieee80211Mac::radioState</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Physical radio (medium) state copied from physical layer     </td>
  </tr>
</table>
<a class="anchor" name="z73_9" doxytag="Ieee80211Mac::radioStateVector"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cOutVector <a class="el" href="class_ieee80211_mac.html#z73_9">Ieee80211Mac::radioStateVector</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z69_9" doxytag="Ieee80211Mac::retryCounter"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_ieee80211_mac.html#z69_9">Ieee80211Mac::retryCounter</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Number of frame retransmission attempts, this is a simpification of SLRC and SSRC, see 9.2.4 in the spec     </td>
  </tr>
</table>
<a class="anchor" name="z67_5" doxytag="Ieee80211Mac::retryLimit"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_ieee80211_mac.html#z67_5">Ieee80211Mac::retryLimit</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Maximum number of retries.     </td>
  </tr>
</table>
<a class="anchor" name="z67_4" doxytag="Ieee80211Mac::rtsThreshold"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_ieee80211_mac.html#z67_4">Ieee80211Mac::rtsThreshold</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The minimum length of MPDU to use RTS/CTS mechanism. 0 means always, extremely large value means never. See spec 9.2.6 and 361.     </td>
  </tr>
</table>
<a class="anchor" name="z69_4" doxytag="Ieee80211Mac::sequenceNumber"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_ieee80211_mac.html#z69_4">Ieee80211Mac::sequenceNumber</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sequence number to be assigned to the next frame     </td>
  </tr>
</table>
<a class="anchor" name="z73_8" doxytag="Ieee80211Mac::stateVector"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cOutVector <a class="el" href="class_ieee80211_mac.html#z73_8">Ieee80211Mac::stateVector</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z69_11" doxytag="Ieee80211Mac::transmissionQueue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_mac.html#y0">Ieee80211DataOrMgmtFrameList</a> <a class="el" href="class_ieee80211_mac.html#z69_11">Ieee80211Mac::transmissionQueue</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Messages received from upper layer and to be transmitted later     </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_ieee80211_mac_8h.html">Ieee80211Mac.h</a><li><a class="el" href="_ieee80211_mac_8cc.html">Ieee80211Mac.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:23 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
