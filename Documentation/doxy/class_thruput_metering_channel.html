<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: ThruputMeteringChannel Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>ThruputMeteringChannel Class Reference</h1><code>#include &lt;ThruputMeteringChannel.h&gt;</code>
<p>
<a href="class_thruput_metering_channel-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
A cBasicChannel extended with throughput calculation. Values get displayed on the link, using the connection's "t=" display string tag.<p>
The display can be customised with the "format" attribute. In the format string, the following characters will get expanded:<ul>
<li>'N': number of packets</li><li>'V': volume (in bytes)</li><li>'p': current packet/sec</li><li>'b': current bandwidth</li><li>'u': current channel utilization ()</li><li>'P': average packet/sec on [0,now)</li><li>'B': average bandwidth on [0,now)</li><li>'U': average channel utilization () on [0,now) Other characters are copied verbatim.</li></ul>
<p>
"Current" actually means the last measurement interval, which is 10 packets or 0.1s, whichever comes first.<p>
PROBLEM: display only gets updated if there's traffic! (For example, a high pk/sec value might stay displayed even when the link becomes idle!) 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#a0">ThruputMeteringChannel</a> (const char *name=NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#a1">ThruputMeteringChannel</a> (const <a class="el" href="class_thruput_metering_channel.html">ThruputMeteringChannel</a> &amp;ch)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#a2">~ThruputMeteringChannel</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_thruput_metering_channel.html">ThruputMeteringChannel</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#a3">operator=</a> (const <a class="el" href="class_thruput_metering_channel.html">ThruputMeteringChannel</a> &amp;ch)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual cPolymorphic *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#a4">dup</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual cPar &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#a5">addPar</a> (const char *s)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual cPar &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#a6">addPar</a> (cPar *p)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#a7">deliver</a> (cMessage *msg, simtime_t at)</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#b0">beginNewInterval</a> (simtime_t now)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#b1">updateDisplay</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cPar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p0">fmtp</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p1">batchSize</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p2">maxInterval</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p3">numPackets</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p4">numBits</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p5">intvlStartTime</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p6">intvlLastPkTime</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p7">intvlNumPackets</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p8">intvlNumBits</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p9">currentBitPerSec</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thruput_metering_channel.html#p10">currentPkPerSec</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="ThruputMeteringChannel::ThruputMeteringChannel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">ThruputMeteringChannel::ThruputMeteringChannel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em> = <code>NULL</code>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [explicit]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor. <div class="fragment"><pre class="fragment">00023                                                                : cBasicChannel(name)
00024 {
00025     <a class="code" href="class_thruput_metering_channel.html#p0">fmtp</a> = NULL;
00026     <a class="code" href="class_thruput_metering_channel.html#p1">batchSize</a> = 10;    <span class="comment">// packets</span>
00027     <a class="code" href="class_thruput_metering_channel.html#p2">maxInterval</a> = 0.1; <span class="comment">// seconds</span>
00028 
00029     <a class="code" href="class_thruput_metering_channel.html#p3">numPackets</a> = 0;
00030     <a class="code" href="class_thruput_metering_channel.html#p4">numBits</a> = 0;
00031 
00032     <a class="code" href="class_thruput_metering_channel.html#p5">intvlStartTime</a> = <a class="code" href="class_thruput_metering_channel.html#p6">intvlLastPkTime</a> = 0;
00033     <a class="code" href="class_thruput_metering_channel.html#p7">intvlNumPackets</a> = <a class="code" href="class_thruput_metering_channel.html#p8">intvlNumBits</a> = 0;
00034 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ThruputMeteringChannel::ThruputMeteringChannel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">ThruputMeteringChannel::ThruputMeteringChannel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_thruput_metering_channel.html">ThruputMeteringChannel</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ch</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Copy constructor. <div class="fragment"><pre class="fragment">00036                                                                                : cBasicChannel()
00037 {
00038     setName(ch.name());
00039     <a class="code" href="class_thruput_metering_channel.html#a3">operator=</a>(ch);
00040     cArray&amp; parlist = _parList();
00041     <a class="code" href="class_thruput_metering_channel.html#p0">fmtp</a> = (cPar *)parlist.get(<span class="stringliteral">"format"</span>);
00042 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ThruputMeteringChannel::~ThruputMeteringChannel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">ThruputMeteringChannel::~<a class="el" href="class_thruput_metering_channel.html">ThruputMeteringChannel</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destructor. <div class="fragment"><pre class="fragment">00045 {
00046 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a6" doxytag="ThruputMeteringChannel::addPar"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cPar &amp; ThruputMeteringChannel::addPar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cPar *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Redefined to add an extra attribute <div class="fragment"><pre class="fragment">00066 {
00067     cBasicChannel::addPar(p);
00068     <span class="keyword">const</span> <span class="keywordtype">char</span> *s = p-&gt;name();
00069     <span class="keywordflow">if</span> (!opp_strcmp(s,<span class="stringliteral">"format"</span>))
00070         fmtp = p;
00071     return *p;
00072 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ThruputMeteringChannel::addPar"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cPar &amp; ThruputMeteringChannel::addPar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>s</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Redefined to add an extra attribute <div class="fragment"><pre class="fragment">00058 {
00059     cPar *p = &amp;cBasicChannel::addPar(s);
00060     <span class="keywordflow">if</span> (!opp_strcmp(s,<span class="stringliteral">"format"</span>))
00061         fmtp = p;
00062     return *p;
00063 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="ThruputMeteringChannel::beginNewInterval"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ThruputMeteringChannel::beginNewInterval           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">simtime_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>now</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00097 {
00098     simtime_t duration = now - <a class="code" href="class_thruput_metering_channel.html#p5">intvlStartTime</a>;
00099 
00100     <span class="comment">// record measurements</span>
00101     <a class="code" href="class_thruput_metering_channel.html#p9">currentBitPerSec</a> = <a class="code" href="class_thruput_metering_channel.html#p8">intvlNumBits</a>/duration;
00102     <a class="code" href="class_thruput_metering_channel.html#p10">currentPkPerSec</a> = <a class="code" href="class_thruput_metering_channel.html#p7">intvlNumPackets</a>/duration;
00103 
00104     <span class="comment">// restart counters</span>
00105     intvlStartTime = now;
00106     <a class="code" href="class_thruput_metering_channel.html#p7">intvlNumPackets</a> = <a class="code" href="class_thruput_metering_channel.html#p8">intvlNumBits</a> = 0;
00107 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ThruputMeteringChannel::deliver"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool ThruputMeteringChannel::deliver           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>simtime_t&nbsp;</td>
          <td class="mdname" nowrap> <em>at</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Performs bit error rate, delay and transmission time modelling. <div class="fragment"><pre class="fragment">00075 {
00076     <span class="keywordtype">bool</span> ret = cBasicChannel::deliver(msg, t);
00077 
00078     <span class="comment">// count packets and bits</span>
00079     <a class="code" href="class_thruput_metering_channel.html#p3">numPackets</a>++;
00080     <a class="code" href="class_thruput_metering_channel.html#p4">numBits</a> += msg-&gt;length();
00081 
00082     <span class="comment">// packet should be counted to new interval</span>
00083     <span class="keywordflow">if</span> (intvlNumPackets &gt;= batchSize || t-intvlStartTime &gt;= maxInterval)
00084         beginNewInterval(t);
00085 
00086     intvlNumPackets++;
00087     intvlNumBits += msg-&gt;length();
00088     intvlLastPkTime = t;
00089 
00090     <span class="comment">// update display string</span>
00091     updateDisplay();
00092 
00093     return ret;
00094 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ThruputMeteringChannel::dup"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual cPolymorphic* ThruputMeteringChannel::dup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Creates and returns an exact copy of this object. See cObject for more details. <div class="fragment"><pre class="fragment">00101 {<span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_thruput_metering_channel.html#a0">ThruputMeteringChannel</a>(*<span class="keyword">this</span>);}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ThruputMeteringChannel::operator="></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_thruput_metering_channel.html">ThruputMeteringChannel</a> &amp; ThruputMeteringChannel::operator=           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_thruput_metering_channel.html">ThruputMeteringChannel</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ch</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Assignment <div class="fragment"><pre class="fragment">00049 {
00050     <span class="keywordflow">if</span> (<span class="keyword">this</span>==&amp;ch) return *this;
00051     cBasicChannel::operator=(ch);
00052     numPackets = ch.numPackets;
00053     numBits = ch.numBits;
00054     return *this;
00055 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="ThruputMeteringChannel::updateDisplay"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ThruputMeteringChannel::updateDisplay           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00110 {
00111     <span class="comment">// retrieve format string</span>
00112     <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt = <a class="code" href="class_thruput_metering_channel.html#p0">fmtp</a> ? <a class="code" href="class_thruput_metering_channel.html#p0">fmtp</a>-&gt;stringValue() : <span class="stringliteral">"B"</span>;
00113 
00114     <span class="comment">// produce label, based on format string</span>
00115     <span class="keywordtype">char</span> buf[200];
00116     <span class="keywordtype">char</span> *p = buf;
00117     simtime_t tt = transmissionFinishes();
00118     <span class="keywordflow">if</span> (tt==0) tt = simulation.simTime();
00119     <span class="keywordtype">double</span> bps = (tt==0) ? 0 : numBits/tt;
00120     <span class="keywordtype">double</span> bytes;
00121     for (const <span class="keywordtype">char</span> *fp = fmt; *fp &amp;&amp; buf+200-p&gt;20; fp++)
00122     {
00123         <span class="keywordflow">switch</span> (*fp)
00124         {
00125             <span class="keywordflow">case</span> <span class="charliteral">'N'</span>: <span class="comment">// number of packets</span>
00126                 p += sprintf(p, <span class="stringliteral">"%ld"</span>, numPackets);
00127                 <span class="keywordflow">break</span>;
00128             <span class="keywordflow">case</span> <span class="charliteral">'V'</span>: <span class="comment">// volume (in bytes)</span>
00129                 bytes = floor(numBits/8);
00130                 <span class="keywordflow">if</span> (bytes&lt;1024)
00131                     p += sprintf(p, "%gB", bytes);
00132                 else if (bytes&lt;1024*1024)
00133                     p += sprintf(p, "%.3gKB", bytes/1024);
00134                 else
00135                     p += sprintf(p, "%.3gMB", bytes/1024/1024);
00136                 break;
00137 
00138             case 'p': <span class="comment">// current packet/sec</span>
00139                 p += sprintf(p, "%.3gpps", currentPkPerSec);
00140                 break;
00141             case 'b': <span class="comment">// current bandwidth</span>
00142                 if (currentBitPerSec&lt;1000000)
00143                     p += sprintf(p, "%.3gk", currentBitPerSec/1000);
00144                 else
00145                     p += sprintf(p, "%.3gM", currentBitPerSec/1000000);
00146                 break;
00147             case 'u': <span class="comment">// current channel utilization (%)</span>
00148                 if (datarate()==0)
00149                     p += sprintf(p, "n/a");
00150                 else
00151                     p += sprintf(p, "%.3g%%", currentBitPerSec/datarate()*100.0);
00152                 break;
00153 
00154             case 'P': <span class="comment">// average packet/sec on [0,now)</span>
00155                 p += sprintf(p, "%.3gpps", tt==0 ? 0 : numPackets/tt);
00156                 break;
00157             case 'B': <span class="comment">// average bandwidth on [0,now)</span>
00158                 if (bps&lt;1000000)
00159                     p += sprintf(p, "%.3gk", bps/1000);
00160                 else
00161                     p += sprintf(p, "%.3gM", bps/1000000);
00162                 break;
00163             case 'U': <span class="comment">// average channel utilization (%) on [0,now)</span>
00164                 if (datarate()==0)
00165                     p += sprintf(p, "n/a");
00166                 else
00167                     p += sprintf(p, "%.3g%%", bps/datarate()*100.0);
00168                 break;
00169             default:
00170                 *p++ = *fp;
00171         }
00172     }
00173     *p = '\0';
00174 
00175     <span class="comment">// display label</span>
00176     fromGate()-&gt;displayString().setTagArg("t", 0, buf);
00177 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p1" doxytag="ThruputMeteringChannel::batchSize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned int <a class="el" href="class_thruput_metering_channel.html#p1">ThruputMeteringChannel::batchSize</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p9" doxytag="ThruputMeteringChannel::currentBitPerSec"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_thruput_metering_channel.html#p9">ThruputMeteringChannel::currentBitPerSec</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p10" doxytag="ThruputMeteringChannel::currentPkPerSec"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_thruput_metering_channel.html#p10">ThruputMeteringChannel::currentPkPerSec</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="ThruputMeteringChannel::fmtp"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cPar* <a class="el" href="class_thruput_metering_channel.html#p0">ThruputMeteringChannel::fmtp</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p6" doxytag="ThruputMeteringChannel::intvlLastPkTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t <a class="el" href="class_thruput_metering_channel.html#p6">ThruputMeteringChannel::intvlLastPkTime</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p8" doxytag="ThruputMeteringChannel::intvlNumBits"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned long <a class="el" href="class_thruput_metering_channel.html#p8">ThruputMeteringChannel::intvlNumBits</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p7" doxytag="ThruputMeteringChannel::intvlNumPackets"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned long <a class="el" href="class_thruput_metering_channel.html#p7">ThruputMeteringChannel::intvlNumPackets</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p5" doxytag="ThruputMeteringChannel::intvlStartTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t <a class="el" href="class_thruput_metering_channel.html#p5">ThruputMeteringChannel::intvlStartTime</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p2" doxytag="ThruputMeteringChannel::maxInterval"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_thruput_metering_channel.html#p2">ThruputMeteringChannel::maxInterval</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p4" doxytag="ThruputMeteringChannel::numBits"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_thruput_metering_channel.html#p4">ThruputMeteringChannel::numBits</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="ThruputMeteringChannel::numPackets"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_thruput_metering_channel.html#p3">ThruputMeteringChannel::numPackets</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_thruput_metering_channel_8h.html">ThruputMeteringChannel.h</a><li><a class="el" href="_thruput_metering_channel_8cc.html">ThruputMeteringChannel.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:32 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
