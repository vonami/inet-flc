<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: AbstractRadio Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>AbstractRadio Class Reference</h1><code>#include &lt;AbstractRadio.h&gt;</code>
<p>
<p>Inheritance diagram for AbstractRadio:
<p><center><img src="class_abstract_radio.png" usemap="#AbstractRadio_map" border="0" alt=""></center>
<map name="AbstractRadio_map">
<area href="class_channel_access.html" alt="ChannelAccess" shape="rect" coords="56,112,159,136">
<area href="class_basic_module.html" alt="BasicModule" shape="rect" coords="56,56,159,80">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="56,0,159,24">
<area href="class_generic_radio.html" alt="GenericRadio" shape="rect" coords="0,224,103,248">
<area href="class_ieee80211_radio.html" alt="Ieee80211Radio" shape="rect" coords="113,224,216,248">
</map>
<a href="class_abstract_radio-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Abstract base class for radio modules. Radio modules deal with the transmission of frames over a wireless medium (the radio channel). See the Radio module's NED documentation for an overview of radio modules.<p>
This class implements common functionality of the radio, and abstracts out specific parts into two interfaces, <a class="el" href="class_i_reception_model.html">IReceptionModel</a> and <a class="el" href="class_i_radio_model.html">IRadioModel</a>. The reception model is responsible for modelling path loss, interference and antenna gain. The radio model is responsible for calculating frame duration, and modelling modulation scheme and possible forward error correction. Subclasses have to redefine the <code><a class="el" href="class_abstract_radio.html#b19">createReceptionModel()</a></code> and <code><a class="el" href="class_abstract_radio.html#b20">createRadioModel()</a></code> methods to create and return appropriate reception model and radio model objects.<p>
<b>History</b><p>
The implementation is largely based on the Mobility Framework's <a class="el" href="class_snr_eval.html">SnrEval</a> and Decider modules. They have been merged into a single module, multi-channel support, runtime channel and bitrate switching capability added, and all code specific to the physical channel and radio characteristics have been factored out into the <a class="el" href="class_i_reception_model.html">IReceptionModel</a> and <a class="el" href="class_i_radio_model.html">IRadioModel</a> classes.<p>
<dl compact><dt><b>Author:</b></dt><dd>Andras Varga, Levente Meszaros </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#a0">AbstractRadio</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#a1">~AbstractRadio</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::map&lt; <a class="el" href="class_air_frame.html">AirFrame</a> *,<br>
 double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#x0">RecvBuff</a></td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b0">initialize</a> (int stage)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register with <a class="el" href="class_channel_control.html">ChannelControl</a> and subscribe to hostPos.  <a href="#b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b1">finish</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b2">handleMessage</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b3">handleUpperMsg</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b4">handleSelfMsg</a> (cMessage *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b5">handleCommand</a> (int msgkind, cPolymorphic *ctrl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b6">handleLowerMsgStart</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffer the frame and update noise levels and snr information.  <a href="#b6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b7">handleLowerMsgEnd</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unbuffer the frame and update noise levels and snr information.  <a href="#b7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b8">bufferMsg</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffers message for 'transmission time'.  <a href="#b8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b9">unbufferMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unbuffers a message after 'transmission time'.  <a href="#b9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b10">sendUp</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b11">sendDown</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *airframe)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b12">encapsulatePacket</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b13">setRadioState</a> (<a class="el" href="class_radio_state.html#w4">RadioState::State</a> newState)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b14">channelNumber</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b15">addNewSnr</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b16">createAirFrame</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b17">changeChannel</a> (int channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b18">setBitrate</a> (double bitrate)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_i_reception_model.html">IReceptionModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b19">createReceptionModel</a> ()=0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_i_radio_model.html">IRadioModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#b20">createRadioModel</a> ()=0</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_radio_model.html">IRadioModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p0">radioModel</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_reception_model.html">IReceptionModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p1">receptionModel</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p2">transmitterPower</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_abstract_radio_1_1_snr_struct.html">SnrStruct</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p3">snrInfo</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_abstract_radio.html#x0">RecvBuff</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p4">recvBuff</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_radio_state.html">RadioState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p5">rs</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p6">newChannel</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p7">newBitrate</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p8">noiseLevel</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p9">carrierFrequency</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p10">thermalNoise</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#p11">sensitivity</a></td></tr>

<tr><td colspan="2"><div class="groupHeader">Gate Ids</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#z125_0">uppergateOut</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_abstract_radio.html#z125_1">uppergateIn</a></td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_abstract_radio_1_1_snr_struct.html">SnrStruct</a></td></tr>

</table>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="x0" doxytag="AbstractRadio::RecvBuff"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef std::map&lt;<a class="el" href="class_air_frame.html">AirFrame</a>*,double&gt; <a class="el" href="class_abstract_radio.html#x0">AbstractRadio::RecvBuff</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Typedef used to store received messages together with receive power.     </td>
  </tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="AbstractRadio::AbstractRadio"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AbstractRadio::AbstractRadio           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00031                              : <a class="code" href="class_abstract_radio.html#p5">rs</a>(this-&gt;id())
00032 {
00033     <a class="code" href="class_abstract_radio.html#p0">radioModel</a> = NULL;
00034     <a class="code" href="class_abstract_radio.html#p1">receptionModel</a> = NULL;
00035 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="AbstractRadio::~AbstractRadio"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AbstractRadio::~<a class="el" href="class_abstract_radio.html">AbstractRadio</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00106 {
00107     <span class="keyword">delete</span> <a class="code" href="class_abstract_radio.html#p0">radioModel</a>;
00108     <span class="keyword">delete</span> <a class="code" href="class_abstract_radio.html#p1">receptionModel</a>;
00109 
00110     <span class="comment">// delete messages being received</span>
00111     <span class="keywordflow">for</span> (RecvBuff::iterator it = <a class="code" href="class_abstract_radio.html#p4">recvBuff</a>.begin(); it!=<a class="code" href="class_abstract_radio.html#p4">recvBuff</a>.end(); ++it)
00112         <span class="keyword">delete</span> it-&gt;first;
00113 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b15" doxytag="AbstractRadio::addNewSnr"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::addNewSnr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Updates the SNR information of the relevant <a class="el" href="class_air_frame.html">AirFrame</a> <div class="fragment"><pre class="fragment">00530 {
00531     <a class="code" href="struct_snr_list_entry.html">SnrListEntry</a> listEntry;     <span class="comment">// create a new entry</span>
00532     listEntry.<a class="code" href="struct_snr_list_entry.html#o0">time</a> = simTime();
00533     listEntry.<a class="code" href="struct_snr_list_entry.html#o1">snr</a> = <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o1">rcvdPower</a> / <a class="code" href="class_abstract_radio.html#p8">noiseLevel</a>;
00534     <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o2">sList</a>.push_back(listEntry);
00535 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b8" doxytag="AbstractRadio::bufferMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::bufferMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Buffers message for 'transmission time'. 
<p>
The packet is put in a buffer for the time the transmission would last in reality. A timer indicates when the transmission is complete. So, look at unbufferMsg to see what happens when the transmission is complete.. <div class="fragment"><pre class="fragment">00172                                                        : add <span class="keyword">explicit</span> simtime_t atTime arg?
00173 {
00174     <span class="comment">// set timer to indicate transmission is complete</span>
00175     cMessage *endRxTimer = <span class="keyword">new</span> cMessage(<span class="stringliteral">"endRx"</span>, MK_RECEPTION_COMPLETE);
00176     endRxTimer-&gt;setContextPointer(airframe);
00177     airframe-&gt;setContextPointer(endRxTimer);
00178 
00179     <span class="comment">// NOTE: use arrivalTime instead of simTime, because we might be calling this</span>
00180     <span class="comment">// function during a channel change, when we're picking up ongoing transmissions</span>
00181     <span class="comment">// on the channel -- and then the message's arrival time is in the past!</span>
00182     scheduleAt(airframe-&gt;arrivalTime() + airframe-&gt;<a class="code" href="class_air_frame.html#a11">getDuration</a>(), endRxTimer);
00183 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b17" doxytag="AbstractRadio::changeChannel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::changeChannel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>channel</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Change transmitter and receiver to a new channel. This method throws an error if the radio state is transmit. Messages that are already sent to the new channel and would reach us in the future - thus they are on the air - will be received correctly. <div class="fragment"><pre class="fragment">00538 {
00539     <span class="keywordflow">if</span> (channel == <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a4">getChannelNumber</a>())
00540         <span class="keywordflow">return</span>;
00541     <span class="keywordflow">if</span> (channel &lt; 0 || channel &gt;= <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;<a class="code" href="class_channel_control.html#a12">getNumChannels</a>())
00542         error(<span class="stringliteral">"changeChannel(): channel number %d is out of range (hint: numChannels is a parameter of ChannelControl)"</span>, channel);
00543     <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">getState</a>() == <a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a>)
00544         error(<span class="stringliteral">"changing channel while transmitting is not allowed"</span>);
00545 
00546     <span class="comment">// if we are currently receiving, must clean that up before moving to different channel</span>
00547     <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">getState</a>() == <a class="code" href="class_radio_state.html#w4w1">RadioState::RECV</a>)
00548     {
00549         <span class="comment">// delete messages being received, and cancel associated self-messages</span>
00550         <span class="keywordflow">for</span> (RecvBuff::iterator it = <a class="code" href="class_abstract_radio.html#p4">recvBuff</a>.begin(); it!=<a class="code" href="class_abstract_radio.html#p4">recvBuff</a>.end(); ++it)
00551         {
00552             <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = it-&gt;first;
00553             cMessage *endRxTimer = (cMessage *)airframe-&gt;contextPointer();
00554             <span class="keyword">delete</span> airframe;
00555             <span class="keyword">delete</span> cancelEvent(endRxTimer);
00556         }
00557         <a class="code" href="class_abstract_radio.html#p4">recvBuff</a>.clear();
00558     }
00559 
00560     <span class="comment">// clear snr info</span>
00561     <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> = NULL;
00562     <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o2">sList</a>.clear();
00563 
00564     <span class="comment">// do channel switch</span>
00565     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Changing to channel #"</span> &lt;&lt; channel &lt;&lt; <span class="stringliteral">"\n"</span>;
00566 
00567     <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a5">setChannelNumber</a>(channel);
00568     <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;<a class="code" href="class_channel_control.html#a5">updateHostChannel</a>(myHostRef, channel);
00569     <a class="code" href="class_channel_control.html#w2">ChannelControl::TransmissionList</a> tl = <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;<a class="code" href="class_channel_control.html#a6">getOngoingTransmissions</a>(channel);
00570 
00571     cModule *myHost = <a class="code" href="class_basic_module.html#b0">findHost</a>();
00572     cGate *radioGate = myHost-&gt;gate(<span class="stringliteral">"radioIn"</span>);
00573 
00574     <span class="comment">// pick up ongoing transmissions on the new channel</span>
00575     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Picking up ongoing transmissions on new channel:\n"</span>;
00576     <span class="keywordflow">for</span> (ChannelControl::TransmissionList::const_iterator it = tl.begin(); it != tl.end(); ++it)
00577     {
00578         <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = *it;
00579         <span class="comment">// time for the message to reach us</span>
00580         <span class="keywordtype">double</span> distance = <a class="code" href="class_channel_access.html#p1">myHostRef</a>-&gt;<a class="code" href="struct_channel_control_1_1_host_entry.html#o1">pos</a>.<a class="code" href="class_coord.html#a7">distance</a>(airframe-&gt;<a class="code" href="class_air_frame.html#a15">getSenderPos</a>());
00581         <span class="keywordtype">double</span> propagationDelay = distance / <a class="code" href="_channel_control_8h.html#a0">LIGHT_SPEED</a>;
00582 
00583         <span class="comment">// if this transmission is on our new channel and it would reach us in the future, then schedule it</span>
00584         <span class="keywordflow">if</span> (channel == airframe-&gt;<a class="code" href="class_air_frame.html#a9">getChannelNumber</a>())
00585         {
00586             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">" - ("</span> &lt;&lt; airframe-&gt;className() &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; airframe-&gt;name() &lt;&lt; <span class="stringliteral">": "</span>;
00587 
00588             <span class="comment">// if there is a message on the air which will reach us in the future</span>
00589             <span class="keywordflow">if</span> (airframe-&gt;timestamp() + propagationDelay &gt;= simTime())
00590             {
00591                  <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"will arrive in the future, scheduling it\n"</span>;
00592 
00593                  <span class="comment">// we need to send to each radioIn[] gate of this host</span>
00594                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; radioGate-&gt;size(); i++)
00595                      sendDirect((cMessage*)airframe-&gt;dup(), airframe-&gt;timestamp() + propagationDelay - simTime(), myHost, radioGate-&gt;<span class="keywordtype">id</span>() + i);
00596             }
00597             <span class="comment">// if we hear some part of the message</span>
00598             else if (airframe-&gt;timestamp() + airframe-&gt;getDuration() + propagationDelay &gt; simTime())
00599             {
00600                  <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"missed beginning of frame, processing it as noise\n"</span>;
00601 
00602                  <a class="code" href="class_air_frame.html">AirFrame</a> *frameDup = (<a class="code" href="class_air_frame.html">AirFrame</a>*)airframe-&gt;<a class="code" href="class_air_frame.html#a4">dup</a>();
00603                  frameDup-&gt;setArrivalTime(airframe-&gt;timestamp() + propagationDelay);
00604                  <a class="code" href="class_abstract_radio.html#b6">handleLowerMsgStart</a>(frameDup);
00605                  <a class="code" href="class_abstract_radio.html#b8">bufferMsg</a>(frameDup);
00606             }
00607             <span class="keywordflow">else</span>
00608             {
00609                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"in the past\n"</span>;
00610             }
00611         }
00612     }
00613 
00614     <span class="comment">// notify other modules about the channel switch; and actually, radio state has changed too</span>
00615     <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIO_CHANNEL_CHANGED, &amp;rs);
00616     <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00617 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b14" doxytag="AbstractRadio::channelNumber"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual int AbstractRadio::channelNumber           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the current channel the radio is tuned to <div class="fragment"><pre class="fragment">00100 {<span class="keywordflow">return</span> <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a4">getChannelNumber</a>();}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b16" doxytag="AbstractRadio::createAirFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual <a class="el" href="class_air_frame.html">AirFrame</a>* AbstractRadio::createAirFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a new <a class="el" href="class_air_frame.html">AirFrame</a> <div class="fragment"><pre class="fragment">00106 {<span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_air_frame.html">AirFrame</a>();}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b20" doxytag="AbstractRadio::createRadioModel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual <a class="el" href="class_i_radio_model.html">IRadioModel</a>* AbstractRadio::createRadioModel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
To be defined to provide a radio model. The radio model is responsible for calculating frame duration, and modelling modulation scheme and possible forward error correction. 
<p>
Implemented in <a class="el" href="class_generic_radio.html#b1">GenericRadio</a>, and <a class="el" href="class_ieee80211_radio.html#b1">Ieee80211Radio</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b19" doxytag="AbstractRadio::createReceptionModel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual <a class="el" href="class_i_reception_model.html">IReceptionModel</a>* AbstractRadio::createReceptionModel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
To be defined to provide a reception model. The reception model is responsible for modelling path loss, interference and antenna gain. 
<p>
Implemented in <a class="el" href="class_generic_radio.html#b0">GenericRadio</a>, and <a class="el" href="class_ieee80211_radio.html#b0">Ieee80211Radio</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b12" doxytag="AbstractRadio::encapsulatePacket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> * AbstractRadio::encapsulatePacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Encapsulates a MAC frame into an Air Frame <div class="fragment"><pre class="fragment">00186 {
00187     <a class="code" href="class_phy_control_info.html">PhyControlInfo</a> *ctrl = dynamic_cast&lt;PhyControlInfo *&gt;(frame-&gt;removeControlInfo());
00188     ASSERT(!ctrl || ctrl-&gt;<a class="code" href="class_phy_control_info.html#a6">channelNumber</a>()==-1); <span class="comment">// per-packet channel switching not supported</span>
00189 
00190     <span class="comment">// Note: we don't set length() of the AirFrame, because duration will be used everywhere instead</span>
00191     <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = <a class="code" href="class_abstract_radio.html#b16">createAirFrame</a>();
00192     airframe-&gt;setName(frame-&gt;name());
00193     airframe-&gt;<a class="code" href="class_air_frame.html#a8">setPSend</a>(transmitterPower);
00194     airframe-&gt;<a class="code" href="class_air_frame.html#a10">setChannelNumber</a>(<a class="code" href="class_abstract_radio.html#b14">channelNumber</a>());
00195     airframe-&gt;encapsulate(frame);
00196     airframe-&gt;<a class="code" href="class_air_frame.html#a14">setBitrate</a>(ctrl ? ctrl-&gt;<a class="code" href="class_phy_control_info.html#a8">bitrate</a>() : <a class="code" href="class_abstract_radio.html#p5">rs</a>.getBitrate());
00197     airframe-&gt;<a class="code" href="class_air_frame.html#a12">setDuration</a>(<a class="code" href="class_abstract_radio.html#p0">radioModel</a>-&gt;<a class="code" href="class_i_radio_model.html#a2">calculateDuration</a>(airframe));
00198     airframe-&gt;<a class="code" href="class_air_frame.html#a17">setSenderPos</a>(<a class="code" href="class_channel_access.html#b1">myPosition</a>());
00199     <span class="keyword">delete</span> ctrl;
00200 
00201     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Frame ("</span> &lt;&lt; frame-&gt;className() &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; frame-&gt;name()
00202        &lt;&lt; <span class="stringliteral">" will be transmitted at "</span> &lt;&lt; (airframe-&gt;<a class="code" href="class_air_frame.html#a13">getBitrate</a>()/1e6) &lt;&lt; <span class="stringliteral">"Mbps\n"</span>;
00203     <span class="keywordflow">return</span> airframe;
00204 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="AbstractRadio::finish"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::finish           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00102 {
00103 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="AbstractRadio::handleCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::handleCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>msgkind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>cPolymorphic *&nbsp;</td>
          <td class="mdname" nowrap> <em>ctrl</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00278 {
00279     <span class="keywordflow">if</span> (msgkind==PHY_C_CONFIGURERADIO)
00280     {
00281         <span class="comment">// extract new channel number</span>
00282         <a class="code" href="class_phy_control_info.html">PhyControlInfo</a> *phyCtrl = check_and_cast&lt;PhyControlInfo *&gt;(ctrl);
00283         <span class="keywordtype">int</span> <a class="code" href="class_abstract_radio.html#p6">newChannel</a> = phyCtrl-&gt;<a class="code" href="class_phy_control_info.html#a6">channelNumber</a>();
00284         <span class="keywordtype">double</span> <a class="code" href="class_abstract_radio.html#p7">newBitrate</a> = phyCtrl-&gt;<a class="code" href="class_phy_control_info.html#a8">bitrate</a>();
00285         <span class="keyword">delete</span> ctrl;
00286 
00287         <span class="keywordflow">if</span> (newChannel!=-1)
00288         {
00289             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Command received: change to channel #"</span> &lt;&lt; newChannel &lt;&lt; <span class="stringliteral">"\n"</span>;
00290 
00291             <span class="comment">// do it</span>
00292             <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a4">getChannelNumber</a>()==newChannel)
00293                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Right on that channel, nothing to do\n"</span>; <span class="comment">// fine, nothing to do</span>
00294             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">getState</a>()==<a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a>) {
00295                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"We're transmitting right now, remembering to change after it's completed\n"</span>;
00296                 this-&gt;newChannel = newChannel;
00297             } <span class="keywordflow">else</span>
00298                 <a class="code" href="class_abstract_radio.html#b17">changeChannel</a>(newChannel); <span class="comment">// change channel right now</span>
00299         }
00300         <span class="keywordflow">if</span> (newBitrate!=-1)
00301         {
00302             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Command received: change bitrate to "</span> &lt;&lt; (newBitrate/1e6) &lt;&lt; <span class="stringliteral">"Mbps\n"</span>;
00303 
00304             <span class="comment">// do it</span>
00305             <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a6">getBitrate</a>()==newBitrate)
00306                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Right at that bitrate, nothing to do\n"</span>; <span class="comment">// fine, nothing to do</span>
00307             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">getState</a>()==<a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a>) {
00308                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"We're transmitting right now, remembering to change after it's completed\n"</span>;
00309                 this-&gt;newBitrate = newBitrate;
00310             } <span class="keywordflow">else</span>
00311                 <a class="code" href="class_abstract_radio.html#b18">setBitrate</a>(newBitrate); <span class="comment">// change bitrate right now</span>
00312         }
00313     }
00314     <span class="keywordflow">else</span>
00315     {
00316         error(<span class="stringliteral">"unknown command (msgkind=%d)"</span>, msgkind);
00317     }
00318 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="AbstractRadio::handleLowerMsgEnd"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::handleLowerMsgEnd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unbuffer the frame and update noise levels and snr information. 
<p>
This function is called right after the transmission is over, i.e. right after unbuffering. The noise level of the channel and the snr information of the buffered messages have to be updated.<p>
Additionally the <a class="el" href="class_radio_state.html">RadioState</a> has to be updated.<p>
If the corresponding <a class="el" href="class_air_frame.html">AirFrame</a> was not only noise the corresponding SnrList and the <a class="el" href="class_air_frame.html">AirFrame</a> are sent to the decider. <div class="fragment"><pre class="fragment">00467 {
00468     <span class="comment">// check if message has to be send to the decider</span>
00469     <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> == airframe)
00470     {
00471         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"reception of frame over, preparing to send packet to upper layer\n"</span>;
00472         <span class="comment">// get Packet and list out of the receive buffer:</span>
00473         <a class="code" href="_snr_list_8h.html#a0">SnrList</a> list;
00474         list = <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o2">sList</a>;
00475 
00476         <span class="comment">// delete the pointer to indicate that no message is currently</span>
00477         <span class="comment">// being received and clear the list</span>
00478         <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> = NULL;
00479         <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o2">sList</a>.clear();
00480 
00481         <span class="comment">// delete the frame from the recvBuff</span>
00482         <a class="code" href="class_abstract_radio.html#p4">recvBuff</a>.erase(airframe);
00483 
00484         <span class="comment">//XXX send up the frame:</span>
00485         <span class="comment">//if (radioModel-&gt;isReceivedCorrectly(airframe, list))</span>
00486         <span class="comment">//    sendUp(airframe);</span>
00487         <span class="comment">//else</span>
00488         <span class="comment">//    delete airframe;</span>
00489         <span class="keywordflow">if</span> (!<a class="code" href="class_abstract_radio.html#p0">radioModel</a>-&gt;<a class="code" href="class_i_radio_model.html#a3">isReceivedCorrectly</a>(airframe, list))
00490         {
00491             airframe-&gt;encapsulatedMsg()-&gt;setKind(list.size()&gt;1 ? <a class="code" href="_ieee80211_consts_8h.html#a1">COLLISION</a> : <a class="code" href="_ieee80211_consts_8h.html#a0">BITERROR</a>);
00492             airframe-&gt;setName(list.size()&gt;1 ? <span class="stringliteral">"COLLISION"</span> : <span class="stringliteral">"BITERROR"</span>);
00493         }
00494         <a class="code" href="class_abstract_radio.html#b10">sendUp</a>(airframe);
00495     }
00496     <span class="comment">// all other messages are noise</span>
00497     <span class="keywordflow">else</span>
00498     {
00499         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"reception of noise message over, removing recvdPower from noiseLevel....\n"</span>;
00500         <span class="comment">// get the rcvdPower and subtract it from the noiseLevel</span>
00501         <a class="code" href="class_abstract_radio.html#p8">noiseLevel</a> -= <a class="code" href="class_abstract_radio.html#p4">recvBuff</a>[airframe];
00502 
00503         <span class="comment">// delete message from the recvBuff</span>
00504         <a class="code" href="class_abstract_radio.html#p4">recvBuff</a>.erase(airframe);
00505 
00506         <span class="comment">// update snr info for message currently being received if any</span>
00507         <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> != NULL)
00508         {
00509             <a class="code" href="class_abstract_radio.html#b15">addNewSnr</a>();
00510         }
00511 
00512         <span class="comment">// message should be deleted</span>
00513         <span class="keyword">delete</span> airframe;
00514         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"message deleted\n"</span>;
00515     }
00516 
00517     <span class="comment">// check the RadioState and update if necessary</span>
00518     <span class="comment">// change to idle if noiseLevel smaller than threshold and state was</span>
00519     <span class="comment">// not idle before</span>
00520     <span class="comment">// do not change state if currently sending or receiving a message!!!</span>
00521     <span class="keywordflow">if</span> (noiseLevel &lt; sensitivity &amp;&amp; <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">getState</a>() == <a class="code" href="class_radio_state.html#w4w1">RadioState::RECV</a> &amp;&amp; <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> == NULL)
00522     {
00523         <span class="comment">// publish the new RadioState:</span>
00524         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"new RadioState is IDLE\n"</span>;
00525         <a class="code" href="class_abstract_radio.html#b13">setRadioState</a>(RadioState::IDLE);
00526     }
00527 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b6" doxytag="AbstractRadio::handleLowerMsgStart"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::handleLowerMsgStart           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Buffer the frame and update noise levels and snr information. 
<p>
This function is called right after a packet arrived, i.e. right before it is buffered for 'transmission time'.<p>
First the receive power of the packet has to be calculated and is stored in the recvBuff. Afterwards it has to be decided whether the packet is just noise or a "real" packet that needs to be received.<p>
The message is not treated as noise if all of the following conditions apply:<p>
<ol type=1>
<li>the power of the received signal is higher than the sensitivity.</li><li>the host is currently not sending a message</li><li>no other packet is already being received</li></ol>
<p>
If all conditions apply a new SnrList is created and the <a class="el" href="class_radio_state.html">RadioState</a> is changed to RECV.<p>
If the packet is just noise the receive power is added to the noise Level of the channel. Additionally the snr information of the currently being received message (if any) has to be updated as well as the <a class="el" href="class_radio_state.html">RadioState</a>. <div class="fragment"><pre class="fragment">00391 {
00392     <span class="comment">// Calculate the receive power of the message</span>
00393 
00394     <span class="comment">// calculate distance</span>
00395     <span class="keyword">const</span> <a class="code" href="class_coord.html">Coord</a>&amp; myPos = <a class="code" href="class_channel_access.html#b1">myPosition</a>();
00396     <span class="keyword">const</span> <a class="code" href="class_coord.html">Coord</a>&amp; framePos = airframe-&gt;<a class="code" href="class_air_frame.html#a15">getSenderPos</a>();
00397     <span class="keywordtype">double</span> distance = myPos.<a class="code" href="class_coord.html#a7">distance</a>(framePos);
00398 
00399     <span class="comment">// calculate receive power</span>
00400     <span class="keywordtype">double</span> rcvdPower = <a class="code" href="class_abstract_radio.html#p1">receptionModel</a>-&gt;<a class="code" href="class_i_reception_model.html#a1">calculateReceivedPower</a>(airframe-&gt;<a class="code" href="class_air_frame.html#a7">getPSend</a>(), <a class="code" href="class_abstract_radio.html#p9">carrierFrequency</a>, distance);
00401 
00402     <span class="comment">// store the receive power in the recvBuff</span>
00403     <a class="code" href="class_abstract_radio.html#p4">recvBuff</a>[airframe] = rcvdPower;
00404 
00405     <span class="comment">// if receive power is bigger than sensitivity and if not sending</span>
00406     <span class="comment">// and currently not receiving another message and the message has</span>
00407     <span class="comment">// arrived in time</span>
00408     <span class="comment">// NOTE: a message may have arrival time in the past here when we are</span>
00409     <span class="comment">// processing ongoing transmissions during a channel change</span>
00410     <span class="keywordflow">if</span> (airframe-&gt;arrivalTime() == simTime() &amp;&amp; rcvdPower &gt;= <a class="code" href="class_abstract_radio.html#p11">sensitivity</a> &amp;&amp; <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">getState</a>() != <a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a> &amp;&amp; <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> == NULL)
00411     {
00412         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"receiving frame "</span> &lt;&lt; airframe-&gt;name() &lt;&lt; endl;
00413 
00414         <span class="comment">// Put frame and related SnrList in receive buffer</span>
00415         <a class="code" href="_snr_list_8h.html#a0">SnrList</a> snrList;
00416         <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> = airframe;
00417         <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o1">rcvdPower</a> = rcvdPower;
00418         <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o2">sList</a> = snrList;
00419 
00420         <span class="comment">// add initial snr value</span>
00421         <a class="code" href="class_abstract_radio.html#b15">addNewSnr</a>();
00422 
00423         <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">getState</a>() != <a class="code" href="class_radio_state.html#w4w1">RadioState::RECV</a>)
00424         {
00425             <span class="comment">// publish new RadioState</span>
00426             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"publish new RadioState:RECV\n"</span>;
00427             <a class="code" href="class_abstract_radio.html#b13">setRadioState</a>(RadioState::RECV);
00428         }
00429     }
00430     <span class="comment">// receive power is too low or another message is being sent or received</span>
00431     <span class="keywordflow">else</span>
00432     {
00433         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"frame "</span> &lt;&lt; airframe-&gt;name() &lt;&lt; <span class="stringliteral">" is just noise\n"</span>;
00434         <span class="comment">//add receive power to the noise level</span>
00435         <a class="code" href="class_abstract_radio.html#p8">noiseLevel</a> += rcvdPower;
00436 
00437         <span class="comment">// if a message is being received add a new snr value</span>
00438         <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> != NULL)
00439         {
00440             <span class="comment">// update snr info for currently being received message</span>
00441             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"adding new snr value to snr list of message being received\n"</span>;
00442             <a class="code" href="class_abstract_radio.html#b15">addNewSnr</a>();
00443         }
00444 
00445         <span class="comment">// update the RadioState if the noiseLevel exceeded the threshold</span>
00446         <span class="comment">// and the radio is currently not in receive or in send mode</span>
00447         <span class="keywordflow">if</span> (noiseLevel &gt;= sensitivity &amp;&amp; <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">getState</a>() == <a class="code" href="class_radio_state.html#w4w0">RadioState::IDLE</a>)
00448         {
00449             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"setting radio state to RECV\n"</span>;
00450             <a class="code" href="class_abstract_radio.html#b13">setRadioState</a>(RadioState::RECV);
00451         }
00452     }
00453 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="AbstractRadio::handleMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::handleMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The basic handle message function.<p>
Depending on the gate a message arrives handleMessage just calls different handle*Msg functions to further process the message.<p>
Messages from the channel are also buffered here in order to simulate a transmission delay<p>
You should not make any changes in this function but implement all your functionality into the handle*Msg functions called from here.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_abstract_radio.html#b3">handleUpperMsg</a>, <a class="el" href="class_abstract_radio.html#b6">handleLowerMsgStart</a>, <a class="el" href="class_abstract_radio.html#b7">handleLowerMsgEnd</a>, <a class="el" href="class_abstract_radio.html#b4">handleSelfMsg</a> </dd></dl>
<div class="fragment"><pre class="fragment">00131 {
00132     <span class="comment">// handle commands</span>
00133     <span class="keywordflow">if</span> (msg-&gt;arrivalGateId()==<a class="code" href="class_abstract_radio.html#z125_1">uppergateIn</a> &amp;&amp; msg-&gt;length()==0)
00134     {
00135         cPolymorphic *ctrl = msg-&gt;removeControlInfo();
00136         <span class="keywordflow">if</span> (msg-&gt;kind()==0)
00137             error(<span class="stringliteral">"Message '%s' with length==0 is supposed to be a command, but msg kind is also zero"</span>, msg-&gt;name());
00138         <a class="code" href="class_abstract_radio.html#b5">handleCommand</a>(msg-&gt;kind(), ctrl);
00139         <span class="keyword">delete</span> msg;
00140         <span class="keywordflow">return</span>;
00141     }
00142 
00143     <span class="keywordflow">if</span> (msg-&gt;arrivalGateId() == <a class="code" href="class_abstract_radio.html#z125_1">uppergateIn</a>)
00144     {
00145         <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = <a class="code" href="class_abstract_radio.html#b12">encapsulatePacket</a>(msg);
00146         <a class="code" href="class_abstract_radio.html#b3">handleUpperMsg</a>(airframe);
00147     }
00148     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;isSelfMessage())
00149     {
00150         <a class="code" href="class_abstract_radio.html#b4">handleSelfMsg</a>(msg);
00151     }
00152     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (check_and_cast&lt;AirFrame *&gt;(msg)-&gt;getChannelNumber() == <a class="code" href="class_abstract_radio.html#b14">channelNumber</a>())
00153     {
00154         <span class="comment">// must be an AirFrame</span>
00155         <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = (<a class="code" href="class_air_frame.html">AirFrame</a> *) msg;
00156         <a class="code" href="class_abstract_radio.html#b6">handleLowerMsgStart</a>(airframe);
00157         <a class="code" href="class_abstract_radio.html#b8">bufferMsg</a>(airframe);
00158     }
00159     <span class="keywordflow">else</span>
00160     {
00161         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"listening to different channel when receiving message -- dropping it\n"</span>;
00162         <span class="keyword">delete</span> msg;
00163     }
00164 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="AbstractRadio::handleSelfMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::handleSelfMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00321 {
00322     <span class="keywordflow">if</span> (msg-&gt;kind()==<a class="code" href="_abstract_radio_8cc.html#a1">MK_RECEPTION_COMPLETE</a>)
00323     {
00324         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"frame is completely received now\n"</span>;
00325 
00326         <span class="comment">// unbuffer the message</span>
00327         <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = <a class="code" href="class_abstract_radio.html#b9">unbufferMsg</a>(msg);
00328 
00329         <a class="code" href="class_abstract_radio.html#b7">handleLowerMsgEnd</a>(airframe);
00330     }
00331     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;kind() == <a class="code" href="_abstract_radio_8cc.html#a0">MK_TRANSMISSION_OVER</a>)
00332     {
00333         <span class="comment">// Transmission has completed. The RadioState has to be changed</span>
00334         <span class="comment">// to IDLE or RECV, based on the noise level on the channel.</span>
00335         <span class="comment">// If the noise level is bigger than the sensitivity switch to receive mode,</span>
00336         <span class="comment">// otherwise to idle mode.</span>
00337         <span class="keywordflow">if</span> (noiseLevel &lt; sensitivity)
00338         {
00339             <span class="comment">// set the RadioState to IDLE</span>
00340             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"transmission over, switch to idle mode (state:IDLE)\n"</span>;
00341             <a class="code" href="class_abstract_radio.html#b13">setRadioState</a>(RadioState::IDLE);
00342         }
00343         <span class="keywordflow">else</span>
00344         {
00345             <span class="comment">// set the RadioState to RECV</span>
00346             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"transmission over but noise level too high, switch to recv mode (state:RECV)\n"</span>;
00347             <a class="code" href="class_abstract_radio.html#b13">setRadioState</a>(RadioState::RECV);
00348         }
00349 
00350         <span class="comment">// delete the timer</span>
00351         <span class="keyword">delete</span> msg;
00352 
00353         <span class="comment">// switch channel if it needs be</span>
00354         <span class="keywordflow">if</span> (newChannel!=-1)
00355         {
00356             <a class="code" href="class_abstract_radio.html#b17">changeChannel</a>(newChannel);
00357             <a class="code" href="class_abstract_radio.html#p6">newChannel</a> = -1;
00358         }
00359     }
00360     <span class="keywordflow">else</span>
00361     {
00362         error(<span class="stringliteral">"Internal error: unknown self-message `%s'"</span>, msg-&gt;name());
00363     }
00364 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="AbstractRadio::handleUpperMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::handleUpperMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
If a message is already being transmitted, an error is raised.<p>
Otherwise the <a class="el" href="class_radio_state.html">RadioState</a> is set to TRANSMIT and a timer is started. When this timer expires the <a class="el" href="class_radio_state.html">RadioState</a> will be set back to RECV (or IDLE respectively) again.<p>
If the host is receiving a packet this packet is from now on only considered as noise. <div class="fragment"><pre class="fragment">00243 {
00244     <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a2">getState</a>() == <a class="code" href="class_radio_state.html#w4w2">RadioState::TRANSMIT</a>)
00245         error(<span class="stringliteral">"Trying to send a message while already transmitting -- MAC should "</span>
00246               <span class="stringliteral">"take care this does not happen"</span>);
00247 
00248     <span class="comment">// if a packet was being received, it is corrupted now as should be treated as noise</span>
00249     <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> != NULL)
00250     {
00251         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Sending a message while receiving another. The received one is now corrupted.\n"</span>;
00252 
00253         <span class="comment">// remove the snr information stored for the message currently being</span>
00254         <span class="comment">// received. This message is treated as noise now and the</span>
00255         <span class="comment">// receive power has to be added to the noiseLevel</span>
00256 
00257         <span class="comment">// delete the pointer to indicate that no message is being received</span>
00258         <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> = NULL;
00259         <span class="comment">// clear the snr list</span>
00260         <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o2">sList</a>.clear();
00261         <span class="comment">// add the receive power to the noise level</span>
00262         <a class="code" href="class_abstract_radio.html#p8">noiseLevel</a> += <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o1">rcvdPower</a>;
00263     }
00264 
00265     <span class="comment">// now we are done with all the exception handling and can take care</span>
00266     <span class="comment">// about the "real" stuff</span>
00267 
00268     <span class="comment">// change radio status</span>
00269     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending, changing RadioState to TRANSMIT\n"</span>;
00270     <a class="code" href="class_abstract_radio.html#b13">setRadioState</a>(RadioState::TRANSMIT);
00271 
00272     cMessage *timer = <span class="keyword">new</span> cMessage(NULL, MK_TRANSMISSION_OVER);
00273     scheduleAt(simTime() + airframe-&gt;<a class="code" href="class_air_frame.html#a11">getDuration</a>(), timer);
00274     <a class="code" href="class_abstract_radio.html#b11">sendDown</a>(airframe);
00275 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="AbstractRadio::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>stage</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register with <a class="el" href="class_channel_control.html">ChannelControl</a> and subscribe to hostPos. 
<p>
Upon initialization <a class="el" href="class_channel_access.html">ChannelAccess</a> registers the nic parent module to have all its connections handled by <a class="el" href="class_channel_control.html">ChannelControl</a> 
<p>
Reimplemented from <a class="el" href="class_channel_access.html#b2">ChannelAccess</a>.<div class="fragment"><pre class="fragment">00038 {
00039     <a class="code" href="class_channel_access.html#b2">ChannelAccess::initialize</a>(stage);
00040 
00041     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Initializing AbstractRadio, stage="</span> &lt;&lt; stage &lt;&lt; endl;
00042 
00043     <span class="keywordflow">if</span> (stage == 0)
00044     {
00045         <a class="code" href="class_abstract_radio.html#z125_1">uppergateIn</a> = findGate(<span class="stringliteral">"uppergateIn"</span>);
00046         <a class="code" href="class_abstract_radio.html#z125_0">uppergateOut</a> = findGate(<span class="stringliteral">"uppergateOut"</span>);
00047 
00048         <span class="comment">// read parameters</span>
00049         <a class="code" href="class_abstract_radio.html#p2">transmitterPower</a> = par(<span class="stringliteral">"transmitterPower"</span>);
00050         <span class="keywordflow">if</span> (transmitterPower &gt; (<span class="keywordtype">double</span>) (<a class="code" href="class_channel_access.html#p0">cc</a>-&gt;par(<span class="stringliteral">"pMax"</span>)))
00051             error(<span class="stringliteral">"transmitterPower cannot be bigger than pMax in ChannelControl!"</span>);
00052         <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a7">setBitrate</a>(par(<span class="stringliteral">"bitrate"</span>));
00053         <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a5">setChannelNumber</a>(par(<span class="stringliteral">"channelNumber"</span>));
00054         <a class="code" href="class_abstract_radio.html#p10">thermalNoise</a> = <a class="code" href="class_f_w_math.html#e7">FWMath::dBm2mW</a>(par(<span class="stringliteral">"thermalNoise"</span>));
00055         <a class="code" href="class_abstract_radio.html#p9">carrierFrequency</a> = <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;par(<span class="stringliteral">"carrierFrequency"</span>);  <span class="comment">// taken from ChannelControl</span>
00056         <a class="code" href="class_abstract_radio.html#p11">sensitivity</a> = <a class="code" href="class_f_w_math.html#e7">FWMath::dBm2mW</a>(par(<span class="stringliteral">"sensitivity"</span>));
00057 
00058         <span class="comment">// initialize noiseLevel</span>
00059         <a class="code" href="class_abstract_radio.html#p8">noiseLevel</a> = <a class="code" href="class_abstract_radio.html#p10">thermalNoise</a>;
00060 
00061         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Initialized channel with noise: "</span> &lt;&lt; <a class="code" href="class_abstract_radio.html#p8">noiseLevel</a> &lt;&lt; <span class="stringliteral">" sensitivity: "</span> &lt;&lt; <a class="code" href="class_abstract_radio.html#p11">sensitivity</a> &lt;&lt;
00062             endl;
00063 
00064         <span class="comment">// initialize the pointer of the snrInfo with NULL to indicate</span>
00065         <span class="comment">// that currently no message is received</span>
00066         <a class="code" href="class_abstract_radio.html#p3">snrInfo</a>.<a class="code" href="struct_abstract_radio_1_1_snr_struct.html#o0">ptr</a> = NULL;
00067 
00068         <span class="comment">// no channel switch pending</span>
00069         <a class="code" href="class_abstract_radio.html#p6">newChannel</a> = -1;
00070 
00071         <span class="comment">// Initialize radio state. If thermal noise is already to high, radio</span>
00072         <span class="comment">// state has to be initialized as RECV</span>
00073         <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a3">setState</a>(RadioState::IDLE);
00074         <span class="keywordflow">if</span> (noiseLevel &gt;= sensitivity)
00075             rs.setState(<a class="code" href="class_radio_state.html">RadioState</a>::RECV);
00076 
00077         WATCH(noiseLevel);
00078         WATCH(rs);
00079 
00080         receptionModel = createReceptionModel();
00081         receptionModel-&gt;initializeFrom(this);
00082 
00083         radioModel = createRadioModel();
00084         radioModel-&gt;initializeFrom(this);
00085     }
00086     else if (stage == 1)
00087     {
00088         <span class="comment">// tell initial values to MAC; must be done in stage 1, because they</span>
00089         <span class="comment">// subscribe in stage 0</span>
00090         <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00091         <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIO_CHANNEL_CHANGED, &amp;rs);
00092     }
00093     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stage == 2)
00094     {
00095         <span class="comment">// tell initial channel number to ChannelControl; should be done in</span>
00096         <span class="comment">// stage==2 or later, because base class initializes myHostRef in that stage</span>
00097         <a class="code" href="class_channel_access.html#p0">cc</a>-&gt;<a class="code" href="class_channel_control.html#a5">updateHostChannel</a>(myHostRef, <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a4">getChannelNumber</a>());
00098     }
00099 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b11" doxytag="AbstractRadio::sendDown"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::sendDown           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to the channel <div class="fragment"><pre class="fragment">00215 {
00216     <a class="code" href="class_channel_access.html#b0">sendToChannel</a>(airframe);
00217 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b10" doxytag="AbstractRadio::sendUp"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::sendUp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>airframe</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to the upper layer <div class="fragment"><pre class="fragment">00207 {
00208     cMessage *frame = airframe-&gt;decapsulate();
00209     <span class="keyword">delete</span> airframe;
00210     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending up frame "</span> &lt;&lt; frame-&gt;name() &lt;&lt; endl;
00211     send(frame, uppergateOut);
00212 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b18" doxytag="AbstractRadio::setBitrate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::setBitrate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bitrate</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Change the bitrate to the given value. This method throws an error if the radio state is transmit. <div class="fragment"><pre class="fragment">00620 {
00621     <span class="keywordflow">if</span> (<a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a6">getBitrate</a>() == bitrate)
00622         <span class="keywordflow">return</span>;
00623     <span class="keywordflow">if</span> (bitrate &lt; 0)
00624         error("setBitrate(): bitrate cannot be negative (%g)", bitrate);
00625     if (rs.getState() == <a class="code" href="class_radio_state.html">RadioState</a>::TRANSMIT)
00626         error("changing the bitrate while transmitting is not allowed");
00627 
00628     EV &lt;&lt; "Setting bitrate to " &lt;&lt; (bitrate/1e6) &lt;&lt; "Mbps\n";
00629     rs.setBitrate(bitrate);
00630 
00631     <span class="comment">//XXX fire some notification?</span>
00632 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b13" doxytag="AbstractRadio::setRadioState"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void AbstractRadio::setRadioState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_radio_state.html#w4">RadioState::State</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>newState</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sets the radio state, and also fires change notification <div class="fragment"><pre class="fragment">00635 {
00636     <a class="code" href="class_abstract_radio.html#p5">rs</a>.<a class="code" href="class_radio_state.html#a3">setState</a>(newState);
00637     <a class="code" href="class_basic_module.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_RADIOSTATE_CHANGED, &amp;rs);
00638 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b9" doxytag="AbstractRadio::unbufferMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> * AbstractRadio::unbufferMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unbuffers a message after 'transmission time'. 
<p>
Get the context pointer to the now completely received <a class="el" href="class_air_frame.html">AirFrame</a> and delete the self message <div class="fragment"><pre class="fragment">00224 {
00225     <a class="code" href="class_air_frame.html">AirFrame</a> *airframe = (<a class="code" href="class_air_frame.html">AirFrame</a> *) msg-&gt;contextPointer();
00226     <span class="comment">//delete the self message</span>
00227     <span class="keyword">delete</span> msg;
00228 
00229     <span class="keywordflow">return</span> airframe;
00230 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p9" doxytag="AbstractRadio::carrierFrequency"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_abstract_radio.html#p9">AbstractRadio::carrierFrequency</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Configuration: The carrier frequency used. It is read from the <a class="el" href="class_channel_control.html">ChannelControl</a> module.     </td>
  </tr>
</table>
<a class="anchor" name="p7" doxytag="AbstractRadio::newBitrate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_abstract_radio.html#p7">AbstractRadio::newBitrate</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: if not -1, we have to switch to that bitrate once we finished transmitting     </td>
  </tr>
</table>
<a class="anchor" name="p6" doxytag="AbstractRadio::newChannel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_abstract_radio.html#p6">AbstractRadio::newChannel</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: if not -1, we have to switch to that channel once we finished transmitting     </td>
  </tr>
</table>
<a class="anchor" name="p8" doxytag="AbstractRadio::noiseLevel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_abstract_radio.html#p8">AbstractRadio::noiseLevel</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: the current noise level of the channel.     </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="AbstractRadio::radioModel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_radio_model.html">IRadioModel</a>* <a class="el" href="class_abstract_radio.html#p0">AbstractRadio::radioModel</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="AbstractRadio::receptionModel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_reception_model.html">IReceptionModel</a>* <a class="el" href="class_abstract_radio.html#p1">AbstractRadio::receptionModel</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p4" doxytag="AbstractRadio::recvBuff"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_abstract_radio.html#x0">RecvBuff</a> <a class="el" href="class_abstract_radio.html#p4">AbstractRadio::recvBuff</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: A buffer to store a pointer to a message and the related receive power.     </td>
  </tr>
</table>
<a class="anchor" name="p5" doxytag="AbstractRadio::rs"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_radio_state.html">RadioState</a> <a class="el" href="class_abstract_radio.html#p5">AbstractRadio::rs</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: the current <a class="el" href="class_radio_state.html">RadioState</a> of the NIC; includes channel number     </td>
  </tr>
</table>
<a class="anchor" name="p11" doxytag="AbstractRadio::sensitivity"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_abstract_radio.html#p11">AbstractRadio::sensitivity</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Configuration: Defines up to what Power level (in dBm) a message can be understood. If the level of a received packet is lower, it is only treated as noise. Can be specified in omnetpp.ini. Default: -85 dBm     </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="AbstractRadio::snrInfo"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="struct_abstract_radio_1_1_snr_struct.html">SnrStruct</a> <a class="el" href="class_abstract_radio.html#p3">AbstractRadio::snrInfo</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
State: SnrInfo stores the snrList and the the recvdPower for the message currently being received, together with a pointer to the message.     </td>
  </tr>
</table>
<a class="anchor" name="p10" doxytag="AbstractRadio::thermalNoise"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_abstract_radio.html#p10">AbstractRadio::thermalNoise</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Configuration: Thermal noise on the channel. Can be specified in omnetpp.ini. Default: -100 dBm     </td>
  </tr>
</table>
<a class="anchor" name="p2" doxytag="AbstractRadio::transmitterPower"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="class_abstract_radio.html#p2">AbstractRadio::transmitterPower</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Power used to transmit messages     </td>
  </tr>
</table>
<a class="anchor" name="z125_1" doxytag="AbstractRadio::uppergateIn"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_abstract_radio.html#z125_1">AbstractRadio::uppergateIn</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z125_0" doxytag="AbstractRadio::uppergateOut"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_abstract_radio.html#z125_0">AbstractRadio::uppergateOut</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_abstract_radio_8h.html">AbstractRadio.h</a><li><a class="el" href="_abstract_radio_8cc.html">AbstractRadio.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:20 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
