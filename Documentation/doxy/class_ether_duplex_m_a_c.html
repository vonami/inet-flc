<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: EtherDuplexMAC Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>EtherDuplexMAC Class Reference</h1><code>#include &lt;EtherDuplexMAC.h&gt;</code>
<p>
<p>Inheritance diagram for EtherDuplexMAC:
<p><center><img src="class_ether_duplex_m_a_c.png" usemap="#EtherDuplexMAC_map" border="0" alt=""></center>
<map name="EtherDuplexMAC_map">
<area href="class_ether_m_a_c_base.html" alt="EtherMACBase" shape="rect" coords="0,0,110,24">
</map>
<a href="class_ether_duplex_m_a_c-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
EtherDuplexMAC implementation. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_duplex_m_a_c.html#a0">EtherDuplexMAC</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_duplex_m_a_c.html#b0">initialize</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_duplex_m_a_c.html#b1">initializeTxrate</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_duplex_m_a_c.html#b2">handleMessage</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_duplex_m_a_c.html#b3">startFrameTransmission</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_duplex_m_a_c.html#b4">processFrameFromUpperLayer</a> (<a class="el" href="class_ether_frame.html">EtherFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_duplex_m_a_c.html#b5">processMsgFromNetwork</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_duplex_m_a_c.html#b6">handleEndIFGPeriod</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ether_duplex_m_a_c.html#b7">handleEndTxPeriod</a> ()</td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="EtherDuplexMAC::EtherDuplexMAC"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">EtherDuplexMAC::EtherDuplexMAC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00030 {
00031 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b6" doxytag="EtherDuplexMAC::handleEndIFGPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void EtherDuplexMAC::handleEndIFGPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="class_ether_m_a_c_base.html#b16">EtherMACBase</a>.<div class="fragment"><pre class="fragment">00148 {
00149     <a class="code" href="class_ether_m_a_c_base.html#b16">EtherMACBase::handleEndIFGPeriod</a>();
00150 
00151     <a class="code" href="class_ether_duplex_m_a_c.html#b3">startFrameTransmission</a>();
00152 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="EtherDuplexMAC::handleEndTxPeriod"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void EtherDuplexMAC::handleEndTxPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="class_ether_m_a_c_base.html#b17">EtherMACBase</a>.<div class="fragment"><pre class="fragment">00155 {
00156     <a class="code" href="class_ether_m_a_c_base.html#b23">fireChangeNotification</a>(NF_PP_TX_END, (cMessage *)<a class="code" href="class_ether_m_a_c_base.html#p17">txQueue</a>.tail());
00157 
00158     <span class="keywordflow">if</span> (<a class="code" href="class_ether_m_a_c_base.html#b22">checkAndScheduleEndPausePeriod</a>())
00159         return;
00160 
00161     <a class="code" href="class_ether_m_a_c_base.html">EtherMACBase</a>::handleEndTxPeriod();
00162 
00163     beginSendFrames();
00164 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="EtherDuplexMAC::handleMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void EtherDuplexMAC::handleMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00070 {
00071     <span class="keywordflow">if</span> (!connected)
00072         processMessageWhenNotConnected(msg);
00073     else if (disabled)
00074         processMessageWhenDisabled(msg);
00075     else if (msg-&gt;isSelfMessage())
00076     {
00077         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Self-message "</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">" received\n"</span>;
00078 
00079         <span class="keywordflow">if</span> (msg == endTxMsg)
00080             handleEndTxPeriod();
00081         else if (msg == endIFGMsg)
00082             handleEndIFGPeriod();
00083         else if (msg == endPauseMsg)
00084             handleEndPausePeriod();
00085         else
00086             error("Unknown self message received!");
00087     }
00088     else
00089     {
00090         <span class="keywordflow">if</span> (msg-&gt;arrivalGate() == gate(<span class="stringliteral">"upperLayerIn"</span>))
00091             <a class="code" href="class_ether_duplex_m_a_c.html#b4">processFrameFromUpperLayer</a>(check_and_cast&lt;EtherFrame *&gt;(msg));
00092         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;arrivalGate() == gate(<span class="stringliteral">"physIn"</span>))
00093             <a class="code" href="class_ether_duplex_m_a_c.html#b5">processMsgFromNetwork</a>(check_and_cast&lt;EtherFrame *&gt;(msg));
00094         <span class="keywordflow">else</span>
00095             error(<span class="stringliteral">"Message received from unknown gate!"</span>);
00096     }
00097 
00098     <span class="keywordflow">if</span> (ev.isGUI())  <a class="code" href="class_ether_m_a_c_base.html#b28">updateDisplayString</a>();
00099 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="EtherDuplexMAC::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void EtherDuplexMAC::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="class_ether_m_a_c_base.html#b0">EtherMACBase</a>.<div class="fragment"><pre class="fragment">00034 {
00035     <a class="code" href="class_ether_m_a_c_base.html#b0">EtherMACBase::initialize</a>();
00036 
00037     <a class="code" href="class_ether_m_a_c_base.html#p5">duplexMode</a> = <span class="keyword">true</span>;
00038     <a class="code" href="class_ether_m_a_c_base.html#b9">calculateParameters</a>();
00039 
00040     <a class="code" href="class_ether_m_a_c_base.html#b24">beginSendFrames</a>();
00041 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="EtherDuplexMAC::initializeTxrate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void EtherDuplexMAC::initializeTxrate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ether_m_a_c_base.html#b1">EtherMACBase</a>.<div class="fragment"><pre class="fragment">00044 {
00045     <span class="comment">// if we're connected, find the gate with transmission rate</span>
00046     cGate *g = gate(<span class="stringliteral">"physOut"</span>);
00047     <a class="code" href="class_ether_m_a_c_base.html#p8">txrate</a> = 0;
00048 
00049     <span class="keywordflow">if</span> (connected)
00050     {
00051         <span class="comment">// obtain txrate from channel. As a side effect, this also asserts</span>
00052         <span class="comment">// that the other end is an EtherDuplexMAC, since normal EtherMAC</span>
00053         <span class="comment">// insists that the connection has *no* datarate set.</span>
00054         <span class="keywordflow">while</span> (g)
00055         {
00056             <span class="comment">// does this gate have data rate?</span>
00057             cSimpleChannel *chan = dynamic_cast&lt;cSimpleChannel*&gt;(g-&gt;channel());
00058             <span class="keywordflow">if</span> (chan &amp;&amp; (txrate=chan-&gt;datarate())&gt;0)
00059                 <span class="keywordflow">break</span>;
00060             <span class="comment">// otherwise just check next connection in path</span>
00061             g = g-&gt;toGate();
00062         }
00063 
00064         <span class="keywordflow">if</span> (!g)
00065             error("gate physOut must be connected (directly or indirectly) to a link with data rate");
00066     }
00067 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="EtherDuplexMAC::processFrameFromUpperLayer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void EtherDuplexMAC::processFrameFromUpperLayer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ether_frame.html">EtherFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="class_ether_m_a_c_base.html#b12">EtherMACBase</a>.<div class="fragment"><pre class="fragment">00129 {
00130     <a class="code" href="class_ether_m_a_c_base.html#b12">EtherMACBase::processFrameFromUpperLayer</a>(frame);
00131 
00132     <span class="keywordflow">if</span> (transmitState == TX_IDLE_STATE)
00133         startFrameTransmission();
00134 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="EtherDuplexMAC::processMsgFromNetwork"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void EtherDuplexMAC::processMsgFromNetwork           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="class_ether_m_a_c_base.html#b13">EtherMACBase</a>.<div class="fragment"><pre class="fragment">00137 {
00138     <a class="code" href="class_ether_m_a_c_base.html#b13">EtherMACBase::processMsgFromNetwork</a>(msg);
00139     <a class="code" href="class_ether_frame.html">EtherFrame</a> *frame = check_and_cast&lt;EtherFrame *&gt;(msg);
00140 
00141     <a class="code" href="class_ether_m_a_c_base.html#b23">fireChangeNotification</a>(NF_PP_RX_END, frame);
00142 
00143     <span class="keywordflow">if</span> (<a class="code" href="class_ether_m_a_c_base.html#b8">checkDestinationAddress</a>(frame))
00144         frameReceptionComplete(frame);
00145 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="EtherDuplexMAC::startFrameTransmission"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void EtherDuplexMAC::startFrameTransmission           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00102 {
00103     <a class="code" href="class_ether_frame.html">EtherFrame</a> *origFrame = (<a class="code" href="class_ether_frame.html">EtherFrame</a> *)<a class="code" href="class_ether_m_a_c_base.html#p17">txQueue</a>.tail();
00104     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Transmitting a copy of frame "</span> &lt;&lt; origFrame &lt;&lt; endl;
00105 
00106     <a class="code" href="class_ether_frame.html">EtherFrame</a> *frame = (<a class="code" href="class_ether_frame.html">EtherFrame</a> *) origFrame-&gt;<a class="code" href="class_ether_frame.html#a4">dup</a>();
00107     frame-&gt;addByteLength(PREAMBLE_BYTES+SFD_BYTES);
00108 
00109     <a class="code" href="class_ether_m_a_c_base.html#b23">fireChangeNotification</a>(NF_PP_TX_BEGIN, frame);
00110 
00111     <span class="comment">// fill in src address if not set</span>
00112     <span class="keywordflow">if</span> (frame-&gt;<a class="code" href="class_ether_frame.html#a10">getSrc</a>().<a class="code" href="class_m_a_c_address.html#a13">isUnspecified</a>())
00113         frame-&gt;<a class="code" href="class_ether_frame.html#a12">setSrc</a>(address);
00114 
00115     <span class="comment">// send</span>
00116     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Starting transmission of "</span> &lt;&lt; frame &lt;&lt; endl;
00117     send(frame, <span class="stringliteral">"physOut"</span>);
00118     <a class="code" href="class_ether_m_a_c_base.html#b20">scheduleEndTxPeriod</a>(frame);
00119 
00120     <span class="comment">// update burst variables</span>
00121     <span class="keywordflow">if</span> (frameBursting)
00122     {
00123         <a class="code" href="class_ether_m_a_c_base.html#p26">bytesSentInBurst</a> = frame-&gt;byteLength();
00124         <a class="code" href="class_ether_m_a_c_base.html#p25">framesSentInBurst</a>++;
00125     }
00126 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_ether_duplex_m_a_c_8h.html">EtherDuplexMAC.h</a><li><a class="el" href="_ether_duplex_m_a_c_8cc.html">EtherDuplexMAC.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sun Sep 3 19:33:39 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
