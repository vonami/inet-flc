<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: IP Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>IP Class Reference</h1><code>#include &lt;IP.h&gt;</code>
<p>
<p>Inheritance diagram for IP:
<p><center><img src="class_i_p.png" usemap="#IP_map" border="0" alt=""></center>
<map name="IP_map">
<area href="class_queue_base.html" alt="QueueBase" shape="rect" coords="0,56,97,80">
<area href="class_abstract_queue.html" alt="AbstractQueue" shape="rect" coords="0,0,97,24">
</map>
<a href="class_i_p-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Implements the IP protocol. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#a0">IP</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b0">sourceInterfaceFrom</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b1">updateDisplayString</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_p_datagram.html">IPDatagram</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b2">encapsulate</a> (cMessage *transportPacket, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&amp;destIE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b3">handlePacketFromNetwork</a> (<a class="el" href="class_i_p_datagram.html">IPDatagram</a> *datagram)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b4">handleMessageFromHL</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b5">handleARP</a> (<a class="el" href="class_a_r_p_packet.html">ARPPacket</a> *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b6">handleReceivedICMP</a> (<a class="el" href="class_i_c_m_p_message.html">ICMPMessage</a> *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b7">routePacket</a> (<a class="el" href="class_i_p_datagram.html">IPDatagram</a> *datagram, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *destIE, bool fromHL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b8">routeMulticastPacket</a> (<a class="el" href="class_i_p_datagram.html">IPDatagram</a> *datagram, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *destIE, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *fromIE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b9">localDeliver</a> (<a class="el" href="class_i_p_datagram.html">IPDatagram</a> *datagram)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b10">decapsulateIP</a> (<a class="el" href="class_i_p_datagram.html">IPDatagram</a> *datagram)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b11">fragmentAndSend</a> (<a class="el" href="class_i_p_datagram.html">IPDatagram</a> *datagram, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *ie, <a class="el" href="class_i_p_address.html">IPAddress</a> nextHopAddr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b12">sendDatagramToOutput</a> (<a class="el" href="class_i_p_datagram.html">IPDatagram</a> *datagram, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *ie, <a class="el" href="class_i_p_address.html">IPAddress</a> nextHopAddr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b13">initialize</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#b14">endService</a> (cMessage *msg)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_routing_table.html">RoutingTable</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p0">rt</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_interface_table.html">InterfaceTable</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p1">ift</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_c_m_p_access.html">ICMPAccess</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p2">icmpAccess</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p3">defaultTimeToLive</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p4">defaultMCTimeToLive</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p5">fragmentTimeoutTime</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p6">curFragmentId</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_p_frag_buf.html">IPFragBuf</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p7">fragbuf</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p8">lastCheckTime</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_protocol_mapping.html">ProtocolMapping</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p9">mapping</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p10">numMulticast</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p11">numLocalDeliver</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p12">numDropped</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p13">numUnroutable</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p.html#p14">numForwarded</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="IP::IP"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">IP::IP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00138 {}
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b10" doxytag="IP::decapsulateIP"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage * IP::decapsulateIP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_p_datagram.html">IPDatagram</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>datagram</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Decapsulate and return encapsulated packet after attaching <a class="el" href="class_i_p_control_info.html">IPControlInfo</a>. <div class="fragment"><pre class="fragment">00409 {
00410     <span class="comment">// decapsulate transport packet</span>
00411     <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *fromIE = <a class="code" href="class_i_p.html#b0">sourceInterfaceFrom</a>(datagram);
00412     cMessage *packet = datagram-&gt;decapsulate();
00413 
00414     <span class="comment">// create and fill in control info</span>
00415     <a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_i_p_control_info.html">IPControlInfo</a>();
00416     controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a12">setProtocol</a>(datagram-&gt;<a class="code" href="class_i_p_datagram.html#a17">transportProtocol</a>());
00417     controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a8">setSrcAddr</a>(datagram-&gt;<a class="code" href="class_i_p_datagram.html#a11">srcAddress</a>());
00418     controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a5">setDestAddr</a>(datagram-&gt;<a class="code" href="class_i_p_datagram.html#a14">destAddress</a>());
00419     controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a14">setDiffServCodePoint</a>(datagram-&gt;<a class="code" href="class_i_p_datagram.html#a29">diffServCodePoint</a>());
00420     controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a10">setInterfaceId</a>(fromIE ? fromIE-&gt;<a class="code" href="class_interface_entry.html#a4">interfaceId</a>() : -1);
00421 
00422     <span class="comment">// original IP datagram might be needed in upper layers to send back ICMP error message</span>
00423     controlInfo-&gt;<a class="code" href="class_i_p_control_info.html#a4">setOrigDatagram</a>(datagram);
00424 
00425     <span class="comment">// attach control info</span>
00426     packet-&gt;setControlInfo(controlInfo);
00427 
00428     <span class="keywordflow">return</span> packet;
00429 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="IP::encapsulate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_p_datagram.html">IPDatagram</a> * IP::encapsulate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname" nowrap> <em>transportPacket</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>destIE</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Encapsulate packet coming from higher layers into <a class="el" href="class_i_p_datagram.html">IPDatagram</a> <div class="fragment"><pre class="fragment">00495 {
00496     <a class="code" href="class_i_p_control_info.html">IPControlInfo</a> *controlInfo = check_and_cast&lt;IPControlInfo*&gt;(transportPacket-&gt;removeControlInfo());
00497 
00498     <a class="code" href="class_i_p_datagram.html">IPDatagram</a> *datagram = <span class="keyword">new</span> <a class="code" href="class_i_p_datagram.html">IPDatagram</a>(transportPacket-&gt;name());
00499     datagram-&gt;setByteLength(IP_HEADER_BYTES);
00500     datagram-&gt;encapsulate(transportPacket);
00501 
00502     <span class="comment">// set source and destination address</span>
00503     <a class="code" href="class_i_p_address.html">IPAddress</a> dest = controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a3">destAddr</a>();
00504     datagram-&gt;<a class="code" href="class_i_p_datagram.html#a16">setDestAddress</a>(dest);
00505 
00506     <span class="comment">// IP_MULTICAST_IF option, but allow interface selection for unicast packets as well</span>
00507     destIE = <a class="code" href="class_i_p.html#p1">ift</a>-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a9">interfaceId</a>());
00508 
00509     <a class="code" href="class_i_p_address.html">IPAddress</a> src = controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a6">srcAddr</a>();
00510 
00511     <span class="comment">// when source address was given, use it; otherwise it'll get the address</span>
00512     <span class="comment">// of the outgoing interface after routing</span>
00513     <span class="keywordflow">if</span> (!src.<a class="code" href="class_i_p_address.html#a1">isUnspecified</a>())
00514     {
00515         <span class="comment">// if interface parameter does not match existing interface, do not send datagram</span>
00516         <span class="keywordflow">if</span> (<a class="code" href="class_i_p.html#p0">rt</a>-&gt;<a class="code" href="class_routing_table.html#z40_1">interfaceByAddress</a>(src)==NULL)
00517             opp_error(<span class="stringliteral">"Wrong source address %s in (%s)%s: no interface with such address"</span>,
00518                       src.<a class="code" href="class_i_p_address.html#a4">str</a>().c_str(), transportPacket-&gt;className(), transportPacket-&gt;fullName());
00519         datagram-&gt;<a class="code" href="class_i_p_datagram.html#a13">setSrcAddress</a>(src);
00520     }
00521 
00522     <span class="comment">// set other fields</span>
00523     datagram-&gt;<a class="code" href="class_i_p_datagram.html#a30">setDiffServCodePoint</a>(controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a13">diffServCodePoint</a>());
00524 
00525     datagram-&gt;<a class="code" href="class_i_p_datagram.html#a22">setIdentification</a>(curFragmentId++);
00526     datagram-&gt;<a class="code" href="class_i_p_datagram.html#a24">setMoreFragments</a>(<span class="keyword">false</span>);
00527     datagram-&gt;<a class="code" href="class_i_p_datagram.html#a26">setDontFragment</a> (controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a17">dontFragment</a>());
00528     datagram-&gt;<a class="code" href="class_i_p_datagram.html#a28">setFragmentOffset</a>(0);
00529 
00530     datagram-&gt;<a class="code" href="class_i_p_datagram.html#a20">setTimeToLive</a>(
00531            controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a15">timeToLive</a>() &gt; 0 ?
00532            controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a15">timeToLive</a>() :
00533            (datagram-&gt;destAddress().isMulticast() ? <a class="code" href="class_i_p.html#p4">defaultMCTimeToLive</a> : <a class="code" href="class_i_p.html#p3">defaultTimeToLive</a>)
00534     );
00535 
00536     datagram-&gt;<a class="code" href="class_i_p_datagram.html#a18">setTransportProtocol</a>(controlInfo-&gt;<a class="code" href="class_i_p_control_info___base.html#a11">protocol</a>());
00537     <span class="keyword">delete</span> controlInfo;
00538 
00539     <span class="comment">// setting IP options is currently not supported</span>
00540 
00541     <span class="keywordflow">return</span> datagram;
00542 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b14" doxytag="IP::endService"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::endService           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Processing of IP datagrams. Called when a datagram reaches the front of the queue. 
<p>
Implements <a class="el" href="class_abstract_queue.html#z14_3">AbstractQueue</a>.<div class="fragment"><pre class="fragment">00071 {
00072     <span class="keywordflow">if</span> (msg-&gt;arrivalGate()-&gt;isName(<span class="stringliteral">"transportIn"</span>))
00073     {
00074         <a class="code" href="class_i_p.html#b4">handleMessageFromHL</a>(msg);
00075     }
00076     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;ARPPacket *&gt;(msg))
00077     {
00078         <span class="comment">// dispatch ARP packets to ARP</span>
00079         <a class="code" href="class_i_p.html#b5">handleARP</a>((<a class="code" href="class_a_r_p_packet.html">ARPPacket</a> *)msg);
00080     }
00081     <span class="keywordflow">else</span>
00082     {
00083         <a class="code" href="class_i_p_datagram.html">IPDatagram</a> *dgram = check_and_cast&lt;IPDatagram *&gt;(msg);
00084         <a class="code" href="class_i_p.html#b3">handlePacketFromNetwork</a>(dgram);
00085     }
00086 
00087     <span class="keywordflow">if</span> (ev.isGUI())
00088         <a class="code" href="class_i_p.html#b1">updateDisplayString</a>();
00089 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b11" doxytag="IP::fragmentAndSend"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::fragmentAndSend           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_p_datagram.html">IPDatagram</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datagram</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_i_p_address.html">IPAddress</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nextHopAddr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fragment packet if needed, then send it to the selected interface using <a class="el" href="class_i_p.html#b12">sendDatagramToOutput()</a>. <div class="fragment"><pre class="fragment">00433 {
00434     <span class="keywordtype">int</span> mtu = ie-&gt;<a class="code" href="class_interface_entry.html#a10">mtu</a>();
00435 
00436     <span class="comment">// check if datagram does not require fragmentation</span>
00437     <span class="keywordflow">if</span> (datagram-&gt;byteLength() &lt;= mtu)
00438     {
00439         <a class="code" href="class_i_p.html#b12">sendDatagramToOutput</a>(datagram, ie, nextHopAddr);
00440         <span class="keywordflow">return</span>;
00441     }
00442 
00443     <span class="keywordtype">int</span> headerLength = datagram-&gt;<a class="code" href="class_i_p_datagram.html#a9">headerLength</a>();
00444     <span class="keywordtype">int</span> payload = datagram-&gt;byteLength() - headerLength;
00445 
00446     <span class="keywordtype">int</span> noOfFragments =
00447         int(ceil((<span class="keywordtype">float</span>(payload)/mtu) /
00448         (1-<span class="keywordtype">float</span>(headerLength)/mtu) ) ); <span class="comment">// FIXME ???</span>
00449 
00450     <span class="comment">// if "don't fragment" bit is set, throw datagram away and send ICMP error message</span>
00451     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="class_i_p_datagram.html#a25">dontFragment</a>() &amp;&amp; noOfFragments&gt;1)
00452     {
00453         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"datagram larger than MTU and don't fragment bit set, sending ICMP_DESTINATION_UNREACHABLE\n"</span>;
00454         <a class="code" href="class_i_p.html#p2">icmpAccess</a>.<a class="code" href="class_module_access.html#a1">get</a>()-&gt;<a class="code" href="class_i_c_m_p.html#a0">sendErrorMessage</a>(datagram, ICMP_DESTINATION_UNREACHABLE,
00455                                                      ICMP_FRAGMENTATION_ERROR_CODE);
00456         <span class="keywordflow">return</span>;
00457     }
00458 
00459     <span class="comment">// create and send fragments</span>
00460     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Breaking datagram into "</span> &lt;&lt; noOfFragments &lt;&lt; <span class="stringliteral">" fragments\n"</span>;
00461     std::string fragMsgName = datagram-&gt;name();
00462     fragMsgName += <span class="stringliteral">"-frag"</span>;
00463 
00464     <span class="comment">// FIXME revise this!</span>
00465     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;noOfFragments; i++)
00466     {
00467         <span class="comment">// FIXME is it ok that full encapsulated packet travels in every datagram fragment?</span>
00468         <span class="comment">// should better travel in the last fragment only. Cf. with reassembly code!</span>
00469         <a class="code" href="class_i_p_datagram.html">IPDatagram</a> *fragment = (<a class="code" href="class_i_p_datagram.html">IPDatagram</a> *) datagram-&gt;<a class="code" href="class_i_p_datagram.html#a4">dup</a>();
00470         fragment-&gt;setName(fragMsgName.c_str());
00471 
00472         <span class="comment">// total_length equal to mtu, except for last fragment;</span>
00473         <span class="comment">// "more fragments" bit is unchanged in the last fragment, otherwise true</span>
00474         <span class="keywordflow">if</span> (i != noOfFragments-1)
00475         {
00476             fragment-&gt;<a class="code" href="class_i_p_datagram.html#a24">setMoreFragments</a>(<span class="keyword">true</span>);
00477             fragment-&gt;setByteLength(mtu);
00478         }
00479         <span class="keywordflow">else</span>
00480         {
00481             <span class="comment">// size of last fragment</span>
00482             <span class="keywordtype">int</span> bytes = datagram-&gt;byteLength() - (noOfFragments-1) * (mtu - datagram-&gt;<a class="code" href="class_i_p_datagram.html#a9">headerLength</a>());
00483             fragment-&gt;setByteLength(bytes);
00484         }
00485         fragment-&gt;<a class="code" href="class_i_p_datagram.html#a28">setFragmentOffset</a>( i*(mtu - datagram-&gt;<a class="code" href="class_i_p_datagram.html#a9">headerLength</a>()) );
00486 
00487         <a class="code" href="class_i_p.html#b12">sendDatagramToOutput</a>(fragment, ie, nextHopAddr);
00488     }
00489 
00490     <span class="keyword">delete</span> datagram;
00491 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="IP::handleARP"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::handleARP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_a_r_p_packet.html">ARPPacket</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle incoming <a class="el" href="class_a_r_p.html">ARP</a> packets by sending them over "queueOut" to <a class="el" href="class_a_r_p.html">ARP</a>. <div class="fragment"><pre class="fragment">00131 {
00132     <span class="comment">// FIXME hasBitError() check  missing!</span>
00133 
00134     <span class="comment">// delete old control info</span>
00135     <span class="keyword">delete</span> msg-&gt;removeControlInfo();
00136 
00137     <span class="comment">// dispatch ARP packets to ARP and let it know the gate index it arrived on</span>
00138     <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *fromIE = <a class="code" href="class_i_p.html#b0">sourceInterfaceFrom</a>(msg);
00139     ASSERT(fromIE);
00140 
00141     <a class="code" href="class_i_p_routing_decision.html">IPRoutingDecision</a> *routingDecision = <span class="keyword">new</span> <a class="code" href="class_i_p_routing_decision.html">IPRoutingDecision</a>();
00142     routingDecision-&gt;<a class="code" href="class_i_p_routing_decision.html#a7">setInterfaceId</a>(fromIE-&gt;<a class="code" href="class_interface_entry.html#a4">interfaceId</a>());
00143     msg-&gt;setControlInfo(routingDecision);
00144 
00145     send(msg, <span class="stringliteral">"queueOut"</span>);
00146 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="IP::handleMessageFromHL"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::handleMessageFromHL           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages (typically packets to be send in IP) from transport or <a class="el" href="class_i_c_m_p.html">ICMP</a>. Invokes <a class="el" href="class_i_p.html#b2">encapsulate()</a>, then <a class="el" href="class_i_p.html#b7">routePacket()</a>. <div class="fragment"><pre class="fragment">00173 {
00174     <span class="comment">// if no interface exists, do not send datagram</span>
00175     <span class="keywordflow">if</span> (<a class="code" href="class_i_p.html#p1">ift</a>-&gt;<a class="code" href="class_interface_table.html#a4">numInterfaces</a>() == 0)
00176     {
00177         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"No interfaces exist, dropping packet\n"</span>;
00178         <span class="keyword">delete</span> msg;
00179         <span class="keywordflow">return</span>;
00180     }
00181 
00182     <span class="comment">// encapsulate and send</span>
00183     <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *destIE; <span class="comment">// will be filled in by encapsulate()</span>
00184     <a class="code" href="class_i_p_datagram.html">IPDatagram</a> *datagram = <a class="code" href="class_i_p.html#b2">encapsulate</a>(msg, destIE);
00185 
00186     <span class="comment">// route packet</span>
00187     <span class="keywordflow">if</span> (!datagram-&gt;<a class="code" href="class_i_p_datagram.html#a14">destAddress</a>().<a class="code" href="class_i_p_address.html#a8">isMulticast</a>())
00188         <a class="code" href="class_i_p.html#b7">routePacket</a>(datagram, destIE, <span class="keyword">true</span>);
00189     <span class="keywordflow">else</span>
00190         <a class="code" href="class_i_p.html#b8">routeMulticastPacket</a>(datagram, destIE, NULL);
00191 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="IP::handlePacketFromNetwork"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::handlePacketFromNetwork           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_p_datagram.html">IPDatagram</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>datagram</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle <a class="el" href="class_i_p_datagram.html">IPDatagram</a> messages arriving from lower layer. Decrements TTL, then invokes <a class="el" href="class_i_p.html#b7">routePacket()</a>. <div class="fragment"><pre class="fragment">00098 {
00099     <span class="comment">//</span>
00100     <span class="comment">// "Prerouting"</span>
00101     <span class="comment">//</span>
00102 
00103     <span class="comment">// check for header biterror</span>
00104     <span class="keywordflow">if</span> (datagram-&gt;hasBitError())
00105     {
00106         <span class="comment">// probability of bit error in header = size of header / size of total message</span>
00107         <span class="comment">// (ignore bit error if in payload)</span>
00108         <span class="keywordtype">double</span> relativeHeaderLength = datagram-&gt;<a class="code" href="class_i_p_datagram.html#a9">headerLength</a>() / (double)datagram-&gt;byteLength();
00109         <span class="keywordflow">if</span> (dblrand() &lt;= relativeHeaderLength)
00110         {
00111             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"bit error found, sending ICMP_PARAMETER_PROBLEM\n"</span>;
00112             <a class="code" href="class_i_p.html#p2">icmpAccess</a>.<a class="code" href="class_module_access.html#a1">get</a>()-&gt;<a class="code" href="class_i_c_m_p.html#a0">sendErrorMessage</a>(datagram, ICMP_PARAMETER_PROBLEM, 0);
00113             <span class="keywordflow">return</span>;
00114         }
00115     }
00116 
00117     <span class="comment">// remove control info</span>
00118     <span class="keyword">delete</span> datagram-&gt;removeControlInfo();
00119 
00120     <span class="comment">// hop counter decrement; FIXME but not if it will be locally delivered</span>
00121     datagram-&gt;<a class="code" href="class_i_p_datagram.html#a20">setTimeToLive</a>(datagram-&gt;<a class="code" href="class_i_p_datagram.html#a19">timeToLive</a>()-1);
00122 
00123     <span class="comment">// route packet</span>
00124     <span class="keywordflow">if</span> (!datagram-&gt;<a class="code" href="class_i_p_datagram.html#a14">destAddress</a>().<a class="code" href="class_i_p_address.html#a8">isMulticast</a>())
00125         <a class="code" href="class_i_p.html#b7">routePacket</a>(datagram, NULL, <span class="keyword">false</span>);
00126     <span class="keywordflow">else</span>
00127         <a class="code" href="class_i_p.html#b8">routeMulticastPacket</a>(datagram, NULL, <a class="code" href="class_i_p.html#b0">sourceInterfaceFrom</a>(datagram));
00128 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b6" doxytag="IP::handleReceivedICMP"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::handleReceivedICMP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_c_m_p_message.html">ICMPMessage</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle incoming <a class="el" href="class_i_c_m_p.html">ICMP</a> messages. <div class="fragment"><pre class="fragment">00149 {
00150     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="class_i_c_m_p_message.html#a7">getType</a>())
00151     {
00152         <span class="keywordflow">case</span> <a class="code" href="_i_c_m_p_message__m_8h.html#a30a20">ICMP_REDIRECT</a>: <span class="comment">// TODO implement redirect handling</span>
00153         <span class="keywordflow">case</span> <a class="code" href="_i_c_m_p_message__m_8h.html#a30a19">ICMP_DESTINATION_UNREACHABLE</a>:
00154         <span class="keywordflow">case</span> <a class="code" href="_i_c_m_p_message__m_8h.html#a30a21">ICMP_TIME_EXCEEDED</a>:
00155         <span class="keywordflow">case</span> <a class="code" href="_i_c_m_p_message__m_8h.html#a30a22">ICMP_PARAMETER_PROBLEM</a>: {
00156             <span class="comment">// ICMP errors are delivered to the appropriate higher layer protocol</span>
00157             <a class="code" href="class_i_p_datagram.html">IPDatagram</a> *bogusPacket = check_and_cast&lt;IPDatagram *&gt;(msg-&gt;encapsulatedMsg());
00158             <span class="keywordtype">int</span> protocol = bogusPacket-&gt;<a class="code" href="class_i_p_datagram.html#a17">transportProtocol</a>();
00159             <span class="keywordtype">int</span> gateindex = <a class="code" href="class_i_p.html#p9">mapping</a>.<a class="code" href="class_protocol_mapping.html#a3">outputGateForProtocol</a>(protocol);
00160             send(msg, <span class="stringliteral">"transportOut"</span>, gateindex);
00161             <span class="keywordflow">break</span>;
00162         }
00163         <span class="keywordflow">default</span>: {
00164             <span class="comment">// all others are delivered to ICMP: ICMP_ECHO_REQUEST, ICMP_ECHO_REPLY,</span>
00165             <span class="comment">// ICMP_TIMESTAMP_REQUEST, ICMP_TIMESTAMP_REPLY, etc.</span>
00166             <span class="keywordtype">int</span> gateindex = <a class="code" href="class_i_p.html#p9">mapping</a>.<a class="code" href="class_protocol_mapping.html#a3">outputGateForProtocol</a>(IP_PROT_ICMP);
00167             send(msg, <span class="stringliteral">"transportOut"</span>, gateindex);
00168         }
00169     }
00170 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b13" doxytag="IP::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialization 
<p>
Reimplemented from <a class="el" href="class_queue_base.html#b0">QueueBase</a>.<div class="fragment"><pre class="fragment">00035 {
00036     <a class="code" href="class_queue_base.html#b0">QueueBase::initialize</a>();
00037 
00038     <a class="code" href="class_i_p.html#p1">ift</a> = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a>().get();
00039     <a class="code" href="class_i_p.html#p0">rt</a> = <a class="code" href="class_routing_table_access.html">RoutingTableAccess</a>().get();
00040 
00041     <a class="code" href="class_i_p.html#p3">defaultTimeToLive</a> = par(<span class="stringliteral">"timeToLive"</span>);
00042     <a class="code" href="class_i_p.html#p4">defaultMCTimeToLive</a> = par(<span class="stringliteral">"multicastTimeToLive"</span>);
00043     <a class="code" href="class_i_p.html#p5">fragmentTimeoutTime</a> = par(<span class="stringliteral">"fragmentTimeout"</span>);
00044     <a class="code" href="class_i_p.html#p9">mapping</a>.<a class="code" href="class_protocol_mapping.html#a2">parseProtocolMapping</a>(par(<span class="stringliteral">"protocolMapping"</span>));
00045 
00046     <a class="code" href="class_i_p.html#p6">curFragmentId</a> = 0;
00047     <a class="code" href="class_i_p.html#p8">lastCheckTime</a> = 0;
00048     <a class="code" href="class_i_p.html#p7">fragbuf</a>.<a class="code" href="class_i_p_frag_buf.html#a2">init</a>(<a class="code" href="class_i_p.html#p2">icmpAccess</a>.<a class="code" href="class_module_access.html#a1">get</a>());
00049 
00050     <a class="code" href="class_i_p.html#p10">numMulticast</a> = <a class="code" href="class_i_p.html#p11">numLocalDeliver</a> = <a class="code" href="class_i_p.html#p12">numDropped</a> = <a class="code" href="class_i_p.html#p13">numUnroutable</a> = <a class="code" href="class_i_p.html#p14">numForwarded</a> = 0;
00051 
00052     WATCH(numMulticast);
00053     WATCH(numLocalDeliver);
00054     WATCH(numDropped);
00055     WATCH(numUnroutable);
00056     WATCH(numForwarded);
00057 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b9" doxytag="IP::localDeliver"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::localDeliver           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_p_datagram.html">IPDatagram</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>datagram</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Perform reassembly of fragmented datagrams, then send them up to the higher layers using sendToHL(). <div class="fragment"><pre class="fragment">00364 {
00365     <span class="comment">// Defragmentation. skip defragmentation if datagram is not fragmented</span>
00366     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="class_i_p_datagram.html#a27">fragmentOffset</a>()!=0 || datagram-&gt;<a class="code" href="class_i_p_datagram.html#a23">moreFragments</a>())
00367     {
00368         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Datagram fragment: offset="</span> &lt;&lt; datagram-&gt;<a class="code" href="class_i_p_datagram.html#a27">fragmentOffset</a>()
00369            &lt;&lt; <span class="stringliteral">", MORE="</span> &lt;&lt; (datagram-&gt;<a class="code" href="class_i_p_datagram.html#a23">moreFragments</a>() ? <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span>) &lt;&lt; <span class="stringliteral">".\n"</span>;
00370 
00371         <span class="comment">// erase timed out fragments in fragmentation buffer; check every 10 seconds max</span>
00372         <span class="keywordflow">if</span> (simTime() &gt;= lastCheckTime + 10)
00373         {
00374             <a class="code" href="class_i_p.html#p8">lastCheckTime</a> = simTime();
00375             <a class="code" href="class_i_p.html#p7">fragbuf</a>.<a class="code" href="class_i_p_frag_buf.html#a4">purgeStaleFragments</a>(simTime()-fragmentTimeoutTime);
00376         }
00377 
00378         datagram = <a class="code" href="class_i_p.html#p7">fragbuf</a>.<a class="code" href="class_i_p_frag_buf.html#a3">addFragment</a>(datagram, simTime());
00379         <span class="keywordflow">if</span> (!datagram)
00380         {
00381             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"No complete datagram yet.\n"</span>;
00382             <span class="keywordflow">return</span>;
00383         }
00384         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"This fragment completes the datagram.\n"</span>;
00385     }
00386 
00387     <span class="comment">// decapsulate and send on appropriate output gate</span>
00388     <span class="keywordtype">int</span> protocol = datagram-&gt;<a class="code" href="class_i_p_datagram.html#a17">transportProtocol</a>();
00389     cMessage *packet = <a class="code" href="class_i_p.html#b10">decapsulateIP</a>(datagram);
00390 
00391     <span class="keywordflow">if</span> (protocol==IP_PROT_ICMP)
00392     {
00393         <span class="comment">// incoming ICMP packets are handled specially</span>
00394         <a class="code" href="class_i_p.html#b6">handleReceivedICMP</a>(check_and_cast&lt;ICMPMessage *&gt;(packet));
00395     }
00396     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (protocol==IP_PROT_IP)
00397     {
00398         <span class="comment">// tunnelled IP packets are handled separately</span>
00399         send(packet, <span class="stringliteral">"preRoutingOut"</span>);
00400     }
00401     <span class="keywordflow">else</span>
00402     {
00403         <span class="keywordtype">int</span> gateindex = <a class="code" href="class_i_p.html#p9">mapping</a>.<a class="code" href="class_protocol_mapping.html#a3">outputGateForProtocol</a>(protocol);
00404         send(packet, <span class="stringliteral">"transportOut"</span>, gateindex);
00405     }
00406 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b8" doxytag="IP::routeMulticastPacket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::routeMulticastPacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_p_datagram.html">IPDatagram</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datagram</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>destIE</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>fromIE</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Forwards packets to all multicast destinations, using <a class="el" href="class_i_p.html#b11">fragmentAndSend()</a>. <div class="fragment"><pre class="fragment">00264 {
00265     <a class="code" href="class_i_p_address.html">IPAddress</a> destAddr = datagram-&gt;<a class="code" href="class_i_p_datagram.html#a14">destAddress</a>();
00266     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Routing multicast datagram `"</span> &lt;&lt; datagram-&gt;name() &lt;&lt; <span class="stringliteral">"' with dest="</span> &lt;&lt; destAddr &lt;&lt; <span class="stringliteral">"\n"</span>;
00267 
00268     <a class="code" href="class_i_p.html#p10">numMulticast</a>++;
00269 
00270     <span class="comment">// DVMRP: process datagram only if sent locally or arrived on the shortest</span>
00271     <span class="comment">// route (provided routing table already contains srcAddr); otherwise</span>
00272     <span class="comment">// discard and continue.</span>
00273     <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *shortestPathIE = <a class="code" href="class_i_p.html#p0">rt</a>-&gt;<a class="code" href="class_routing_table.html#z42_2">interfaceForDestAddr</a>(datagram-&gt;<a class="code" href="class_i_p_datagram.html#a11">srcAddress</a>());
00274     <span class="keywordflow">if</span> (fromIE!=NULL &amp;&amp; shortestPathIE!=NULL &amp;&amp; fromIE!=shortestPathIE)
00275     {
00276         <span class="comment">// FIXME count dropped</span>
00277         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Packet dropped.\n"</span>;
00278         <span class="keyword">delete</span> datagram;
00279         <span class="keywordflow">return</span>;
00280     }
00281 
00282     <span class="comment">// if received from the network...</span>
00283     <span class="keywordflow">if</span> (fromIE!=NULL)
00284     {
00285         <span class="comment">// check for local delivery</span>
00286         <span class="keywordflow">if</span> (<a class="code" href="class_i_p.html#p0">rt</a>-&gt;<a class="code" href="class_routing_table.html#z44_0">multicastLocalDeliver</a>(destAddr))
00287         {
00288             <a class="code" href="class_i_p_datagram.html">IPDatagram</a> *datagramCopy = (<a class="code" href="class_i_p_datagram.html">IPDatagram</a> *) datagram-&gt;<a class="code" href="class_i_p_datagram.html#a4">dup</a>();
00289 
00290             <span class="comment">// FIXME code from the MPLS model: set packet dest address to routerId (???)</span>
00291             datagramCopy-&gt;<a class="code" href="class_i_p_datagram.html#a16">setDestAddress</a>(<a class="code" href="class_i_p.html#p0">rt</a>-&gt;<a class="code" href="class_routing_table.html#a4">routerId</a>());
00292 
00293             <a class="code" href="class_i_p.html#b9">localDeliver</a>(datagramCopy);
00294         }
00295 
00296         <span class="comment">// don't forward if IP forwarding is off</span>
00297         <span class="keywordflow">if</span> (!<a class="code" href="class_i_p.html#p0">rt</a>-&gt;<a class="code" href="class_routing_table.html#a3">ipForward</a>())
00298         {
00299             <span class="keyword">delete</span> datagram;
00300             <span class="keywordflow">return</span>;
00301         }
00302 
00303         <span class="comment">// don't forward if dest address is link-scope</span>
00304         <span class="keywordflow">if</span> (destAddr.<a class="code" href="class_i_p_address.html#a9">isLinkLocalMulticast</a>())
00305         {
00306             <span class="keyword">delete</span> datagram;
00307             <span class="keywordflow">return</span>;
00308         }
00309 
00310     }
00311 
00312     <span class="comment">// routed explicitly via IP_MULTICAST_IF</span>
00313     <span class="keywordflow">if</span> (destIE!=NULL)
00314     {
00315         ASSERT(datagram-&gt;<a class="code" href="class_i_p_datagram.html#a14">destAddress</a>().<a class="code" href="class_i_p_address.html#a8">isMulticast</a>());
00316 
00317         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"multicast packet explicitly routed via output interface "</span> &lt;&lt; destIE-&gt;<a class="code" href="class_interface_entry.html#a5">name</a>() &lt;&lt; endl;
00318 
00319         <span class="comment">// set datagram source address if not yet set</span>
00320         <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="class_i_p_datagram.html#a11">srcAddress</a>().<a class="code" href="class_i_p_address.html#a1">isUnspecified</a>())
00321             datagram-&gt;<a class="code" href="class_i_p_datagram.html#a13">setSrcAddress</a>(destIE-&gt;<a class="code" href="class_interface_entry.html#a33">ipv4</a>()-&gt;<a class="code" href="class_i_pv4_interface_data.html#a4">inetAddress</a>());
00322 
00323         <span class="comment">// send</span>
00324         <a class="code" href="class_i_p.html#b11">fragmentAndSend</a>(datagram, destIE, datagram-&gt;<a class="code" href="class_i_p_datagram.html#a14">destAddress</a>());
00325 
00326         <span class="keywordflow">return</span>;
00327     }
00328 
00329     <span class="comment">// now: routing</span>
00330     <a class="code" href="_routing_table_8h.html#a0">MulticastRoutes</a> routes = <a class="code" href="class_i_p.html#p0">rt</a>-&gt;<a class="code" href="class_routing_table.html#z44_1">multicastRoutesFor</a>(destAddr);
00331     <span class="keywordflow">if</span> (routes.size()==0)
00332     {
00333         <span class="comment">// no destination: delete datagram</span>
00334         <span class="keyword">delete</span> datagram;
00335     }
00336     <span class="keywordflow">else</span>
00337     {
00338         <span class="comment">// copy original datagram for multiple destinations</span>
00339         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;routes.size(); i++)
00340         {
00341             <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *destIE = routes[i].interf;
00342 
00343             <span class="comment">// don't forward to input port</span>
00344             <span class="keywordflow">if</span> (destIE &amp;&amp; destIE!=fromIE)
00345             {
00346                 <a class="code" href="class_i_p_datagram.html">IPDatagram</a> *datagramCopy = (<a class="code" href="class_i_p_datagram.html">IPDatagram</a> *) datagram-&gt;<a class="code" href="class_i_p_datagram.html#a4">dup</a>();
00347 
00348                 <span class="comment">// set datagram source address if not yet set</span>
00349                 <span class="keywordflow">if</span> (datagramCopy-&gt;<a class="code" href="class_i_p_datagram.html#a11">srcAddress</a>().<a class="code" href="class_i_p_address.html#a1">isUnspecified</a>())
00350                     datagramCopy-&gt;<a class="code" href="class_i_p_datagram.html#a13">setSrcAddress</a>(destIE-&gt;<a class="code" href="class_interface_entry.html#a33">ipv4</a>()-&gt;<a class="code" href="class_i_pv4_interface_data.html#a4">inetAddress</a>());
00351 
00352                 <span class="comment">// send</span>
00353                 <a class="code" href="class_i_p_address.html">IPAddress</a> nextHopAddr = routes[i].gateway;
00354                 <a class="code" href="class_i_p.html#b11">fragmentAndSend</a>(datagramCopy, destIE, nextHopAddr);
00355             }
00356         }
00357 
00358         <span class="comment">// only copies sent, delete original datagram</span>
00359         <span class="keyword">delete</span> datagram;
00360     }
00361 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="IP::routePacket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::routePacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_p_datagram.html">IPDatagram</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datagram</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>destIE</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>fromHL</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Performs routing. Based on the routing decision, it dispatches to <a class="el" href="class_i_p.html#b9">localDeliver()</a> for local packets, to <a class="el" href="class_i_p.html#b11">fragmentAndSend()</a> for forwarded packets, to handleMulticastPacket() for multicast packets, or drops the packet if it's unroutable or forwarding is off. <div class="fragment"><pre class="fragment">00194 {
00195     <span class="comment">// TBD add option handling code here</span>
00196 
00197     <a class="code" href="class_i_p_address.html">IPAddress</a> destAddr = datagram-&gt;<a class="code" href="class_i_p_datagram.html#a14">destAddress</a>();
00198 
00199     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Routing datagram `"</span> &lt;&lt; datagram-&gt;name() &lt;&lt; <span class="stringliteral">"' with dest="</span> &lt;&lt; destAddr &lt;&lt; <span class="stringliteral">": "</span>;
00200 
00201     <span class="comment">// check for local delivery</span>
00202     <span class="keywordflow">if</span> (<a class="code" href="class_i_p.html#p0">rt</a>-&gt;<a class="code" href="class_routing_table.html#z42_0">localDeliver</a>(destAddr))
00203     {
00204         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"local delivery\n"</span>;
00205         <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="class_i_p_datagram.html#a11">srcAddress</a>().<a class="code" href="class_i_p_address.html#a1">isUnspecified</a>())
00206             datagram-&gt;<a class="code" href="class_i_p_datagram.html#a13">setSrcAddress</a>(destAddr); <span class="comment">// allows two apps on the same host to communicate</span>
00207         <a class="code" href="class_i_p.html#p11">numLocalDeliver</a>++;
00208         <a class="code" href="class_i_p.html#b9">localDeliver</a>(datagram);
00209         <span class="keywordflow">return</span>;
00210     }
00211 
00212     <span class="comment">// if datagram arrived from input gate and IP_FORWARD is off, delete datagram</span>
00213     <span class="keywordflow">if</span> (!fromHL &amp;&amp; !<a class="code" href="class_i_p.html#p0">rt</a>-&gt;<a class="code" href="class_routing_table.html#a3">ipForward</a>())
00214     {
00215         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"forwarding off, dropping packet\n"</span>;
00216         <a class="code" href="class_i_p.html#p12">numDropped</a>++;
00217         <span class="keyword">delete</span> datagram;
00218         <span class="keywordflow">return</span>;
00219     }
00220 
00221     <a class="code" href="class_i_p_address.html">IPAddress</a> nextHopAddr;
00222 
00223     <span class="comment">// if output port was explicitly requested, use that, otherwise use IP routing</span>
00224     <span class="keywordflow">if</span> (destIE)
00225     {
00226         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"using manually specified output interface "</span> &lt;&lt; destIE-&gt;<a class="code" href="class_interface_entry.html#a5">name</a>() &lt;&lt; <span class="stringliteral">"\n"</span>;
00227         <span class="comment">// and nextHopAddr remains unspecified</span>
00228     }
00229     <span class="keywordflow">else</span>
00230     {
00231         <span class="comment">// use IP routing (lookup in routing table)</span>
00232         <a class="code" href="class_routing_entry.html">RoutingEntry</a> *re = <a class="code" href="class_i_p.html#p0">rt</a>-&gt;<a class="code" href="class_routing_table.html#z42_1">findBestMatchingRoute</a>(destAddr);
00233 
00234         <span class="comment">// error handling: destination address does not exist in routing table:</span>
00235         <span class="comment">// notify ICMP, throw packet away and continue</span>
00236         <span class="keywordflow">if</span> (re==NULL)
00237         {
00238             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"unroutable, sending ICMP_DESTINATION_UNREACHABLE\n"</span>;
00239             <a class="code" href="class_i_p.html#p13">numUnroutable</a>++;
00240             <a class="code" href="class_i_p.html#p2">icmpAccess</a>.<a class="code" href="class_module_access.html#a1">get</a>()-&gt;<a class="code" href="class_i_c_m_p.html#a0">sendErrorMessage</a>(datagram, ICMP_DESTINATION_UNREACHABLE, 0);
00241             <span class="keywordflow">return</span>;
00242         }
00243 
00244         <span class="comment">// extract interface and next-hop address from routing table entry</span>
00245         destIE = re-&gt;<a class="code" href="class_routing_entry.html#o4">interfacePtr</a>;
00246         nextHopAddr = re-&gt;<a class="code" href="class_routing_entry.html#o2">gateway</a>;
00247     }
00248 
00249     <span class="comment">// set datagram source address if not yet set</span>
00250     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="class_i_p_datagram.html#a11">srcAddress</a>().<a class="code" href="class_i_p_address.html#a1">isUnspecified</a>())
00251         datagram-&gt;<a class="code" href="class_i_p_datagram.html#a13">setSrcAddress</a>(destIE-&gt;<a class="code" href="class_interface_entry.html#a33">ipv4</a>()-&gt;<a class="code" href="class_i_pv4_interface_data.html#a4">inetAddress</a>());
00252 
00253     <span class="comment">// default: send datagram to fragmentation</span>
00254     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"output interface is "</span> &lt;&lt; destIE-&gt;<a class="code" href="class_interface_entry.html#a5">name</a>() &lt;&lt; <span class="stringliteral">", next-hop address: "</span> &lt;&lt; nextHopAddr &lt;&lt; <span class="stringliteral">"\n"</span>;
00255     <a class="code" href="class_i_p.html#p14">numForwarded</a>++;
00256 
00257     <span class="comment">//</span>
00258     <span class="comment">// fragment and send the packet</span>
00259     <span class="comment">//</span>
00260     <a class="code" href="class_i_p.html#b11">fragmentAndSend</a>(datagram, destIE, nextHopAddr);
00261 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b12" doxytag="IP::sendDatagramToOutput"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::sendDatagramToOutput           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_p_datagram.html">IPDatagram</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datagram</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_i_p_address.html">IPAddress</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nextHopAddr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Last TTL check, then send datagram on the given interface. <div class="fragment"><pre class="fragment">00545 {
00546     <span class="comment">// hop counter check</span>
00547     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="class_i_p_datagram.html#a19">timeToLive</a>() &lt;= 0)
00548     {
00549         <span class="comment">// drop datagram, destruction responsibility in ICMP</span>
00550         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"datagram TTL reached zero, sending ICMP_TIME_EXCEEDED\n"</span>;
00551         <a class="code" href="class_i_p.html#p2">icmpAccess</a>.<a class="code" href="class_module_access.html#a1">get</a>()-&gt;<a class="code" href="class_i_c_m_p.html#a0">sendErrorMessage</a>(datagram, ICMP_TIME_EXCEEDED, 0);
00552         <span class="keywordflow">return</span>;
00553     }
00554 
00555     <span class="comment">// send out datagram to ARP, with control info attached</span>
00556     <a class="code" href="class_i_p_routing_decision.html">IPRoutingDecision</a> *routingDecision = <span class="keyword">new</span> <a class="code" href="class_i_p_routing_decision.html">IPRoutingDecision</a>();
00557     routingDecision-&gt;<a class="code" href="class_i_p_routing_decision.html#a7">setInterfaceId</a>(ie-&gt;<a class="code" href="class_interface_entry.html#a4">interfaceId</a>());
00558     routingDecision-&gt;<a class="code" href="class_i_p_routing_decision.html#a10">setNextHopAddr</a>(nextHopAddr);
00559     datagram-&gt;setControlInfo(routingDecision);
00560 
00561     send(datagram, <span class="stringliteral">"queueOut"</span>);
00562 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="IP::sourceInterfaceFrom"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> * IP::sourceInterfaceFrom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00092 {
00093     cGate *g = msg-&gt;arrivalGate();
00094     <span class="keywordflow">return</span> g ? <a class="code" href="class_i_p.html#p1">ift</a>-&gt;<a class="code" href="class_interface_table.html#a8">interfaceByNetworkLayerGateIndex</a>(g-&gt;index()) : NULL;
00095 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="IP::updateDisplayString"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IP::updateDisplayString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00060 {
00061     <span class="keywordtype">char</span> buf[80] = <span class="stringliteral">""</span>;
00062     <span class="keywordflow">if</span> (numForwarded&gt;0) sprintf(buf+strlen(buf), "fwd:%d ", numForwarded);
00063     if (numLocalDeliver&gt;0) sprintf(buf+strlen(buf), "up:%d ", numLocalDeliver);
00064     if (numMulticast&gt;0) sprintf(buf+strlen(buf), "mcast:%d ", numMulticast);
00065     if (numDropped&gt;0) sprintf(buf+strlen(buf), "DROP:%d ", numDropped);
00066     if (numUnroutable&gt;0) sprintf(buf+strlen(buf), "UNROUTABLE:%d ", numUnroutable);
00067     displayString().setTagArg("t",0,buf);
00068 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p6" doxytag="IP::curFragmentId"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_i_p.html#p6">IP::curFragmentId</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p4" doxytag="IP::defaultMCTimeToLive"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_p.html#p4">IP::defaultMCTimeToLive</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="IP::defaultTimeToLive"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_p.html#p3">IP::defaultTimeToLive</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p7" doxytag="IP::fragbuf"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_p_frag_buf.html">IPFragBuf</a> <a class="el" href="class_i_p.html#p7">IP::fragbuf</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p5" doxytag="IP::fragmentTimeoutTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t <a class="el" href="class_i_p.html#p5">IP::fragmentTimeoutTime</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p2" doxytag="IP::icmpAccess"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_c_m_p_access.html">ICMPAccess</a> <a class="el" href="class_i_p.html#p2">IP::icmpAccess</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="IP::ift"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_table.html">InterfaceTable</a>* <a class="el" href="class_i_p.html#p1">IP::ift</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p8" doxytag="IP::lastCheckTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t <a class="el" href="class_i_p.html#p8">IP::lastCheckTime</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p9" doxytag="IP::mapping"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_protocol_mapping.html">ProtocolMapping</a> <a class="el" href="class_i_p.html#p9">IP::mapping</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p12" doxytag="IP::numDropped"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_p.html#p12">IP::numDropped</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p14" doxytag="IP::numForwarded"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_p.html#p14">IP::numForwarded</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p11" doxytag="IP::numLocalDeliver"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_p.html#p11">IP::numLocalDeliver</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p10" doxytag="IP::numMulticast"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_p.html#p10">IP::numMulticast</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p13" doxytag="IP::numUnroutable"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_p.html#p13">IP::numUnroutable</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="IP::rt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_routing_table.html">RoutingTable</a>* <a class="el" href="class_i_p.html#p0">IP::rt</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_network_2_i_pv4_2_i_p_8h.html">Network/IPv4/IP.h</a><li><a class="el" href="_i_p_8cc.html">IP.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:24 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
