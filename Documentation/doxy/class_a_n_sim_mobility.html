<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: ANSimMobility Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>ANSimMobility Class Reference</h1><code>#include &lt;ANSimMobility.h&gt;</code>
<p>
<p>Inheritance diagram for ANSimMobility:
<p><center><img src="class_a_n_sim_mobility.png" usemap="#ANSimMobility_map" border="0" alt=""></center>
<map name="ANSimMobility_map">
<area href="class_line_segments_mobility_base.html" alt="LineSegmentsMobilityBase" shape="rect" coords="0,168,162,192">
<area href="class_basic_mobility.html" alt="BasicMobility" shape="rect" coords="0,112,162,136">
<area href="class_basic_module.html" alt="BasicModule" shape="rect" coords="0,56,162,80">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="0,0,162,24">
</map>
<a href="class_a_n_sim_mobility-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Uses the &lt;position_change&gt; elements of the ANSim tool's trace file. See NED file for more info. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Andras Varga </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_n_sim_mobility.html#b0">initialize</a> (int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes mobility model parameters.  <a href="#b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_n_sim_mobility.html#b1">setTargetPosition</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Overridden from <a class="el" href="class_line_segments_mobility_base.html">LineSegmentsMobilityBase</a>.  <a href="#b1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_n_sim_mobility.html#b2">extractDataFrom</a> (cXMLElement *node)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Utility: extract data from given &lt;position_update&gt; element.  <a href="#b2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_n_sim_mobility.html#b3">fixIfHostGetsOutside</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Overridden from <a class="el" href="class_line_segments_mobility_base.html">LineSegmentsMobilityBase</a>.  <a href="#b3"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_n_sim_mobility.html#p0">nodeId</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">we'll have to compare this to the &lt;node_id&gt; elements  <a href="#p0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cXMLElement *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_n_sim_mobility.html#p1">nextPosChange</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">points to the next &lt;position_change&gt; element  <a href="#p1"></a><br></td></tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b2" doxytag="ANSimMobility::extractDataFrom"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ANSimMobility::extractDataFrom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cXMLElement *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>node</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility: extract data from given &lt;position_update&gt; element. 
<p>
<div class="fragment"><pre class="fragment">00092 {
00093     <span class="comment">// extract data from &lt;position_update&gt; element</span>
00094     <span class="comment">// FIXME start_time has to be taken into account too! as pause from prev element's end_time</span>
00095     <span class="keyword">const</span> <span class="keywordtype">char</span> *startTimeStr = firstChildWithTag(node, <span class="stringliteral">"start_time"</span>)-&gt;getNodeValue();
00096     <span class="keyword">const</span> <span class="keywordtype">char</span> *endTimeStr = firstChildWithTag(node, <span class="stringliteral">"end_time"</span>)-&gt;getNodeValue();
00097     cXMLElement *destElem = firstChildWithTag(node, <span class="stringliteral">"destination"</span>);
00098     <span class="keyword">const</span> <span class="keywordtype">char</span> *xStr = firstChildWithTag(destElem, <span class="stringliteral">"xpos"</span>)-&gt;getNodeValue();
00099     <span class="keyword">const</span> <span class="keywordtype">char</span> *yStr = firstChildWithTag(destElem, <span class="stringliteral">"ypos"</span>)-&gt;getNodeValue();
00100 
00101     <span class="keywordflow">if</span> (!endTimeStr || !xStr || !yStr)
00102         error("no content in &lt;end_time&gt;, &lt;destination&gt;/&lt;xpos&gt; or &lt;ypos&gt; element at %s", node-&gt;getSourceLocation());
00103 
00104     targetTime = atof(endTimeStr);
00105     targetPos.x = atof(xStr);
00106     targetPos.y = atof(yStr);
00107 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="ANSimMobility::fixIfHostGetsOutside"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ANSimMobility::fixIfHostGetsOutside           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Overridden from <a class="el" href="class_line_segments_mobility_base.html">LineSegmentsMobilityBase</a>. 
<p>

<p>
Implements <a class="el" href="class_line_segments_mobility_base.html#b4">LineSegmentsMobilityBase</a>.<div class="fragment"><pre class="fragment">00110 {
00111     <a class="code" href="class_basic_mobility.html#b11">raiseErrorIfOutside</a>();
00112 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="ANSimMobility::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ANSimMobility::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initializes mobility model parameters. 
<p>

<p>
Reimplemented from <a class="el" href="class_line_segments_mobility_base.html#b0">LineSegmentsMobilityBase</a>.<div class="fragment"><pre class="fragment">00038 {
00039     <a class="code" href="class_line_segments_mobility_base.html#b0">LineSegmentsMobilityBase::initialize</a>(stage);
00040 
00041     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"initializing ANSimMobility stage "</span> &lt;&lt; stage &lt;&lt; endl;
00042 
00043     <span class="keywordflow">if</span> (stage == 1)
00044     {
00045         <a class="code" href="class_a_n_sim_mobility.html#p0">nodeId</a> = par(<span class="stringliteral">"nodeId"</span>);
00046         <span class="keywordflow">if</span> (nodeId == -1)
00047             nodeId = parentModule()-&gt;index();
00048 
00049         <span class="comment">// get script: param should point to &lt;simulation&gt; element</span>
00050         cXMLElement *rootElem = par("ansimTrace");
00051         if (strcmp(rootElem-&gt;getTagName(),"simulation")!=0)
00052             error("ansimTrace: &lt;simulation&gt; is expected as root element not &lt;%s&gt; at %s",
00053                   rootElem-&gt;getTagName(), rootElem-&gt;getSourceLocation());
00054         nextPosChange = rootElem-&gt;getElementByPath("mobility/position_change");
00055         if (!nextPosChange)
00056             error("element doesn't have &lt;mobility&gt; child or &lt;position_change&gt; grandchild at %s",
00057                   rootElem-&gt;getSourceLocation());
00058 
00059         <span class="comment">// set initial position;</span>
00060         setTargetPosition();
00061         pos = targetPos;
00062         updatePosition();
00063     }
00064 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="ANSimMobility::setTargetPosition"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ANSimMobility::setTargetPosition           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Overridden from <a class="el" href="class_line_segments_mobility_base.html">LineSegmentsMobilityBase</a>. 
<p>

<p>
Implements <a class="el" href="class_line_segments_mobility_base.html#b3">LineSegmentsMobilityBase</a>.<div class="fragment"><pre class="fragment">00068 {
00069     <span class="comment">// find next &lt;position_update&gt; element with matching &lt;node_id&gt; tag (current one also OK)</span>
00070     <span class="keywordflow">while</span> (nextPosChange)
00071     {
00072         <span class="keyword">const</span> <span class="keywordtype">char</span> *nodeIdStr = firstChildWithTag(nextPosChange, <span class="stringliteral">"node_id"</span>)-&gt;getNodeValue();
00073         <span class="keywordflow">if</span> (nodeIdStr &amp;&amp; atoi(nodeIdStr)==nodeId)
00074             break;
00075         nextPosChange = nextPosChange-&gt;getNextSibling();
00076     }
00077 
00078     if (!nextPosChange)
00079     {
00080         <a class="code" href="class_line_segments_mobility_base.html#p4">stationary</a> = <span class="keyword">true</span>;
00081         <span class="keywordflow">return</span>;
00082     }
00083 
00084     <span class="comment">// extract data from it</span>
00085     <a class="code" href="class_a_n_sim_mobility.html#b2">extractDataFrom</a>(nextPosChange);
00086 
00087     <span class="comment">// skip this one</span>
00088     <a class="code" href="class_a_n_sim_mobility.html#p1">nextPosChange</a> = <a class="code" href="class_a_n_sim_mobility.html#p1">nextPosChange</a>-&gt;getNextSibling();
00089 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p1" doxytag="ANSimMobility::nextPosChange"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cXMLElement* <a class="el" href="class_a_n_sim_mobility.html#p1">ANSimMobility::nextPosChange</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
points to the next &lt;position_change&gt; element 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="ANSimMobility::nodeId"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_a_n_sim_mobility.html#p0">ANSimMobility::nodeId</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
we'll have to compare this to the &lt;node_id&gt; elements 
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_a_n_sim_mobility_8h.html">ANSimMobility.h</a><li><a class="el" href="_a_n_sim_mobility_8cc.html">ANSimMobility.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:21 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
