<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: TCPVirtualDataRcvQueue Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>TCPVirtualDataRcvQueue Class Reference</h1><code>#include &lt;TCPVirtualDataRcvQueue.h&gt;</code>
<p>
<p>Inheritance diagram for TCPVirtualDataRcvQueue:
<p><center><img src="class_t_c_p_virtual_data_rcv_queue.png" usemap="#TCPVirtualDataRcvQueue_map" border="0" alt=""></center>
<map name="TCPVirtualDataRcvQueue_map">
<area href="class_t_c_p_receive_queue.html" alt="TCPReceiveQueue" shape="rect" coords="0,0,159,24">
<area href="class_t_c_p_msg_based_rcv_queue.html" alt="TCPMsgBasedRcvQueue" shape="rect" coords="0,112,159,136">
</map>
<a href="class_t_c_p_virtual_data_rcv_queue-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Receive queue that manages "virtual bytes", that is, byte counts only.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_t_c_p_virtual_data_send_queue.html">TCPVirtualDataSendQueue</a> </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#a0">TCPVirtualDataRcvQueue</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#a1">~TCPVirtualDataRcvQueue</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#a2">init</a> (<a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> startSeq)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#a3">info</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#a4">insertBytesFromSegment</a> (<a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#a5">extractBytesUpTo</a> (<a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> seq)</td></tr>

<tr><td colspan="2"><br><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::list&lt; <a class="el" href="struct_t_c_p_virtual_data_rcv_queue_1_1_region.html">Region</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#x0">RegionList</a></td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#b0">merge</a> (<a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> segmentBegin, <a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> segmentEnd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="namespace_i_n_e_t_fw.html#a7">ulong</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#b1">extractTo</a> (<a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> toSeq)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#p0">rcv_nxt</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#x0">RegionList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a></td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_t_c_p_virtual_data_rcv_queue_1_1_region.html">Region</a></td></tr>

</table>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="x0" doxytag="TCPVirtualDataRcvQueue::RegionList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef std::list&lt;<a class="el" href="struct_t_c_p_virtual_data_rcv_queue_1_1_region.html">Region</a>&gt; <a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#x0">TCPVirtualDataRcvQueue::RegionList</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="TCPVirtualDataRcvQueue::TCPVirtualDataRcvQueue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">TCPVirtualDataRcvQueue::TCPVirtualDataRcvQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Ctor. <div class="fragment"><pre class="fragment">00026                                                : <a class="code" href="class_t_c_p_receive_queue.html#a0">TCPReceiveQueue</a>()
00027 {
00028 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="TCPVirtualDataRcvQueue::~TCPVirtualDataRcvQueue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">TCPVirtualDataRcvQueue::~<a class="el" href="class_t_c_p_virtual_data_rcv_queue.html">TCPVirtualDataRcvQueue</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Virtual dtor. <div class="fragment"><pre class="fragment">00031 {
00032 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a5" doxytag="TCPVirtualDataRcvQueue::extractBytesUpTo"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage * TCPVirtualDataRcvQueue::extractBytesUpTo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>seq</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Should create a packet to be passed up to the app, up to (but NOT including) the given sequence no (usually rcv_nxt). It should return NULL if there's no more data to be passed up -- this method is called several times until it returns NULL. 
<p>
Implements <a class="el" href="class_t_c_p_receive_queue.html#a4">TCPReceiveQueue</a>.
<p>
Reimplemented in <a class="el" href="class_t_c_p_msg_based_rcv_queue.html#a5">TCPMsgBasedRcvQueue</a>.<div class="fragment"><pre class="fragment">00130 {
00131     <a class="code" href="_i_n_e_t_defs_8h.html#a5">ulong</a> numBytes = <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#b1">extractTo</a>(seq);
00132     <span class="keywordflow">if</span> (numBytes==0)
00133         return NULL;
00134 
00135     cMessage *msg = new cMessage("data");
00136     msg-&gt;setByteLength(numBytes);
00137     return msg;
00138 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="TCPVirtualDataRcvQueue::extractTo"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="namespace_i_n_e_t_fw.html#a7">ulong</a> TCPVirtualDataRcvQueue::extractTo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>toSeq</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00141 {
00142     ASSERT(<a class="code" href="_t_c_p_connection_8h.html#a37">seqLE</a>(seq,rcv_nxt));
00143 
00144     RegionList::iterator i = <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.begin();
00145     <span class="keywordflow">if</span> (i==<a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.end())
00146         <span class="keywordflow">return</span> 0;
00147 
00148     ASSERT(i-&gt;begin&lt;i-&gt;end); <span class="comment">// empty regions cannot exist</span>
00149 
00150     <span class="comment">// seq below 1st region</span>
00151     <span class="keywordflow">if</span> (<a class="code" href="_t_c_p_connection_8h.html#a37">seqLE</a>(seq,i-&gt;begin))
00152         return 0;
00153 
00154     if (seqLess(seq,i-&gt;end))
00155     {
00156         <span class="comment">// part of 1st region</span>
00157         <a class="code" href="_i_n_e_t_defs_8h.html#a5">ulong</a> octets = seq - i-&gt;begin;
00158         i-&gt;begin = seq;
00159         <span class="keywordflow">return</span> octets;
00160     }
00161     <span class="keywordflow">else</span>
00162     {
00163         <span class="comment">// full 1st region</span>
00164         <a class="code" href="_i_n_e_t_defs_8h.html#a5">ulong</a> octets = i-&gt;end - i-&gt;begin;
00165         <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.erase(i);
00166         <span class="keywordflow">return</span> octets;
00167     }
00168 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="TCPVirtualDataRcvQueue::info"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::string TCPVirtualDataRcvQueue::info           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns a string with region stored. 
<p>
Reimplemented in <a class="el" href="class_t_c_p_msg_based_rcv_queue.html#a3">TCPMsgBasedRcvQueue</a>.<div class="fragment"><pre class="fragment">00040 {
00041     std::string res;
00042     <span class="keywordtype">char</span> buf[32];
00043     sprintf(buf, <span class="stringliteral">"rcv_nxt=%u "</span>, rcv_nxt);
00044     res = buf;
00045 
00046     <span class="keywordflow">for</span> (RegionList::const_iterator i=<a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.begin(); i!=<a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.end(); ++i)
00047     {
00048         sprintf(buf, <span class="stringliteral">"[%u..%u) "</span>, i-&gt;begin, i-&gt;end);
00049         res+=buf;
00050     }
00051     <span class="keywordflow">return</span> res;
00052 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="TCPVirtualDataRcvQueue::init"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void TCPVirtualDataRcvQueue::init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>startSeq</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set initial receive sequence number. 
<p>
Implements <a class="el" href="class_t_c_p_receive_queue.html#a2">TCPReceiveQueue</a>.
<p>
Reimplemented in <a class="el" href="class_t_c_p_msg_based_rcv_queue.html#a2">TCPMsgBasedRcvQueue</a>.<div class="fragment"><pre class="fragment">00035 {
00036     <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p0">rcv_nxt</a> = startSeq;
00037 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="TCPVirtualDataRcvQueue::insertBytesFromSegment"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> TCPVirtualDataRcvQueue::insertBytesFromSegment           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>tcpseg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called when a <a class="el" href="class_t_c_p.html">TCP</a> segment arrives. Returns sequence number for ACK. 
<p>
Implements <a class="el" href="class_t_c_p_receive_queue.html#a3">TCPReceiveQueue</a>.
<p>
Reimplemented in <a class="el" href="class_t_c_p_msg_based_rcv_queue.html#a4">TCPMsgBasedRcvQueue</a>.<div class="fragment"><pre class="fragment">00055 {
00056     <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#b0">merge</a>(tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8">sequenceNo</a>(), tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a8">sequenceNo</a>()+tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a28">payloadLength</a>());
00057     <span class="keywordflow">if</span> (<a class="code" href="_t_c_p_connection_8h.html#a39">seqGE</a>(rcv_nxt, <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.begin()-&gt;begin))
00058         <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p0">rcv_nxt</a> = <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.begin()-&gt;end;
00059     <span class="keywordflow">return</span> <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p0">rcv_nxt</a>;
00060 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="TCPVirtualDataRcvQueue::merge"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void TCPVirtualDataRcvQueue::merge           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>segmentBegin</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>segmentEnd</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00063 {
00064     <span class="comment">// Here we have to update our existing regions with the octet range</span>
00065     <span class="comment">// tcpseg represents. We either have to insert tcpseg as a separate region</span>
00066     <span class="comment">// somewhere, or (if it overlaps with an existing region) extend</span>
00067     <span class="comment">// existing regions; we also may have to merge existing regions if</span>
00068     <span class="comment">// they become overlapping (or touching) after adding tcpseg.</span>
00069 
00070     Region seg;
00071     seg.begin = segmentBegin;
00072     seg.end = segmentEnd;
00073 
00074     RegionList::iterator i = <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.begin();
00075     <span class="keywordflow">if</span> (i==<a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.end())
00076     {
00077         <span class="comment">// insert as first and only region</span>
00078         <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.insert(<a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.begin(), seg);
00079         <span class="keywordflow">return</span>;
00080     }
00081 
00082     <span class="comment">// skip regions which fall entirely before seg (no overlap or touching)</span>
00083     <span class="keywordflow">while</span> (i!=<a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.end() &amp;&amp; <a class="code" href="_t_c_p_connection_8h.html#a36">seqLess</a>(i-&gt;end,seg.begin))
00084     {
00085         ++i;
00086     }
00087 
00088     <span class="keywordflow">if</span> (i==<a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.end())
00089     {
00090         <span class="comment">// seg is entirely past last region: insert as separate region at end</span>
00091         <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.insert(<a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.end(), seg);
00092         <span class="keywordflow">return</span>;
00093     }
00094 
00095     <span class="keywordflow">if</span> (<a class="code" href="_t_c_p_connection_8h.html#a36">seqLess</a>(seg.end,i-&gt;begin))
00096     {
00097         <span class="comment">// segment entirely before region "i": insert as separate region before "i"</span>
00098         <a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.insert(i, seg);
00099         <span class="keywordflow">return</span>;
00100     }
00101 
00102     <span class="keywordflow">if</span> (<a class="code" href="_t_c_p_connection_8h.html#a36">seqLess</a>(seg.begin,i-&gt;begin))
00103     {
00104         <span class="comment">// segment starts before region "i": extend region</span>
00105         i-&gt;begin = seg.begin;
00106     }
00107 
00108     <span class="keywordflow">if</span> (<a class="code" href="_t_c_p_connection_8h.html#a36">seqLess</a>(i-&gt;end,seg.end))
00109     {
00110         <span class="comment">// segment ends past end of region "i": extend region</span>
00111         i-&gt;end = seg.end;
00112 
00113         <span class="comment">// maybe we have to merge region "i" with next one(s)</span>
00114         RegionList::iterator j = i;
00115         ++j;
00116         <span class="keywordflow">while</span> (j!=<a class="code" href="class_t_c_p_virtual_data_rcv_queue.html#p1">regionList</a>.end() &amp;&amp; <a class="code" href="_t_c_p_connection_8h.html#a39">seqGE</a>(i-&gt;end,j-&gt;begin)) <span class="comment">// while there's overlap</span>
00117         {
00118             <span class="comment">// if "j" is longer: extend "i"</span>
00119             <span class="keywordflow">if</span> (<a class="code" href="_t_c_p_connection_8h.html#a36">seqLess</a>(i-&gt;end,j-&gt;end))
00120                 i-&gt;end = j-&gt;end;
00121 
00122             <span class="comment">// erase "j" (it was merged into "i")</span>
00123             RegionList::iterator oldj = j++;
00124             regionList.erase(oldj);
00125         }
00126     }
00127 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p0" doxytag="TCPVirtualDataRcvQueue::rcv_nxt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> <a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#p0">TCPVirtualDataRcvQueue::rcv_nxt</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="TCPVirtualDataRcvQueue::regionList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#x0">RegionList</a> <a class="el" href="class_t_c_p_virtual_data_rcv_queue.html#p1">TCPVirtualDataRcvQueue::regionList</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_t_c_p_virtual_data_rcv_queue_8h.html">TCPVirtualDataRcvQueue.h</a><li><a class="el" href="_t_c_p_virtual_data_rcv_queue_8cc.html">TCPVirtualDataRcvQueue.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:31 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
