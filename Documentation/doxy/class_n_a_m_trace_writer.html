<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: NAMTraceWriter Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>NAMTraceWriter Class Reference</h1><code>#include &lt;NAMTraceWriter.h&gt;</code>
<p>
<p>Inheritance diagram for NAMTraceWriter:
<p><center><img src="class_n_a_m_trace_writer.png" usemap="#NAMTraceWriter_map" border="0" alt=""></center>
<map name="NAMTraceWriter_map">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="0,0,108,24">
</map>
<a href="class_n_a_m_trace_writer-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Writes a "nam" trace. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#b0">recordNodeEvent</a> (char *state, char *shape)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#b1">recordLinkEvent</a> (int peernamid, double datarate, double delay, char *state)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#b2">recordLinkEvent</a> (<a class="el" href="class_interface_entry.html">InterfaceEntry</a> *ie, char *state)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#b3">recordPacketEvent</a> (const char event, int peernamid, cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#b4">numInitStages</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#b5">initialize</a> (int stage)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#b6">finish</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#b7">receiveChangeNotification</a> (int category, cPolymorphic *details)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#p0">namid</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_n_a_m_trace.html">NAMTrace</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_n_a_m_trace_writer.html#p1">nt</a></td></tr>

</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b6" doxytag="NAMTraceWriter::finish"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void NAMTraceWriter::finish           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00100 {
00101     <span class="keywordflow">if</span> (nt &amp;&amp; <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a4">enabled</a>())
00102     {
00103         <a class="code" href="class_n_a_m_trace_writer.html#b0">recordNodeEvent</a>(<span class="stringliteral">"DOWN"</span>, <span class="stringliteral">"circle"</span>);
00104     }
00105 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="NAMTraceWriter::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void NAMTraceWriter::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>stage</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00033 {
00034     <span class="keywordflow">if</span> (stage==1)  <span class="comment">// let NAMTrace module initialize in stage 0</span>
00035     {
00036         <span class="comment">// get pointer to the NAMTrace module</span>
00037         cModule *namMod = simulation.moduleByPath(<span class="stringliteral">"nam"</span>);
00038         <span class="keywordflow">if</span> (!namMod)
00039         {
00040             <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a> = NULL;
00041             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"NAMTraceWriter: nam module not found, no trace will be written\n"</span>;
00042             <span class="keywordflow">return</span>;
00043         }
00044 
00045         <span class="comment">// store ptr to namtrace module</span>
00046         <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a> = check_and_cast&lt;NAMTrace*&gt;(namMod);
00047 
00048         <span class="comment">// register given namid; -1 means autoconfigure</span>
00049         <span class="keywordtype">int</span> namid0 = par(<span class="stringliteral">"namid"</span>);
00050         cModule *node = parentModule();  <span class="comment">// the host or router</span>
00051         <a class="code" href="class_n_a_m_trace_writer.html#p0">namid</a> = <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a2">assignNamId</a>(node, namid0);
00052         <span class="keywordflow">if</span> (namid0==-1)
00053             par("namid") = namid;  <span class="comment">// let parameter reflect autoconfigured namid</span>
00054 
00055         <span class="comment">// write "node" entry to the trace</span>
00056         if (nt-&gt;enabled())
00057             recordNodeEvent("UP", "circle");
00058 
00059         <span class="comment">// subscribe to the interesting notifications</span>
00060         <a class="code" href="class_notification_board.html">NotificationBoard</a> *nb = <a class="code" href="class_notification_board_access.html">NotificationBoardAccess</a>().get();
00061         nb-&gt;subscribe(this, NF_NODE_FAILURE);
00062         nb-&gt;subscribe(this, NF_NODE_RECOVERY);
00063         nb-&gt;subscribe(this, NF_PP_TX_BEGIN);
00064         nb-&gt;subscribe(this, NF_PP_RX_END);
00065         nb-&gt;subscribe(this, NF_L2_Q_DROP);
00066     }
00067     else if (stage==2 &amp;&amp; nt!=NULL &amp;&amp; nt-&gt;enabled())
00068     {
00069         <span class="comment">// write "link" entries</span>
00070         <a class="code" href="class_interface_table.html">InterfaceTable</a> *ift = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a>().get();
00071         cModule *node = parentModule();  <span class="comment">// the host or router</span>
00072         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ift-&gt;numInterfaces(); i++)
00073         {
00074             <span class="comment">// skip loopback interfaces</span>
00075             <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = ift-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(i);
00076             <span class="keywordflow">if</span> (ie-&gt;<a class="code" href="class_interface_entry.html#a15">isLoopback</a>()) <span class="keywordflow">continue</span>;
00077             <span class="keywordflow">if</span> (!ie-&gt;<a class="code" href="class_interface_entry.html#a14">isPointToPoint</a>()) <span class="keywordflow">continue</span>; <span class="comment">// consider pont-to-point links only</span>
00078 
00079             <span class="comment">// fill in peerNamIds in InterfaceEntries</span>
00080             cGate *outgate = node-&gt;gate(ie-&gt;<a class="code" href="class_interface_entry.html#a7">nodeOutputGateId</a>());
00081             <span class="keywordflow">if</span> (!outgate || !outgate-&gt;toGate()) <span class="keywordflow">continue</span>;
00082             cModule *peernode = outgate-&gt;toGate()-&gt;ownerModule(); <span class="comment">// FIXME not entirely correct: what if a subnet is "boxed"?</span>
00083             cModule *peerwriter = peernode-&gt;submodule(<span class="stringliteral">"namTrace"</span>);
00084             <span class="keywordflow">if</span> (!peerwriter) error("module %s doesn't have a submodule named namTrace", peernode-&gt;fullPath().c_str());
00085             <span class="keywordtype">int</span> peernamid = peerwriter-&gt;par("namid");
00086             ie-&gt;setPeerNamId(peernamid);
00087 
00088             <span class="comment">// find delay</span>
00089             <span class="keywordtype">double</span> delay = 0;
00090             cSimpleChannel *chan = dynamic_cast&lt;cSimpleChannel*&gt;(outgate-&gt;channel());
00091             if (chan) delay = chan-&gt;delay();
00092 
00093             <span class="comment">// write link entry into trace</span>
00094             recordLinkEvent(peernamid, ie-&gt;datarate(), delay, "UP");
00095         }
00096     }
00097 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="NAMTraceWriter::numInitStages"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual int NAMTraceWriter::numInitStages           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00049 {<span class="keywordflow">return</span> 3;}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="NAMTraceWriter::receiveChangeNotification"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void NAMTraceWriter::receiveChangeNotification           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>category</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>cPolymorphic *&nbsp;</td>
          <td class="mdname" nowrap> <em>details</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Redefined <a class="el" href="class_i_notifiable.html">INotifiable</a> method. Called by <a class="el" href="class_notification_board.html">NotificationBoard</a> on changes. 
<p>
Implements <a class="el" href="class_i_notifiable.html#a1">INotifiable</a>.<div class="fragment"><pre class="fragment">00109 {
00110     <span class="comment">// don't do anything if global NAMTrace module doesn't exist or does not have a file open</span>
00111     <span class="keywordflow">if</span> (!nt || !<a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a4">enabled</a>())
00112         <span class="keywordflow">return</span>;
00113 
00114     <a class="code" href="_notifier_consts_8cc.html#a1">printNotificationBanner</a>(category, details);
00115 
00116     <span class="comment">// process notification</span>
00117     <span class="keywordflow">if</span> (category==NF_PP_TX_BEGIN || category==NF_PP_RX_END || category==NF_L2_Q_DROP)
00118     {
00119         <a class="code" href="class_tx_notif_details.html">TxNotifDetails</a> *d = check_and_cast&lt;TxNotifDetails *&gt;(details);
00120         <span class="keywordtype">int</span> peernamid = d-&gt;<a class="code" href="class_tx_notif_details.html#a2">interfaceEntry</a>()-&gt;<a class="code" href="class_interface_entry.html#a9">peerNamId</a>();
00121         cMessage *msg = d-&gt;<a class="code" href="class_tx_notif_details.html#a1">message</a>();
00122 
00123         <span class="keywordflow">switch</span>(category)
00124         {
00125             <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a23a5">NF_PP_TX_BEGIN</a>: <a class="code" href="class_n_a_m_trace_writer.html#b3">recordPacketEvent</a>(<span class="charliteral">'h'</span>, peernamid, msg); <span class="keywordflow">break</span>;
00126             <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a23a7">NF_PP_RX_END</a>:   <a class="code" href="class_n_a_m_trace_writer.html#b3">recordPacketEvent</a>(<span class="charliteral">'r'</span>, peernamid, msg); <span class="keywordflow">break</span>;
00127             <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a23a9">NF_L2_Q_DROP</a>:   <a class="code" href="class_n_a_m_trace_writer.html#b3">recordPacketEvent</a>(<span class="charliteral">'d'</span>, peernamid, msg); <span class="keywordflow">break</span>;
00128         }
00129     }
00130     <span class="keywordflow">else</span>
00131     {
00132         <span class="keywordflow">switch</span>(category)
00133         {
00134             <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a23a1">NF_NODE_FAILURE</a>: <span class="keywordflow">break</span>; <span class="comment">// TODO</span>
00135             <span class="keywordflow">case</span> <a class="code" href="_notifier_consts_8h.html#a23a2">NF_NODE_RECOVERY</a>: <span class="keywordflow">break</span>; <span class="comment">// TODO</span>
00136         }
00137     }
00138 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="NAMTraceWriter::recordLinkEvent"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void NAMTraceWriter::recordLinkEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="NAMTraceWriter::recordLinkEvent"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void NAMTraceWriter::recordLinkEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>peernamid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>datarate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>delay</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00153 {
00154     ASSERT(nt &amp;&amp; <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a4">enabled</a>());
00155     std::ostream&amp; out = <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a5">out</a>();
00156 
00157     <span class="comment">// link entry (to be registered ON ONE END ONLY! This also means that</span>
00158     <span class="comment">// ns2 thinks that datarate and delay must be the same in both directions)</span>
00159     <span class="keywordflow">if</span> (namid &lt; peernamid)
00160         out &lt;&lt; "l -t * -s " &lt;&lt; namid &lt;&lt; " -d " &lt;&lt; peernamid
00161             &lt;&lt; " -S " &lt;&lt; state &lt;&lt; " -r " &lt;&lt; (<span class="keywordtype">int</span>)datarate &lt;&lt; " -D " &lt;&lt; delay &lt;&lt; endl;
00162 
00163     <span class="comment">// queue entry</span>
00164     out &lt;&lt; "q -t * -s " &lt;&lt; namid &lt;&lt; " -d " &lt;&lt; peernamid &lt;&lt; " -a 0 " &lt;&lt; endl;
00165 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="NAMTraceWriter::recordNodeEvent"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void NAMTraceWriter::recordNodeEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>shape</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00141 {
00142     ASSERT(nt &amp;&amp; <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a4">enabled</a>());
00143     std::ostream&amp; out = <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a5">out</a>();
00144     out &lt;&lt; <span class="stringliteral">"n -t "</span>;
00145     <span class="keywordflow">if</span> (simTime() == 0.0)
00146         out &lt;&lt; "*";
00147     else
00148         out &lt;&lt; simTime();
00149     out &lt;&lt; " -s " &lt;&lt; namid &lt;&lt; " -a " &lt;&lt; namid &lt;&lt; " -S " &lt;&lt; state &lt;&lt; " -v " &lt;&lt; shape &lt;&lt; endl;
00150 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="NAMTraceWriter::recordPacketEvent"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void NAMTraceWriter::recordPacketEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char&nbsp;</td>
          <td class="mdname" nowrap> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>peernamid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>cMessage *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00168 {
00169     ASSERT(nt &amp;&amp; <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a4">enabled</a>());
00170     std::ostream&amp; out = <a class="code" href="class_n_a_m_trace_writer.html#p1">nt</a>-&gt;<a class="code" href="class_n_a_m_trace.html#a5">out</a>();
00171 
00172     <span class="keywordtype">int</span> size = msg-&gt;byteLength();
00173     <span class="keywordtype">int</span> color = 0;
00174     <span class="keywordflow">for</span> (cMessage *em = msg; em; em = em-&gt;encapsulatedMsg())
00175         <span class="keywordflow">if</span> (em-&gt;hasPar(<span class="stringliteral">"color"</span>))
00176             {color = em-&gt;par(<span class="stringliteral">"color"</span>).longValue(); <span class="keywordflow">break</span>;}
00177 
00178     out &lt;&lt; event &lt;&lt; <span class="stringliteral">" -t "</span> &lt;&lt; simTime();
00179     <span class="keywordflow">if</span> (event==<span class="charliteral">'h'</span>)
00180         out &lt;&lt; " -s " &lt;&lt; namid &lt;&lt; " -d " &lt;&lt; peernamid;
00181     else
00182         out &lt;&lt; " -s " &lt;&lt; peernamid &lt;&lt; " -d " &lt;&lt; namid;
00183 
00184     out &lt;&lt; " -e " &lt;&lt; size &lt;&lt; " -a " &lt;&lt; color &lt;&lt; endl;
00185 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p0" doxytag="NAMTraceWriter::namid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_n_a_m_trace_writer.html#p0">NAMTraceWriter::namid</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="NAMTraceWriter::nt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_n_a_m_trace.html">NAMTrace</a>* <a class="el" href="class_n_a_m_trace_writer.html#p1">NAMTraceWriter::nt</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_n_a_m_trace_writer_8h.html">NAMTraceWriter.h</a><li><a class="el" href="_n_a_m_trace_writer_8cc.html">NAMTraceWriter.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:27 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
