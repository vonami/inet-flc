<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: BasicDecider Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>BasicDecider Class Reference</h1><code>#include &lt;BasicDecider.h&gt;</code>
<p>
<p>Inheritance diagram for BasicDecider:
<p><center><img src="class_basic_decider.png" usemap="#BasicDecider_map" border="0" alt=""></center>
<map name="BasicDecider_map">
<area href="class_basic_module.html" alt="BasicModule" shape="rect" coords="65,56,185,80">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="65,0,185,24">
<area href="class_decider80211.html" alt="Decider80211" shape="rect" coords="0,168,120,192">
<area href="class_snr_decider.html" alt="SnrDecider" shape="rect" coords="130,168,250,192">
<area href="class_err_and_coll_decider.html" alt="ErrAndCollDecider" shape="rect" coords="130,224,250,248">
</map>
<a href="class_basic_decider-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Module to decide whether a frame is received correctly or is lost due to bit errors, interference... 
<p>
The decider module only handles messages from lower layers. All messages from upper layers are directly passed to the snrEval layer and cannot be processed in the decider module<p>
This is the basic decider module which does not really decide anything. It only provides the basic functionality which all decider modules should have, namely message de- &amp; encapsulation (For further information about the functionality of the physical layer modules and the formats used for communication in between them have a look at "The Design of a Mobility Framework in OMNeT++" paper)<p>
Every own decider module class should be derived from this class and only the handle*Msg functions may be redefined for your own needs. The other functions should usually NOT be changed.<p>
All decider modules should assume bits as a unit for the length fields.<p>
<dl compact><dt><b>Author:</b></dt><dd>Marc Löbbers, Daniel Willkomm </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_decider.html#a0">initialize</a> (int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and some variables.  <a href="#a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_decider.html#a1">handleMessage</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called every time a message arrives.  <a href="#a1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Handle Messages</div></td></tr>
<tr><td colspan="2"><div class="groupText">Functions to redefine by the programmer <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_decider.html#z109_0">handleSelfMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle self messages such as timer...  <a href="#z109_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_decider.html#z109_1">handleLowerMsg</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *, <a class="el" href="_snr_list_8h.html#a0">SnrList</a> &amp;)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">In this function the decision whether a frame is received correctly or not is made.  <a href="#z109_1"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Convenience Functions</div></td></tr>
<tr><td colspan="2"><div class="groupText">Functions for convenience - NOT to be modified<p>
These are functions taking care of message encapsulation and message sending. Normally you should not need to alter these but should use them to handle message encasulation and sending. They will wirte all necessary information into packet headers and add or strip the appropriate headers for each layer. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_decider.html#z111_0">sendUp</a> (<a class="el" href="class_air_frame.html">AirFrame</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to the upper layer.  <a href="#z111_0"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_decider.html#z106_0">uppergateOut</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">gate id  <a href="#z106_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_decider.html#z106_1">lowergateIn</a></td></tr>

<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_decider.html#z107_0">numRcvd</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">statistics  <a href="#z107_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_basic_decider.html#z107_1">numSentUp</a></td></tr>

</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="z109_1" doxytag="BasicDecider::handleLowerMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void BasicDecider::handleLowerMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>frame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="_snr_list_8h.html#a0">SnrList</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>snrList</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
In this function the decision whether a frame is received correctly or not is made. 
<p>
Redefine this function if you want to process messages from the channel before they are forwarded to upper layers<p>
In this function it has to be decided whether this message got lost or not. This can be done with a simple SNR threshold or with transformations of SNR into bit error probabilities...<p>
If you want to forward the message to upper layers please use <a class="el" href="class_basic_decider.html#z111_0">sendUp</a> which will decapsulate the MAC frame before sending 
<p>
Reimplemented in <a class="el" href="class_decider80211.html#b1">Decider80211</a>, <a class="el" href="class_err_and_coll_decider.html#b0">ErrAndCollDecider</a>, and <a class="el" href="class_snr_decider.html#b2">SnrDecider</a>.<div class="fragment"><pre class="fragment">00114 {
00115 
00116     <span class="keywordtype">bool</span> correct = <span class="keyword">true</span>;
00117     <span class="comment">//check the entries in the snrList if a level greater than the</span>
00118     <span class="comment">//acceptable minimum occured:</span>
00119     <span class="keywordtype">double</span> min = 0.0000000000000001;    <span class="comment">// just a senseless example</span>
00120 
00121     <span class="keywordflow">for</span> (SnrList::iterator iter = snrList.begin(); iter != snrList.end(); iter++)
00122     {
00123         <a class="code" href="_basic_module_8cc.html#a0">coreEV</a> &lt;&lt; <span class="stringliteral">"snr="</span> &lt;&lt; iter-&gt;snr &lt;&lt; <span class="stringliteral">"...\n"</span>;
00124         <span class="keywordflow">if</span> (iter-&gt;snr &lt; min)
00125             correct = false;
00126     }
00127 
00128     if (correct)
00129     {
00130         <a class="code" href="_basic_module_8cc.html#a0">coreEV</a> &lt;&lt; <span class="stringliteral">"frame "</span> &lt;&lt; frame-&gt;name() &lt;&lt; <span class="stringliteral">" correct\n"</span>;
00131         <a class="code" href="class_basic_decider.html#z111_0">sendUp</a>(frame);
00132     }
00133     <span class="keywordflow">else</span>
00134     {
00135         <a class="code" href="_basic_module_8cc.html#a0">coreEV</a> &lt;&lt; <span class="stringliteral">"frame "</span> &lt;&lt; frame-&gt;name() &lt;&lt; <span class="stringliteral">" corrupted -&gt; delete\n"</span>;
00136         <span class="keyword">delete</span> frame;
00137     }
00138 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="BasicDecider::handleMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void BasicDecider::handleMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called every time a message arrives. 
<p>
The basic handle message function.<p>
Depending on the gate a message arrives handleMessage just calls different handle*Msg functions to further process the message.<p>
The decider module only handles messages from lower layers. All messages from upper layers are directly passed to the snrEval layer and cannot be processed in the decider module<p>
You should not make any changes in this function but implement all your functionality into the handle*Msg functions called from here.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_basic_decider.html#z109_1">handleLowerMsg</a>, <a class="el" href="class_basic_decider.html#z109_0">handleSelfMsg</a> </dd></dl>
<div class="fragment"><pre class="fragment">00067 {
00068     <span class="keywordflow">if</span> (msg-&gt;arrivalGateId() == <a class="code" href="class_basic_decider.html#z106_1">lowergateIn</a>)
00069     {
00070         <a class="code" href="class_basic_decider.html#z107_0">numRcvd</a>++;
00071 
00072         <span class="comment">//remove the control info from the AirFrame</span>
00073         <a class="code" href="class_snr_control_info.html">SnrControlInfo</a> *cInfo = static_cast&lt;SnrControlInfo *&gt;(msg-&gt;removeControlInfo());
00074 
00075         <span class="comment">// read in the snrList from the control info</span>
00076         <a class="code" href="class_basic_decider.html#z109_1">handleLowerMsg</a>(check_and_cast&lt;AirFrame *&gt;(msg), cInfo-&gt;<a class="code" href="class_snr_control_info.html#a6">getSnrList</a>());
00077 
00078         <span class="comment">// delete the control info</span>
00079         <span class="keyword">delete</span> cInfo;
00080 
00081     }
00082     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;isSelfMessage())
00083     {
00084         <a class="code" href="class_basic_decider.html#z109_0">handleSelfMsg</a>(msg);
00085     }
00086 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z109_0" doxytag="BasicDecider::handleSelfMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual void BasicDecider::handleSelfMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle self messages such as timer... 
<p>
Define this function if you want to timer or other kinds of self messages <div class="fragment"><pre class="fragment">00093 {<span class="keyword">delete</span> msg;};
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="BasicDecider::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void BasicDecider::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>stage</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialization of the module and some variables. 
<p>
First we have to initialize the module from which we derived ours, in this case <a class="el" href="class_basic_module.html">BasicModule</a>.<p>
Then we have to intialize the gates and - if necessary - some own variables. 
<p>
Reimplemented from <a class="el" href="class_basic_module.html#b2">BasicModule</a>.
<p>
Reimplemented in <a class="el" href="class_decider80211.html#b0">Decider80211</a>, and <a class="el" href="class_snr_decider.html#b0">SnrDecider</a>.<div class="fragment"><pre class="fragment">00037 {
00038     <a class="code" href="class_basic_module.html#b2">BasicModule::initialize</a>(stage);
00039 
00040     <span class="keywordflow">if</span> (stage == 0)
00041     {
00042         <a class="code" href="class_basic_decider.html#z106_0">uppergateOut</a> = findGate(<span class="stringliteral">"uppergateOut"</span>);
00043         <a class="code" href="class_basic_decider.html#z106_1">lowergateIn</a> = findGate(<span class="stringliteral">"lowergateIn"</span>);
00044         <a class="code" href="class_basic_decider.html#z107_0">numRcvd</a> = 0;
00045         <a class="code" href="class_basic_decider.html#z107_1">numSentUp</a> = 0;
00046         WATCH(numRcvd);
00047         WATCH(numSentUp);
00048     }
00049 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z111_0" doxytag="BasicDecider::sendUp"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void BasicDecider::sendUp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_air_frame.html">AirFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to the upper layer. 
<p>
Decapsulate and send message to the upper layer.<p>
to be called within <a class="el" href="class_basic_decider.html#z109_1">handleLowerMsg</a>. <div class="fragment"><pre class="fragment">00094 {
00095     <a class="code" href="class_basic_decider.html#z107_1">numSentUp</a>++;
00096     cMessage *macMsg = frame-&gt;decapsulate();
00097     send(macMsg, uppergateOut);
00098     <a class="code" href="_basic_module_8cc.html#a0">coreEV</a> &lt;&lt; <span class="stringliteral">"sending up msg "</span> &lt;&lt; frame-&gt;name() &lt;&lt; endl;
00099     <span class="keyword">delete</span> frame;
00100 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="z106_1" doxytag="BasicDecider::lowergateIn"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_basic_decider.html#z106_1">BasicDecider::lowergateIn</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z107_0" doxytag="BasicDecider::numRcvd"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned long <a class="el" href="class_basic_decider.html#z107_0">BasicDecider::numRcvd</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
statistics 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z107_1" doxytag="BasicDecider::numSentUp"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned long <a class="el" href="class_basic_decider.html#z107_1">BasicDecider::numSentUp</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z106_0" doxytag="BasicDecider::uppergateOut"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_basic_decider.html#z106_0">BasicDecider::uppergateOut</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
gate id 
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_basic_decider_8h.html">BasicDecider.h</a><li><a class="el" href="_basic_decider_8cc.html">BasicDecider.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:21 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
