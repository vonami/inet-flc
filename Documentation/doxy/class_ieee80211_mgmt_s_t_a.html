<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: Ieee80211MgmtSTA Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>Ieee80211MgmtSTA Class Reference</h1><code>#include &lt;Ieee80211MgmtSTA.h&gt;</code>
<p>
<p>Inheritance diagram for Ieee80211MgmtSTA:
<p><center><img src="class_ieee80211_mgmt_s_t_a.png" usemap="#Ieee80211MgmtSTA_map" border="0" alt=""></center>
<map name="Ieee80211MgmtSTA_map">
<area href="class_ieee80211_mgmt_base.html" alt="Ieee80211MgmtBase" shape="rect" coords="69,112,198,136">
<area href="class_passive_queue_base.html" alt="PassiveQueueBase" shape="rect" coords="0,56,129,80">
<area href="class_i_notifiable.html" alt="INotifiable" shape="rect" coords="139,56,268,80">
<area href="class_i_passive_queue.html" alt="IPassiveQueue" shape="rect" coords="0,0,129,24">
</map>
<a href="class_ieee80211_mgmt_s_t_a-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Used in 802.11 infrastructure mode: handles management frames for a station (STA). See corresponding NED file for a detailed description.<p>
<dl compact><dt><b>Author:</b></dt><dd>Andras Varga </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::list&lt; <a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#x0">AccessPointList</a></td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b0">numInitStages</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b1">initialize</a> (int)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b2">handleTimer</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b3">handleUpperMessage</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b4">handleCommand</a> (int msgkind, cPolymorphic *ctrl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_ieee80211_data_frame.html">Ieee80211DataFrame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b5">encapsulate</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b6">startAuthentication</a> (<a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> *ap, double timeout)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b7">startAssociation</a> (<a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> *ap, double timeout)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b8">lookupAP</a> (const <a class="el" href="class_m_a_c_address.html">MACAddress</a> &amp;address)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b9">clearAPList</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b10">changeChannel</a> (int channelNum)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b11">storeAPInfo</a> (const <a class="el" href="class_m_a_c_address.html">MACAddress</a> &amp;address, const <a class="el" href="class_ieee80211_beacon_frame_body.html">Ieee80211BeaconFrameBody</a> &amp;body)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b12">scanNextChannel</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b13">sendProbeRequest</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b14">beaconLost</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b15">sendScanConfirm</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b16">sendAuthenticationConfirm</a> (<a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> *ap, int resultCode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b17">sendAssociationConfirm</a> (<a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> *ap, int resultCode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b18">disassociate</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b19">sendConfirm</a> (<a class="el" href="class_ieee80211_prim_confirm.html">Ieee80211PrimConfirm</a> *confirm, int resultCode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b20">sendManagementFrame</a> (<a class="el" href="class_ieee80211_management_frame.html">Ieee80211ManagementFrame</a> *frame, const <a class="el" href="class_m_a_c_address.html">MACAddress</a> &amp;address)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b21">receiveChangeNotification</a> (int category, cPolymorphic *details)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#b22">statusCodeToPrimResultCode</a> (int statusCode)</td></tr>

<tr><td colspan="2"><div class="groupHeader">Processing of different frame types</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_0">handleDataFrame</a> (<a class="el" href="class_ieee80211_data_frame.html">Ieee80211DataFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_1">handleAuthenticationFrame</a> (<a class="el" href="class_ieee80211_authentication_frame.html">Ieee80211AuthenticationFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_2">handleDeauthenticationFrame</a> (<a class="el" href="class_ieee80211_deauthentication_frame.html">Ieee80211DeauthenticationFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_3">handleAssociationRequestFrame</a> (<a class="el" href="class_ieee80211_association_request_frame.html">Ieee80211AssociationRequestFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_4">handleAssociationResponseFrame</a> (<a class="el" href="class_ieee80211_association_response_frame.html">Ieee80211AssociationResponseFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_5">handleReassociationRequestFrame</a> (<a class="el" href="class_ieee80211_reassociation_request_frame.html">Ieee80211ReassociationRequestFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_6">handleReassociationResponseFrame</a> (<a class="el" href="class_ieee80211_reassociation_response_frame.html">Ieee80211ReassociationResponseFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_7">handleDisassociationFrame</a> (<a class="el" href="class_ieee80211_disassociation_frame.html">Ieee80211DisassociationFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_8">handleBeaconFrame</a> (<a class="el" href="class_ieee80211_beacon_frame.html">Ieee80211BeaconFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_9">handleProbeRequestFrame</a> (<a class="el" href="class_ieee80211_probe_request_frame.html">Ieee80211ProbeRequestFrame</a> *frame)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z101_10">handleProbeResponseFrame</a> (<a class="el" href="class_ieee80211_probe_response_frame.html">Ieee80211ProbeResponseFrame</a> *frame)</td></tr>

<tr><td colspan="2"><div class="groupHeader">Processing of different agent commands</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z103_0">processScanCommand</a> (<a class="el" href="class_ieee80211_prim___scan_request.html">Ieee80211Prim_ScanRequest</a> *ctrl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z103_1">processAuthenticateCommand</a> (<a class="el" href="class_ieee80211_prim___authenticate_request.html">Ieee80211Prim_AuthenticateRequest</a> *ctrl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z103_2">processDeauthenticateCommand</a> (<a class="el" href="class_ieee80211_prim___deauthenticate_request.html">Ieee80211Prim_DeauthenticateRequest</a> *ctrl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z103_3">processAssociateCommand</a> (<a class="el" href="class_ieee80211_prim___associate_request.html">Ieee80211Prim_AssociateRequest</a> *ctrl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z103_4">processReassociateCommand</a> (<a class="el" href="class_ieee80211_prim___reassociate_request.html">Ieee80211Prim_ReassociateRequest</a> *ctrl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#z103_5">processDisassociateCommand</a> (<a class="el" href="class_ieee80211_prim___disassociate_request.html">Ieee80211Prim_DisassociateRequest</a> *ctrl)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_notification_board.html">NotificationBoard</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#p0">nb</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#p1">numChannels</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#p2">isScanning</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html">ScanningInfo</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#x0">AccessPointList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#p5">isAssociated</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#p6">assocTimeoutMsg</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html">AssociatedAPInfo</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a></td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html">AssociatedAPInfo</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html">ScanningInfo</a></td></tr>

</table>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="x0" doxytag="Ieee80211MgmtSTA::AccessPointList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef std::list&lt;<a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a>&gt; <a class="el" href="class_ieee80211_mgmt_s_t_a.html#x0">Ieee80211MgmtSTA::AccessPointList</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b14" doxytag="Ieee80211MgmtSTA::beaconLost"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::beaconLost           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Missed a few consecutive beacons <div class="fragment"><pre class="fragment">00251 {
00252     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Missed a few consecutive beacons -- AP is considered lost\n"</span>;
00253     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_L2_BEACON_LOST, NULL);  <span class="comment">//XXX use InterfaceEntry as detail, etc...</span>
00254 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b10" doxytag="Ieee80211MgmtSTA::changeChannel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::changeChannel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>channelNum</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: switches to the given radio channel. <div class="fragment"><pre class="fragment">00239 {
00240     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Tuning to channel #"</span> &lt;&lt; channelNum &lt;&lt; <span class="stringliteral">"\n"</span>;
00241 
00242     <span class="comment">// sending PHY_C_CONFIGURERADIO command to MAC</span>
00243     <a class="code" href="class_phy_control_info.html">PhyControlInfo</a> *phyCtrl = <span class="keyword">new</span> <a class="code" href="class_phy_control_info.html">PhyControlInfo</a>();
00244     phyCtrl-&gt;<a class="code" href="class_phy_control_info.html#a7">setChannelNumber</a>(channelNum);
00245     cMessage *msg = <span class="keyword">new</span> cMessage(<span class="stringliteral">"changeChannel"</span>, PHY_C_CONFIGURERADIO);
00246     msg-&gt;setControlInfo(phyCtrl);
00247     send(msg, <span class="stringliteral">"macOut"</span>);
00248 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b9" doxytag="Ieee80211MgmtSTA::clearAPList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::clearAPList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: clear the AP list, and cancel any pending authentications. <div class="fragment"><pre class="fragment">00231 {
00232     <span class="keywordflow">for</span> (AccessPointList::iterator it=<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a>.begin(); it!=<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a>.end(); ++it)
00233         <span class="keywordflow">if</span> (it-&gt;authTimeoutMsg)
00234             delete cancelEvent(it-&gt;authTimeoutMsg);
00235     apList.clear();
00236 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b18" doxytag="Ieee80211MgmtSTA::disassociate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::disassociate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: Cancel the existing association <div class="fragment"><pre class="fragment">00519 {
00520     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Disassociating from AP address="</span> &lt;&lt; <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o1">address</a> &lt;&lt; <span class="stringliteral">"\n"</span>;
00521     ASSERT(isAssociated);
00522     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p5">isAssociated</a> = <span class="keyword">false</span>;
00523     <span class="keyword">delete</span> cancelEvent(<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a>);
00524     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a> = NULL;
00525     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a> = AssociatedAPInfo(); <span class="comment">// clear it</span>
00526 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="Ieee80211MgmtSTA::encapsulate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_frame.html">Ieee80211DataFrame</a> * Ieee80211MgmtSTA::encapsulate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function for <a class="el" href="class_ieee80211_mgmt_s_t_a.html#b3">handleUpperMessage()</a> <div class="fragment"><pre class="fragment">00204 {
00205     <a class="code" href="class_ieee80211_data_frame.html">Ieee80211DataFrame</a> *frame = <span class="keyword">new</span> <a class="code" href="class_ieee80211_data_frame.html">Ieee80211DataFrame</a>(msg-&gt;name());
00206 
00207     <span class="comment">// frame goes to the AP</span>
00208     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a10">setToDS</a>(<span class="keyword">true</span>);
00209 
00210     <span class="comment">// receiver is the AP</span>
00211     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a23">setReceiverAddress</a>(<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o1">address</a>);
00212 
00213     <span class="comment">// destination address is in address3</span>
00214     <a class="code" href="class_ieee802_ctrl.html">Ieee802Ctrl</a> *ctrl = check_and_cast&lt;Ieee802Ctrl *&gt;(msg-&gt;removeControlInfo());
00215     frame-&gt;<a class="code" href="class_ieee80211_data_or_mgmt_frame.html#a9">setAddress3</a>(ctrl-&gt;<a class="code" href="class_ieee802_ctrl.html#a9">getDest</a>());
00216     <span class="keyword">delete</span> ctrl;
00217 
00218     frame-&gt;encapsulate(msg);
00219     <span class="keywordflow">return</span> frame;
00220 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_3" doxytag="Ieee80211MgmtSTA::handleAssociationRequestFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleAssociationRequestFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_association_request_frame.html">Ieee80211AssociationRequestFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_3">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00662 {
00663     <a class="code" href="class_ieee80211_mgmt_base.html#b10">dropManagementFrame</a>(frame);
00664 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_4" doxytag="Ieee80211MgmtSTA::handleAssociationResponseFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleAssociationResponseFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_association_response_frame.html">Ieee80211AssociationResponseFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_4">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00667 {
00668     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Received Association Response frame\n"</span>;
00669 
00670     <span class="keywordflow">if</span> (!assocTimeoutMsg)
00671     {
00672         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"No association in progress, ignoring frame\n"</span>;
00673         <span class="keyword">delete</span> frame;
00674         <span class="keywordflow">return</span>;
00675     }
00676 
00677     <span class="comment">// extract frame contents</span>
00678     <a class="code" href="class_m_a_c_address.html">MACAddress</a> address = frame-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a7">getTransmitterAddress</a>();
00679     <span class="keywordtype">int</span> statusCode = frame-&gt;<a class="code" href="class_ieee80211_association_response_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_association_response_frame_body.html#a6">getStatusCode</a>();
00680     <span class="comment">//XXX short aid;</span>
00681     <span class="comment">//XXX Ieee80211SupportedRatesElement supportedRates;</span>
00682     <span class="keyword">delete</span> frame;
00683 
00684     <span class="comment">// look up AP data structure</span>
00685     APInfo *ap = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b8">lookupAP</a>(address);
00686     <span class="keywordflow">if</span> (!ap)
00687         error("handleAssociationResponseFrame: AP not known: address=%s", address.str().c_str());
00688 
00689     if (isAssociated)
00690     {
00691         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Breaking existing association with AP address="</span> &lt;&lt; <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o1">address</a> &lt;&lt; <span class="stringliteral">"\n"</span>;
00692         isAssociated = <span class="keyword">false</span>;
00693         <span class="keyword">delete</span> cancelEvent(<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a>);
00694         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a> = NULL;
00695         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a> = AssociatedAPInfo();
00696     }
00697 
00698     <span class="keyword">delete</span> cancelEvent(assocTimeoutMsg);
00699     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p6">assocTimeoutMsg</a> = NULL;
00700 
00701     <span class="keywordflow">if</span> (statusCode!=SC_SUCCESSFUL)
00702     {
00703         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Association failed with AP address="</span> &lt;&lt; ap-&gt;<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o1">address</a> &lt;&lt; <span class="stringliteral">"\n"</span>;
00704     }
00705     <span class="keywordflow">else</span>
00706     {
00707         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Association successful, AP address="</span> &lt;&lt; ap-&gt;<a class="code" href="class_m_a_c_address.html#r0">address</a> &lt;&lt; <span class="stringliteral">"\n"</span>;
00708 
00709         <span class="comment">// change our state to "associated"</span>
00710         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p5">isAssociated</a> = <span class="keyword">true</span>;
00711         (APInfo&amp;)<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a> = (*ap);
00712 
00713         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p0">nb</a>-&gt;<a class="code" href="class_notification_board.html#z24_0">fireChangeNotification</a>(NF_L2_ASSOCIATED, NULL); <span class="comment">//XXX detail: InterfaceEntry?</span>
00714 
00715         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"beaconTimeout"</span>, MK_BEACON_TIMEOUT);
00716         scheduleAt(simTime()+MAX_BEACONS_MISSED*<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o4">beaconInterval</a>, <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a>);
00717     }
00718 
00719     <span class="comment">// report back to agent</span>
00720     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b17">sendAssociationConfirm</a>(ap, <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b22">statusCodeToPrimResultCode</a>(statusCode));
00721 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_1" doxytag="Ieee80211MgmtSTA::handleAuthenticationFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleAuthenticationFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_authentication_frame.html">Ieee80211AuthenticationFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_1">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00559 {
00560     <a class="code" href="class_m_a_c_address.html">MACAddress</a> address = frame-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a7">getTransmitterAddress</a>();
00561     <span class="keywordtype">int</span> frameAuthSeq = frame-&gt;<a class="code" href="class_ieee80211_authentication_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_authentication_frame_body.html#a6">getSequenceNumber</a>();
00562     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Received Authentication frame from address="</span> &lt;&lt; address &lt;&lt; <span class="stringliteral">", seqNum="</span> &lt;&lt; frameAuthSeq &lt;&lt; <span class="stringliteral">"\n"</span>;
00563 
00564     APInfo *ap = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b8">lookupAP</a>(address);
00565     <span class="keywordflow">if</span> (!ap)
00566     {
00567         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"AP not known, discarding authentication frame\n"</span>;
00568         <span class="keyword">delete</span> frame;
00569         <span class="keywordflow">return</span>;
00570     }
00571 
00572     <span class="comment">// what if already authenticated with AP</span>
00573     <span class="keywordflow">if</span> (ap-&gt;isAuthenticated)
00574     {
00575         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"AP already authenticated, ignoring frame\n"</span>;
00576         <span class="keyword">delete</span> frame;
00577         <span class="keywordflow">return</span>;
00578     }
00579 
00580     <span class="comment">// is authentication is in progress with this AP?</span>
00581     <span class="keywordflow">if</span> (!ap-&gt;authTimeoutMsg)
00582     {
00583         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"No authentication in progress with AP, ignoring frame\n"</span>;
00584         <span class="keyword">delete</span> frame;
00585         <span class="keywordflow">return</span>;
00586     }
00587 
00588     <span class="comment">// check authentication sequence number is OK</span>
00589     <span class="keywordflow">if</span> (frameAuthSeq != ap-&gt;authSeqExpected)
00590     {
00591         <span class="comment">// wrong sequence number: send error and return</span>
00592         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Wrong sequence number, "</span> &lt;&lt; ap-&gt;authSeqExpected &lt;&lt; <span class="stringliteral">" expected\n"</span>;
00593         <a class="code" href="class_ieee80211_authentication_frame.html">Ieee80211AuthenticationFrame</a> *resp = <span class="keyword">new</span> <a class="code" href="class_ieee80211_authentication_frame.html">Ieee80211AuthenticationFrame</a>(<span class="stringliteral">"Auth-ERROR"</span>);
00594         resp-&gt;<a class="code" href="class_ieee80211_authentication_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_authentication_frame_body.html#a9">setStatusCode</a>(SC_AUTH_OUT_OF_SEQ);
00595         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b20">sendManagementFrame</a>(resp, frame-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a7">getTransmitterAddress</a>());
00596         <span class="keyword">delete</span> frame;
00597 
00598         <span class="comment">// cancel timeout, send error to agent</span>
00599         <span class="keyword">delete</span> cancelEvent(ap-&gt;authTimeoutMsg);
00600         ap-&gt;authTimeoutMsg = NULL;
00601         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b16">sendAuthenticationConfirm</a>(ap, PRC_REFUSED); <span class="comment">//XXX or what resultCode?</span>
00602         <span class="keywordflow">return</span>;
00603     }
00604 
00605     <span class="comment">// check if more exchanges are needed for auth to be complete</span>
00606     <span class="keywordtype">int</span> statusCode = frame-&gt;<a class="code" href="class_ieee80211_authentication_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_authentication_frame_body.html#a8">getStatusCode</a>();
00607 
00608     <span class="keywordflow">if</span> (statusCode==SC_SUCCESSFUL &amp;&amp; !frame-&gt;<a class="code" href="class_ieee80211_authentication_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_authentication_frame_body.html#a10">getIsLast</a>())
00609     {
00610         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"More steps required, sending another Authentication frame\n"</span>;
00611 
00612         <span class="comment">// more steps required, send another Authentication frame</span>
00613         <a class="code" href="class_ieee80211_authentication_frame.html">Ieee80211AuthenticationFrame</a> *resp = <span class="keyword">new</span> <a class="code" href="class_ieee80211_authentication_frame.html">Ieee80211AuthenticationFrame</a>(<span class="stringliteral">"Auth"</span>);
00614         resp-&gt;<a class="code" href="class_ieee80211_authentication_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_authentication_frame_body.html#a7">setSequenceNumber</a>(frameAuthSeq+1);
00615         resp-&gt;<a class="code" href="class_ieee80211_authentication_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_authentication_frame_body.html#a9">setStatusCode</a>(SC_SUCCESSFUL);
00616         <span class="comment">// XXX frame length could be increased to account for challenge text length etc.</span>
00617         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b20">sendManagementFrame</a>(resp, address);
00618         ap-&gt;authSeqExpected += 2;
00619     }
00620     <span class="keywordflow">else</span>
00621     {
00622         <span class="keywordflow">if</span> (statusCode==SC_SUCCESSFUL)
00623             EV &lt;&lt; "Authentication successful\n";
00624         else
00625             EV &lt;&lt; "Authentication failed\n";
00626 
00627         <span class="comment">// authentication completed</span>
00628         ap-&gt;isAuthenticated = (statusCode==SC_SUCCESSFUL);
00629         delete cancelEvent(ap-&gt;authTimeoutMsg);
00630         ap-&gt;authTimeoutMsg = NULL;
00631         sendAuthenticationConfirm(ap, statusCodeToPrimResultCode(statusCode));
00632     }
00633 
00634     delete frame;
00635 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_8" doxytag="Ieee80211MgmtSTA::handleBeaconFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleBeaconFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_beacon_frame.html">Ieee80211BeaconFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_8">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00759 {
00760     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Received Beacon frame\n"</span>;
00761     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b11">storeAPInfo</a>(frame-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a7">getTransmitterAddress</a>(), frame-&gt;<a class="code" href="class_ieee80211_beacon_frame.html#a7">getBody</a>());
00762 
00763     <span class="comment">// if it is out associate AP, restart beacon timeout</span>
00764     <span class="keywordflow">if</span> (isAssociated &amp;&amp; frame-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a7">getTransmitterAddress</a>()==<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o1">address</a>)
00765     {
00766         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Beacon is from associated AP, restarting beacon timeout timer\n"</span>;
00767         ASSERT(<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a>!=NULL);
00768         cancelEvent(<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a>);
00769         scheduleAt(simTime()+MAX_BEACONS_MISSED*<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o4">beaconInterval</a>, <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a>);
00770 
00771         <span class="comment">//APInfo *ap = lookupAP(frame-&gt;getTransmitterAddress());</span>
00772         <span class="comment">//ASSERT(ap!=NULL);</span>
00773     }
00774 
00775     <span class="keyword">delete</span> frame;
00776 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="Ieee80211MgmtSTA::handleCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>msgkind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>cPolymorphic *&nbsp;</td>
          <td class="mdname" nowrap> <em>ctrl</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Implements abstract <a class="el" href="class_ieee80211_mgmt_base.html">Ieee80211MgmtBase</a> method 
<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#b5">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00183 {
00184     <span class="keywordflow">if</span> (dynamic_cast&lt;Ieee80211Prim_ScanRequest *&gt;(ctrl))
00185         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#z103_0">processScanCommand</a>((<a class="code" href="class_ieee80211_prim___scan_request.html">Ieee80211Prim_ScanRequest</a> *)ctrl);
00186     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;Ieee80211Prim_AuthenticateRequest *&gt;(ctrl))
00187         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#z103_1">processAuthenticateCommand</a>((<a class="code" href="class_ieee80211_prim___authenticate_request.html">Ieee80211Prim_AuthenticateRequest</a> *)ctrl);
00188     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;Ieee80211Prim_DeauthenticateRequest *&gt;(ctrl))
00189         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#z103_2">processDeauthenticateCommand</a>((<a class="code" href="class_ieee80211_prim___deauthenticate_request.html">Ieee80211Prim_DeauthenticateRequest</a> *)ctrl);
00190     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;Ieee80211Prim_AssociateRequest *&gt;(ctrl))
00191         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#z103_3">processAssociateCommand</a>((<a class="code" href="class_ieee80211_prim___associate_request.html">Ieee80211Prim_AssociateRequest</a> *)ctrl);
00192     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;Ieee80211Prim_ReassociateRequest *&gt;(ctrl))
00193         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#z103_4">processReassociateCommand</a>((<a class="code" href="class_ieee80211_prim___reassociate_request.html">Ieee80211Prim_ReassociateRequest</a> *)ctrl);
00194     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;Ieee80211Prim_DisassociateRequest *&gt;(ctrl))
00195         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#z103_5">processDisassociateCommand</a>((<a class="code" href="class_ieee80211_prim___disassociate_request.html">Ieee80211Prim_DisassociateRequest</a> *)ctrl);
00196     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctrl)
00197         error("handleCommand(): unrecognized control info class `%s'", ctrl-&gt;className());
00198     else
00199         error("handleCommand(): control info is NULL");
00200     delete ctrl;
00201 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_0" doxytag="Ieee80211MgmtSTA::handleDataFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleDataFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_data_frame.html">Ieee80211DataFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_0">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00554 {
00555     <a class="code" href="class_ieee80211_mgmt_base.html#b12">sendUp</a>(<a class="code" href="class_ieee80211_mgmt_base.html#b11">decapsulate</a>(frame));
00556 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_2" doxytag="Ieee80211MgmtSTA::handleDeauthenticationFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleDeauthenticationFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_deauthentication_frame.html">Ieee80211DeauthenticationFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_2">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00638 {
00639     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Received Deauthentication frame\n"</span>;
00640     <span class="keyword">const</span> <a class="code" href="class_m_a_c_address.html">MACAddress</a>&amp; address = frame-&gt;<a class="code" href="class_ieee80211_data_or_mgmt_frame.html#a7">getAddress3</a>();  <span class="comment">// source address</span>
00641     APInfo *ap = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b8">lookupAP</a>(address);
00642     <span class="keywordflow">if</span> (!ap || !ap-&gt;isAuthenticated)
00643     {
00644         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Unknown AP, or not authenticated with that AP -- ignoring frame\n"</span>;
00645         <span class="keyword">delete</span> frame;
00646         <span class="keywordflow">return</span>;
00647     }
00648     <span class="keywordflow">if</span> (ap-&gt;authTimeoutMsg)
00649     {
00650         <span class="keyword">delete</span> cancelEvent(ap-&gt;authTimeoutMsg);
00651         ap-&gt;authTimeoutMsg = NULL;
00652         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Cancelling pending authentication\n"</span>;
00653         <span class="keyword">delete</span> frame;
00654         <span class="keywordflow">return</span>;
00655     }
00656 
00657     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Setting isAuthenticated flag for that AP to false\n"</span>;
00658     ap-&gt;isAuthenticated = <span class="keyword">false</span>;
00659 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_7" doxytag="Ieee80211MgmtSTA::handleDisassociationFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleDisassociationFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_disassociation_frame.html">Ieee80211DisassociationFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_7">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00735 {
00736     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Received Disassociation frame\n"</span>;
00737     <span class="keyword">const</span> <a class="code" href="class_m_a_c_address.html">MACAddress</a>&amp; address = frame-&gt;<a class="code" href="class_ieee80211_data_or_mgmt_frame.html#a7">getAddress3</a>();  <span class="comment">// source address</span>
00738 
00739     <span class="keywordflow">if</span> (assocTimeoutMsg)
00740     {
00741         <span class="comment">// pending association</span>
00742         <span class="keyword">delete</span> cancelEvent(assocTimeoutMsg);
00743         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p6">assocTimeoutMsg</a> = NULL;
00744     }
00745     <span class="keywordflow">if</span> (!isAssociated || address!=<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o1">address</a>)
00746     {
00747         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Not associated with that AP -- ignoring frame\n"</span>;
00748         <span class="keyword">delete</span> frame;
00749         <span class="keywordflow">return</span>;
00750     }
00751 
00752     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Setting isAssociated flag to false\n"</span>;
00753     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p5">isAssociated</a> = <span class="keyword">false</span>;
00754     <span class="keyword">delete</span> cancelEvent(<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a>);
00755     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html#o1">beaconTimeoutMsg</a> = NULL;
00756 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_9" doxytag="Ieee80211MgmtSTA::handleProbeRequestFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleProbeRequestFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_probe_request_frame.html">Ieee80211ProbeRequestFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_9">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00779 {
00780     <a class="code" href="class_ieee80211_mgmt_base.html#b10">dropManagementFrame</a>(frame);
00781 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_10" doxytag="Ieee80211MgmtSTA::handleProbeResponseFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleProbeResponseFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_probe_response_frame.html">Ieee80211ProbeResponseFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_10">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00784 {
00785     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Received Probe Response frame\n"</span>;
00786     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b11">storeAPInfo</a>(frame-&gt;<a class="code" href="class_ieee80211_two_address_frame.html#a7">getTransmitterAddress</a>(), frame-&gt;<a class="code" href="class_ieee80211_probe_response_frame.html#a7">getBody</a>());
00787     <span class="keyword">delete</span> frame;
00788 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_5" doxytag="Ieee80211MgmtSTA::handleReassociationRequestFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleReassociationRequestFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_reassociation_request_frame.html">Ieee80211ReassociationRequestFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_5">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00724 {
00725     <a class="code" href="class_ieee80211_mgmt_base.html#b10">dropManagementFrame</a>(frame);
00726 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z101_6" doxytag="Ieee80211MgmtSTA::handleReassociationResponseFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleReassociationResponseFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_reassociation_response_frame.html">Ieee80211ReassociationResponseFrame</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#z99_6">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00729 {
00730     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Received Reassociation Response frame\n"</span>;
00731     <span class="comment">//TBD handle with the same code as Association Response?</span>
00732 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="Ieee80211MgmtSTA::handleTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Implements abstract <a class="el" href="class_ieee80211_mgmt_base.html">Ieee80211MgmtBase</a> method 
<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#b3">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00112 {
00113     <span class="keywordflow">if</span> (msg-&gt;kind()==<a class="code" href="_ieee80211_mgmt_s_t_a_8cc.html#a0">MK_AUTH_TIMEOUT</a>)
00114     {
00115         <span class="comment">// authentication timed out</span>
00116         APInfo *ap = (APInfo *)msg-&gt;contextPointer();
00117         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Authentication timed out, AP address = "</span> &lt;&lt; ap-&gt;address &lt;&lt; <span class="stringliteral">"\n"</span>;
00118 
00119         <span class="comment">// send back failure report to agent</span>
00120         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b16">sendAuthenticationConfirm</a>(ap, PRC_TIMEOUT);
00121     }
00122     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;kind()==<a class="code" href="_ieee80211_mgmt_s_t_a_8cc.html#a1">MK_ASSOC_TIMEOUT</a>)
00123     {
00124         <span class="comment">// association timed out</span>
00125         APInfo *ap = (APInfo *)msg-&gt;contextPointer();
00126         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Association timed out, AP address = "</span> &lt;&lt; ap-&gt;address &lt;&lt; <span class="stringliteral">"\n"</span>;
00127 
00128         <span class="comment">// send back failure report to agent</span>
00129         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b17">sendAssociationConfirm</a>(ap, PRC_TIMEOUT);
00130     }
00131     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;kind()==<a class="code" href="_ieee80211_mgmt_s_t_a_8cc.html#a4">MK_SCAN_MAXCHANNELTIME</a>)
00132     {
00133         <span class="comment">// go to next channel during scanning</span>
00134         <span class="keywordtype">bool</span> done = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b12">scanNextChannel</a>();
00135         <span class="keywordflow">if</span> (done)
00136             sendScanConfirm(); <span class="comment">// send back response to agents' "scan" command</span>
00137         delete msg;
00138     }
00139     else if (msg-&gt;kind()==MK_SCAN_SENDPROBE)
00140     {
00141         <span class="comment">// Active Scan: send a probe request, then wait for minChannelTime (11.1.3.2.2)</span>
00142         <span class="keyword">delete</span> msg;
00143         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b13">sendProbeRequest</a>();
00144         cMessage *timerMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">"minChannelTime"</span>, MK_SCAN_MINCHANNELTIME);
00145         scheduleAt(simTime()+<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o7">minChannelTime</a>, timerMsg); <span class="comment">//XXX actually, we should start waiting after ProbeReq actually got transmitted</span>
00146     }
00147     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;kind()==<a class="code" href="_ieee80211_mgmt_s_t_a_8cc.html#a3">MK_SCAN_MINCHANNELTIME</a>)
00148     {
00149         <span class="comment">// Active Scan: after minChannelTime, possibly listen for the remaining time until maxChannelTime</span>
00150         <span class="keyword">delete</span> msg;
00151         <span class="keywordflow">if</span> (<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o6">busyChannelDetected</a>)
00152         {
00153             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Busy channel detected during minChannelTime, continuing listening until maxChannelTime elapses\n"</span>;
00154             cMessage *timerMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">"maxChannelTime"</span>, MK_SCAN_MAXCHANNELTIME);
00155             scheduleAt(simTime()+<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o8">maxChannelTime</a> - <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o7">minChannelTime</a>, timerMsg);
00156         }
00157         <span class="keywordflow">else</span>
00158         {
00159             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Channel was empty during minChannelTime, going to next channel\n"</span>;
00160             <span class="keywordtype">bool</span> done = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b12">scanNextChannel</a>();
00161             <span class="keywordflow">if</span> (done)
00162                 sendScanConfirm(); <span class="comment">// send back response to agents' "scan" command</span>
00163         }
00164     }
00165     else if (msg-&gt;kind()==MK_BEACON_TIMEOUT)
00166     {
00167         <span class="comment">// missed a few consecutive beacons</span>
00168         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b14">beaconLost</a>();
00169     }
00170     <span class="keywordflow">else</span>
00171     {
00172         error(<span class="stringliteral">"internal error: unrecognized timer '%s'"</span>, msg-&gt;name());
00173     }
00174 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="Ieee80211MgmtSTA::handleUpperMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::handleUpperMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Implements abstract <a class="el" href="class_ieee80211_mgmt_base.html">Ieee80211MgmtBase</a> method 
<p>
Implements <a class="el" href="class_ieee80211_mgmt_base.html#b4">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00177 {
00178     <a class="code" href="class_ieee80211_data_frame.html">Ieee80211DataFrame</a> *frame = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b5">encapsulate</a>(msg);
00179     <a class="code" href="class_ieee80211_mgmt_base.html#b6">sendOrEnqueue</a>(frame);
00180 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="Ieee80211MgmtSTA::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="class_ieee80211_mgmt_base.html#b1">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00085 {
00086     <a class="code" href="class_passive_queue_base.html#b0">Ieee80211MgmtBase::initialize</a>(stage);
00087     <span class="keywordflow">if</span> (stage==0)
00088     {
00089         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p2">isScanning</a> = <span class="keyword">false</span>;
00090         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p5">isAssociated</a> = <span class="keyword">false</span>;
00091         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p6">assocTimeoutMsg</a> = NULL;
00092 
00093         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p0">nb</a> = <a class="code" href="class_notification_board_access.html">NotificationBoardAccess</a>().get();
00094 
00095         <span class="comment">// determine numChannels (needed when we're told to scan "all" channels)</span>
00096         <span class="comment">//XXX find a better way than directly accessing channelControl</span>
00097         cModule *cc = simulation.moduleByPath(<span class="stringliteral">"channelcontrol"</span>);
00098         <span class="keywordflow">if</span> (cc == NULL)
00099             error("cannot not find <a class="code" href="class_channel_control.html">ChannelControl</a> module");
00100         numChannels = cc-&gt;par("numChannels");
00101 
00102         WATCH(isScanning);
00103         WATCH(isAssociated);
00104 
00105         WATCH(scanning);
00106         WATCH(assocAP);
00107         WATCH_LIST(apList);
00108     }
00109 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b8" doxytag="Ieee80211MgmtSTA::lookupAP"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">Ieee80211MgmtSTA::APInfo</a> * Ieee80211MgmtSTA::lookupAP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_m_a_c_address.html">MACAddress</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>address</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: looks up AP in our AP list. Returns NULL if not found. <div class="fragment"><pre class="fragment">00223 {
00224     <span class="keywordflow">for</span> (AccessPointList::iterator it=<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a>.begin(); it!=<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a>.end(); ++it)
00225         <span class="keywordflow">if</span> (it-&gt;address == address)
00226             return &amp;(*it);
00227     return NULL;
00228 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="Ieee80211MgmtSTA::numInitStages"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual int Ieee80211MgmtSTA::numInitStages           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="class_ieee80211_mgmt_base.html#b0">Ieee80211MgmtBase</a>.<div class="fragment"><pre class="fragment">00107 {<span class="keywordflow">return</span> 2;}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z103_3" doxytag="Ieee80211MgmtSTA::processAssociateCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::processAssociateCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_prim___associate_request.html">Ieee80211Prim_AssociateRequest</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ctrl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00482 {
00483     <span class="keyword">const</span> <a class="code" href="class_m_a_c_address.html">MACAddress</a>&amp; address = ctrl-&gt;<a class="code" href="class_ieee80211_prim___associate_request.html#a6">getAddress</a>();
00484     APInfo *ap = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b8">lookupAP</a>(address);
00485     <span class="keywordflow">if</span> (!ap)
00486         error("processAssociateCommand: AP not known: address = %s", address.str().c_str());
00487     startAssociation(ap, ctrl-&gt;getTimeout());
00488 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z103_1" doxytag="Ieee80211MgmtSTA::processAuthenticateCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::processAuthenticateCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_prim___authenticate_request.html">Ieee80211Prim_AuthenticateRequest</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ctrl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00447 {
00448     <span class="keyword">const</span> <a class="code" href="class_m_a_c_address.html">MACAddress</a>&amp; address = ctrl-&gt;<a class="code" href="class_ieee80211_prim___authenticate_request.html#a6">getAddress</a>();
00449     APInfo *ap = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b8">lookupAP</a>(address);
00450     <span class="keywordflow">if</span> (!ap)
00451         error("processAuthenticateCommand: AP not known: address = %s", address.str().c_str());
00452     startAuthentication(ap, ctrl-&gt;getTimeout());
00453 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z103_2" doxytag="Ieee80211MgmtSTA::processDeauthenticateCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::processDeauthenticateCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_prim___deauthenticate_request.html">Ieee80211Prim_DeauthenticateRequest</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ctrl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00456 {
00457     <span class="keyword">const</span> <a class="code" href="class_m_a_c_address.html">MACAddress</a>&amp; address = ctrl-&gt;<a class="code" href="class_ieee80211_prim___deauthenticate_request.html#a6">getAddress</a>();
00458     APInfo *ap = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b8">lookupAP</a>(address);
00459     <span class="keywordflow">if</span> (!ap)
00460         error("processDeauthenticateCommand: AP not known: address = %s", address.str().c_str());
00461 
00462     if (isAssociated &amp;&amp; assocAP.address==address)
00463         disassociate();
00464 
00465     if (ap-&gt;isAuthenticated)
00466         ap-&gt;isAuthenticated = false;
00467 
00468     <span class="comment">// cancel possible pending authentication timer</span>
00469     if (ap-&gt;authTimeoutMsg)
00470     {
00471         <span class="keyword">delete</span> cancelEvent(ap-&gt;authTimeoutMsg);
00472         ap-&gt;<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o8">authTimeoutMsg</a> = NULL;
00473     }
00474 
00475     <span class="comment">// create and send deauthentication request</span>
00476     <a class="code" href="class_ieee80211_deauthentication_frame.html">Ieee80211DeauthenticationFrame</a> *frame = <span class="keyword">new</span> <a class="code" href="class_ieee80211_deauthentication_frame.html">Ieee80211DeauthenticationFrame</a>(<span class="stringliteral">"Deauth"</span>);
00477     frame-&gt;<a class="code" href="class_ieee80211_deauthentication_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_deauthentication_frame_body.html#a7">setReasonCode</a>(ctrl-&gt;<a class="code" href="class_ieee80211_prim___deauthenticate_request.html#a9">getReasonCode</a>());
00478     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b20">sendManagementFrame</a>(frame, address);
00479 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z103_5" doxytag="Ieee80211MgmtSTA::processDisassociateCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::processDisassociateCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_prim___disassociate_request.html">Ieee80211Prim_DisassociateRequest</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ctrl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00498 {
00499     <span class="keyword">const</span> <a class="code" href="class_m_a_c_address.html">MACAddress</a>&amp; address = ctrl-&gt;<a class="code" href="class_ieee80211_prim___disassociate_request.html#a6">getAddress</a>();
00500 
00501     <span class="keywordflow">if</span> (isAssociated &amp;&amp; address==<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p7">assocAP</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html#o1">address</a>)
00502     {
00503         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b18">disassociate</a>();
00504     }
00505     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assocTimeoutMsg)
00506     {
00507         <span class="comment">// pending association</span>
00508         <span class="keyword">delete</span> cancelEvent(assocTimeoutMsg);
00509         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p6">assocTimeoutMsg</a> = NULL;
00510     }
00511 
00512     <span class="comment">// create and send disassociation request</span>
00513     <a class="code" href="class_ieee80211_disassociation_frame.html">Ieee80211DisassociationFrame</a> *frame = <span class="keyword">new</span> <a class="code" href="class_ieee80211_disassociation_frame.html">Ieee80211DisassociationFrame</a>(<span class="stringliteral">"Disass"</span>);
00514     frame-&gt;<a class="code" href="class_ieee80211_disassociation_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_disassociation_frame_body.html#a7">setReasonCode</a>(ctrl-&gt;<a class="code" href="class_ieee80211_prim___disassociate_request.html#a9">getReasonCode</a>());
00515     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b20">sendManagementFrame</a>(frame, address);
00516 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z103_4" doxytag="Ieee80211MgmtSTA::processReassociateCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::processReassociateCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_prim___reassociate_request.html">Ieee80211Prim_ReassociateRequest</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ctrl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00491 {
00492     <span class="comment">// treat the same way as association</span>
00493     <span class="comment">//XXX refine</span>
00494     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#z103_3">processAssociateCommand</a>(ctrl);
00495 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="z103_0" doxytag="Ieee80211MgmtSTA::processScanCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::processScanCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_prim___scan_request.html">Ieee80211Prim_ScanRequest</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ctrl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00336 {
00337     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Received Scan Request from agent, clearing AP list and starting scanning...\n"</span>;
00338 
00339     <span class="keywordflow">if</span> (isScanning)
00340         error("processScanCommand: scanning already in progress");
00341     if (isAssociated)
00342     {
00343         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b18">disassociate</a>();
00344     }
00345     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assocTimeoutMsg)
00346     {
00347         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Cancelling ongoing association process\n"</span>;
00348         <span class="keyword">delete</span> cancelEvent(assocTimeoutMsg);
00349         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p6">assocTimeoutMsg</a> = NULL;
00350     }
00351 
00352     <span class="comment">// clear existing AP list (and cancel any pending authentications) -- we want to start with a clean page</span>
00353     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b9">clearAPList</a>();
00354 
00355     <span class="comment">// fill in scanning state</span>
00356     ASSERT(ctrl-&gt;<a class="code" href="class_ieee80211_prim___scan_request.html#a6">getBSSType</a>()==<a class="code" href="_ieee80211_primitives__m_8h.html#a49a14">BSSTYPE_INFRASTRUCTURE</a>);
00357     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o0">bssid</a> = ctrl-&gt;<a class="code" href="class_ieee80211_prim___scan_request.html#a8">getBSSID</a>().<a class="code" href="class_m_a_c_address.html#a13">isUnspecified</a>() ? <a class="code" href="class_m_a_c_address.html#s1">MACAddress::BROADCAST_ADDRESS</a> : ctrl-&gt;<a class="code" href="class_ieee80211_prim___scan_request.html#a8">getBSSID</a>();
00358     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o1">ssid</a> = ctrl-&gt;<a class="code" href="class_ieee80211_prim___scan_request.html#a11">getSSID</a>();
00359     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o2">activeScan</a> = ctrl-&gt;<a class="code" href="class_ieee80211_prim___scan_request.html#a13">getActiveScan</a>();
00360     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o3">probeDelay</a> = ctrl-&gt;<a class="code" href="class_ieee80211_prim___scan_request.html#a15">getProbeDelay</a>();
00361     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o4">channelList</a>.clear();
00362     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o7">minChannelTime</a> = ctrl-&gt;<a class="code" href="class_ieee80211_prim___scan_request.html#a21">getMinChannelTime</a>();
00363     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o8">maxChannelTime</a> = ctrl-&gt;<a class="code" href="class_ieee80211_prim___scan_request.html#a23">getMaxChannelTime</a>();
00364     ASSERT(<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o7">minChannelTime</a> &lt;= <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o8">maxChannelTime</a>);
00365 
00366     <span class="comment">// channel list to scan (default: all channels)</span>
00367     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ctrl-&gt;getChannelListArraySize(); i++)
00368         scanning.channelList.push_back(ctrl-&gt;getChannelList(i));
00369     if (scanning.channelList.empty())
00370         for (<span class="keywordtype">int</span> i=0; i&lt;numChannels; i++)
00371             scanning.channelList.push_back(i);
00372 
00373     <span class="comment">// start scanning</span>
00374     if (scanning.activeScan)
00375         nb-&gt;subscribe(this, NF_RADIOSTATE_CHANGED);
00376     scanning.currentChannelIndex = -1; <span class="comment">// so we'll start with index==0</span>
00377     isScanning = true;
00378     scanNextChannel();
00379 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b21" doxytag="Ieee80211MgmtSTA::receiveChangeNotification"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::receiveChangeNotification           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>category</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>cPolymorphic *&nbsp;</td>
          <td class="mdname" nowrap> <em>details</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called by the <a class="el" href="class_notification_board.html">NotificationBoard</a> whenever a change occurs we're interested in 
<p>
Implements <a class="el" href="class_i_notifiable.html#a1">INotifiable</a>.<div class="fragment"><pre class="fragment">00319 {
00320     Enter_Method_Silent();
00321     <a class="code" href="_notifier_consts_8cc.html#a1">printNotificationBanner</a>(category, details);
00322 
00323     <span class="comment">// Note that we are only subscribed during scanning!</span>
00324     <span class="keywordflow">if</span> (category==NF_RADIOSTATE_CHANGED)
00325     {
00326         <a class="code" href="class_radio_state.html#w4">RadioState::State</a> radioState = check_and_cast&lt;RadioState *&gt;(details)-&gt;getState();
00327         <span class="keywordflow">if</span> (radioState==RadioState::RECV)
00328         {
00329             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"busy radio channel detected during scanning\n"</span>;
00330             <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o6">busyChannelDetected</a> = <span class="keyword">true</span>;
00331         }
00332     }
00333 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b12" doxytag="Ieee80211MgmtSTA::scanNextChannel"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool Ieee80211MgmtSTA::scanNextChannel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Switches to the next channel to scan; returns true if done (there wasn't any more channel to scan). <div class="fragment"><pre class="fragment">00382 {
00383     <span class="comment">// if we're already at the last channel, we're through</span>
00384     <span class="keywordflow">if</span> (<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o5">currentChannelIndex</a>==<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o4">channelList</a>.size()-1)
00385     {
00386         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Finished scanning last channel\n"</span>;
00387         <span class="keywordflow">if</span> (<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o2">activeScan</a>)
00388             nb-&gt;unsubscribe(this, NF_RADIOSTATE_CHANGED);
00389         isScanning = false;
00390         return true; <span class="comment">// we're done</span>
00391     }
00392 
00393     <span class="comment">// tune to next channel</span>
00394     <span class="keywordtype">int</span> newChannel = scanning.channelList[++scanning.currentChannelIndex];
00395     changeChannel(newChannel);
00396     scanning.busyChannelDetected = false;
00397 
00398     if (scanning.activeScan)
00399     {
00400         <span class="comment">// Active Scan: first wait probeDelay, then send a probe. Listening</span>
00401         <span class="comment">// for minChannelTime or maxChannelTime takes place after that. (11.1.3.2)</span>
00402         scheduleAt(simTime()+<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o3">probeDelay</a>, <span class="keyword">new</span> cMessage(<span class="stringliteral">"sendProbe"</span>, MK_SCAN_SENDPROBE));
00403     }
00404     <span class="keywordflow">else</span>
00405     {
00406         <span class="comment">// Passive Scan: spend maxChannelTime on the channel (11.1.3.1)</span>
00407         cMessage *timerMsg = <span class="keyword">new</span> cMessage(<span class="stringliteral">"maxChannelTime"</span>, MK_SCAN_MAXCHANNELTIME);
00408         scheduleAt(simTime()+<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o8">maxChannelTime</a>, timerMsg);
00409     }
00410 
00411     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00412 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b17" doxytag="Ieee80211MgmtSTA::sendAssociationConfirm"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::sendAssociationConfirm           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ap</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>resultCode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends back result of association to the agent <div class="fragment"><pre class="fragment">00536 {
00537     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b19">sendConfirm</a>(<span class="keyword">new</span> <a class="code" href="class_ieee80211_prim___associate_confirm.html">Ieee80211Prim_AssociateConfirm</a>(), resultCode);
00538 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b16" doxytag="Ieee80211MgmtSTA::sendAuthenticationConfirm"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::sendAuthenticationConfirm           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ap</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>resultCode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends back result of authentication to the agent <div class="fragment"><pre class="fragment">00529 {
00530     <a class="code" href="class_ieee80211_prim___authenticate_confirm.html">Ieee80211Prim_AuthenticateConfirm</a> *confirm = <span class="keyword">new</span> <a class="code" href="class_ieee80211_prim___authenticate_confirm.html">Ieee80211Prim_AuthenticateConfirm</a>();
00531     confirm-&gt;<a class="code" href="class_ieee80211_prim___authenticate_confirm.html#a8">setAddress</a>(ap-&gt;address);
00532     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b19">sendConfirm</a>(confirm, resultCode);
00533 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b19" doxytag="Ieee80211MgmtSTA::sendConfirm"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::sendConfirm           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_prim_confirm.html">Ieee80211PrimConfirm</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>confirm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>resultCode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: sends a confirmation to the agent <div class="fragment"><pre class="fragment">00541 {
00542     confirm-&gt;<a class="code" href="class_ieee80211_prim_confirm.html#a7">setResultCode</a>(resultCode);
00543     cMessage *msg = <span class="keyword">new</span> cMessage(confirm-&gt;className());
00544     msg-&gt;setControlInfo(confirm);
00545     send(msg, <span class="stringliteral">"agentOut"</span>);
00546 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b20" doxytag="Ieee80211MgmtSTA::sendManagementFrame"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::sendManagementFrame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_management_frame.html">Ieee80211ManagementFrame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>frame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="class_m_a_c_address.html">MACAddress</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: sends a management frame <div class="fragment"><pre class="fragment">00257 {
00258     <span class="comment">// frame goes to the specified AP</span>
00259     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a10">setToDS</a>(<span class="keyword">true</span>);
00260     frame-&gt;<a class="code" href="class_ieee80211_frame.html#a23">setReceiverAddress</a>(address);
00261     <span class="comment">//XXX set sequenceNumber?</span>
00262 
00263     <a class="code" href="class_ieee80211_mgmt_base.html#b6">sendOrEnqueue</a>(frame);
00264 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b13" doxytag="Ieee80211MgmtSTA::sendProbeRequest"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::sendProbeRequest           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Broadcasts a Probe Request <div class="fragment"><pre class="fragment">00415 {
00416     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Sending Probe Request, BSSID="</span> &lt;&lt; <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o0">bssid</a> &lt;&lt; <span class="stringliteral">", SSID=\""</span> &lt;&lt; <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o1">ssid</a> &lt;&lt; <span class="stringliteral">"\"\n"</span>;
00417     <a class="code" href="class_ieee80211_probe_request_frame.html">Ieee80211ProbeRequestFrame</a> *frame = <span class="keyword">new</span> <a class="code" href="class_ieee80211_probe_request_frame.html">Ieee80211ProbeRequestFrame</a>(<span class="stringliteral">"ProbeReq"</span>);
00418     frame-&gt;<a class="code" href="class_ieee80211_probe_request_frame.html#a7">getBody</a>().<a class="code" href="class_ieee80211_probe_request_frame_body.html#a7">setSSID</a>(<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o1">ssid</a>.c_str());
00419     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b20">sendManagementFrame</a>(frame, <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p3">scanning</a>.<a class="code" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html#o0">bssid</a>);
00420 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b15" doxytag="Ieee80211MgmtSTA::sendScanConfirm"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::sendScanConfirm           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends back result of scanning to the agent <div class="fragment"><pre class="fragment">00423 {
00424     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Scanning complete, found "</span> &lt;&lt; <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a>.size() &lt;&lt; <span class="stringliteral">" APs, sending confirmation to agent\n"</span>;
00425 
00426     <span class="comment">// copy apList contents into a ScanConfirm primitive and send it back</span>
00427     <span class="keywordtype">int</span> n = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a>.size();
00428     <a class="code" href="class_ieee80211_prim___scan_confirm.html">Ieee80211Prim_ScanConfirm</a> *confirm = <span class="keyword">new</span> <a class="code" href="class_ieee80211_prim___scan_confirm.html">Ieee80211Prim_ScanConfirm</a>();
00429     confirm-&gt;<a class="code" href="class_ieee80211_prim___scan_confirm.html#a6">setBssListArraySize</a>(n);
00430     AccessPointList::iterator it = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a>.begin();
00431     <span class="comment">//XXX filter for req'd bssid and ssid</span>
00432     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++, it++)
00433     {
00434         APInfo *ap = &amp;(*it);
00435         <a class="code" href="class_ieee80211_prim___b_s_s_description.html">Ieee80211Prim_BSSDescription</a>&amp; bss = confirm-&gt;<a class="code" href="class_ieee80211_prim___scan_confirm.html#a8">getBssList</a>(i);
00436         bss.<a class="code" href="class_ieee80211_prim___b_s_s_description.html#a7">setChannelNumber</a>(ap-&gt;channel);
00437         bss.<a class="code" href="class_ieee80211_prim___b_s_s_description.html#a10">setBSSID</a>(ap-&gt;address);
00438         bss.<a class="code" href="class_ieee80211_prim___b_s_s_description.html#a12">setSSID</a>(ap-&gt;ssid.c_str());
00439         bss.<a class="code" href="class_ieee80211_prim___b_s_s_description.html#a15">setSupportedRates</a>(ap-&gt;supportedRates);
00440         bss.<a class="code" href="class_ieee80211_prim___b_s_s_description.html#a17">setBeaconInterval</a>(ap-&gt;beaconInterval);
00441         bss.<a class="code" href="class_ieee80211_prim___b_s_s_description.html#a19">setRxPower</a>(ap-&gt;rxPower);
00442     }
00443     <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b19">sendConfirm</a>(confirm, PRC_SUCCESS);
00444 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="Ieee80211MgmtSTA::startAssociation"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::startAssociation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ap</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: sends association request <div class="fragment"><pre class="fragment">00293 {
00294     <span class="keywordflow">if</span> (isAssociated || assocTimeoutMsg)
00295         error("startAssociation: already associated or association currently in progress");
00296     if (!ap-&gt;isAuthenticated)
00297         error("startAssociation: not yet authenticated with AP address=", ap-&gt;address.str().c_str());
00298 
00299     <span class="comment">// switch to that channel</span>
00300     changeChannel(ap-&gt;channel);
00301 
00302     <span class="comment">// create and send association request</span>
00303     <a class="code" href="class_ieee80211_association_request_frame.html">Ieee80211AssociationRequestFrame</a> *frame = new <a class="code" href="class_ieee80211_association_request_frame.html">Ieee80211AssociationRequestFrame</a>("Assoc");
00304 
00305     <span class="comment">//XXX set the following too?</span>
00306     <span class="comment">// string SSID</span>
00307     <span class="comment">// Ieee80211SupportedRatesElement supportedRates;</span>
00308 
00309     sendManagementFrame(frame, ap-&gt;address);
00310 
00311     <span class="comment">// schedule timeout</span>
00312     ASSERT(assocTimeoutMsg==NULL);
00313     assocTimeoutMsg = new cMessage("assocTimeout", MK_ASSOC_TIMEOUT);
00314     assocTimeoutMsg-&gt;setContextPointer(ap);
00315     scheduleAt(simTime()+timeout, assocTimeoutMsg);
00316 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b6" doxytag="Ieee80211MgmtSTA::startAuthentication"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::startAuthentication           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_a_p_info.html">APInfo</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ap</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: sends authentication request <div class="fragment"><pre class="fragment">00267 {
00268     <span class="keywordflow">if</span> (ap-&gt;authTimeoutMsg)
00269         error("startAuthentication: authentication currently in progress with AP address=", ap-&gt;address.str().c_str());
00270     if (ap-&gt;isAuthenticated)
00271         error("startAuthentication: already authenticated with AP address=", ap-&gt;address.str().c_str());
00272 
00273     changeChannel(ap-&gt;channel);
00274 
00275     EV &lt;&lt; "Sending initial Authentication frame with seqNum=1\n";
00276 
00277     <span class="comment">// create and send first authentication frame</span>
00278     <a class="code" href="class_ieee80211_authentication_frame.html">Ieee80211AuthenticationFrame</a> *frame = new <a class="code" href="class_ieee80211_authentication_frame.html">Ieee80211AuthenticationFrame</a>("Auth");
00279     frame-&gt;getBody().setSequenceNumber(1);
00280     <span class="comment">//XXX frame length could be increased to account for challenge text length etc.</span>
00281     sendManagementFrame(frame, ap-&gt;address);
00282 
00283     ap-&gt;authSeqExpected = 2;
00284 
00285     <span class="comment">// schedule timeout</span>
00286     ASSERT(ap-&gt;authTimeoutMsg==NULL);
00287     ap-&gt;authTimeoutMsg = new cMessage("authTimeout", MK_AUTH_TIMEOUT);
00288     ap-&gt;authTimeoutMsg-&gt;setContextPointer(ap);
00289     scheduleAt(simTime()+timeout, ap-&gt;authTimeoutMsg);
00290 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b22" doxytag="Ieee80211MgmtSTA::statusCodeToPrimResultCode"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Ieee80211MgmtSTA::statusCodeToPrimResultCode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>statusCode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: converts Ieee80211StatusCode (-&gt;frame) to Ieee80211PrimResultCode (-&gt;primitive) <div class="fragment"><pre class="fragment">00549 {
00550     <span class="keywordflow">return</span> statusCode==<a class="code" href="_ieee80211_mgmt_frames__m_8h.html#a70a10">SC_SUCCESSFUL</a> ? <a class="code" href="_ieee80211_primitives__m_8h.html#a50a16">PRC_SUCCESS</a> : <a class="code" href="_ieee80211_primitives__m_8h.html#a50a20">PRC_REFUSED</a>;
00551 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b11" doxytag="Ieee80211MgmtSTA::storeAPInfo"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Ieee80211MgmtSTA::storeAPInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="class_m_a_c_address.html">MACAddress</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="class_ieee80211_beacon_frame_body.html">Ieee80211BeaconFrameBody</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>body</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Stores AP info received in a beacon or probe response <div class="fragment"><pre class="fragment">00791 {
00792     APInfo *ap = <a class="code" href="class_ieee80211_mgmt_s_t_a.html#b8">lookupAP</a>(address);
00793     <span class="keywordflow">if</span> (ap)
00794     {
00795         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"AP address="</span> &lt;&lt; address &lt;&lt; <span class="stringliteral">", SSID="</span> &lt;&lt; body.<a class="code" href="class_ieee80211_beacon_frame_body.html#a6">getSSID</a>() &lt;&lt; <span class="stringliteral">" already in our AP list, refreshing the info\n"</span>;
00796     }
00797     <span class="keywordflow">else</span>
00798     {
00799         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Inserting AP address="</span> &lt;&lt; address &lt;&lt; <span class="stringliteral">", SSID="</span> &lt;&lt; body.<a class="code" href="class_ieee80211_beacon_frame_body.html#a6">getSSID</a>() &lt;&lt; <span class="stringliteral">" into our AP list\n"</span>;
00800         <a class="code" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a>.push_back(APInfo());
00801         ap = &amp;<a class="code" href="class_ieee80211_mgmt_s_t_a.html#p4">apList</a>.back();
00802     }
00803 
00804     ap-&gt;channel = body.<a class="code" href="class_ieee80211_beacon_frame_body.html#a13">getChannelNumber</a>();
00805     ap-&gt;address = address;
00806     ap-&gt;ssid = body.<a class="code" href="class_ieee80211_beacon_frame_body.html#a6">getSSID</a>();
00807     ap-&gt;supportedRates = body.<a class="code" href="class_ieee80211_beacon_frame_body.html#a8">getSupportedRates</a>();
00808     ap-&gt;beaconInterval = body.<a class="code" href="class_ieee80211_beacon_frame_body.html#a11">getBeaconInterval</a>();
00809 
00810     <span class="comment">//XXX where to get this from?</span>
00811     <span class="comment">//ap-&gt;rxPower = ...</span>
00812 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p4" doxytag="Ieee80211MgmtSTA::apList"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_ieee80211_mgmt_s_t_a.html#x0">AccessPointList</a> <a class="el" href="class_ieee80211_mgmt_s_t_a.html#p4">Ieee80211MgmtSTA::apList</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p7" doxytag="Ieee80211MgmtSTA::assocAP"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_associated_a_p_info.html">AssociatedAPInfo</a> <a class="el" href="class_ieee80211_mgmt_s_t_a.html#p7">Ieee80211MgmtSTA::assocAP</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p6" doxytag="Ieee80211MgmtSTA::assocTimeoutMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="class_ieee80211_mgmt_s_t_a.html#p6">Ieee80211MgmtSTA::assocTimeoutMsg</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p5" doxytag="Ieee80211MgmtSTA::isAssociated"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="class_ieee80211_mgmt_s_t_a.html#p5">Ieee80211MgmtSTA::isAssociated</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p2" doxytag="Ieee80211MgmtSTA::isScanning"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="class_ieee80211_mgmt_s_t_a.html#p2">Ieee80211MgmtSTA::isScanning</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="Ieee80211MgmtSTA::nb"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_notification_board.html">NotificationBoard</a>* <a class="el" href="class_ieee80211_mgmt_s_t_a.html#p0">Ieee80211MgmtSTA::nb</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="Ieee80211MgmtSTA::numChannels"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_ieee80211_mgmt_s_t_a.html#p1">Ieee80211MgmtSTA::numChannels</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="Ieee80211MgmtSTA::scanning"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="struct_ieee80211_mgmt_s_t_a_1_1_scanning_info.html">ScanningInfo</a> <a class="el" href="class_ieee80211_mgmt_s_t_a.html#p3">Ieee80211MgmtSTA::scanning</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_ieee80211_mgmt_s_t_a_8h.html">Ieee80211MgmtSTA.h</a><li><a class="el" href="_ieee80211_mgmt_s_t_a_8cc.html">Ieee80211MgmtSTA.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:23 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
