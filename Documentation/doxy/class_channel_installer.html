<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: ChannelInstaller Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>ChannelInstaller Class Reference</h1><code>#include &lt;ChannelInstaller.h&gt;</code>
<p>
<a href="class_channel_installer-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Replaces channel objects in the network.<p>
This module is a temporary solution until the NED infrastructure gets extended to accomodate channel classes.<p>
<dl compact><dt><b>Author:</b></dt><dd>Andras Varga </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_channel_installer.html#b0">initialize</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_channel_installer.html#b1">handleMessage</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual cChannel *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_channel_installer.html#b2">createReplacementChannelFor</a> (cChannel *channel)</td></tr>

</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b2" doxytag="ChannelInstaller::createReplacementChannelFor"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cChannel * ChannelInstaller::createReplacementChannelFor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cChannel *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>channel</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00047 {
00048     cBasicChannel *oldchan = dynamic_cast&lt;cBasicChannel *&gt;(channel);
00049     <span class="keywordflow">if</span> (!oldchan)
00050         return channel;
00051 
00052     <span class="comment">// create new channel object of the given class, and take over the original object's attributes</span>
00053     const <span class="keywordtype">char</span> *channelClassName = par("channelClass");
00054     cBasicChannel *newchan = check_and_cast&lt;cBasicChannel *&gt;(createOne(channelClassName));
00055     newchan-&gt;setName(oldchan-&gt;name());
00056     newchan-&gt;setError(oldchan-&gt;error());
00057     newchan-&gt;setDelay(oldchan-&gt;delay());
00058     newchan-&gt;setDatarate(oldchan-&gt;datarate());
00059 
00060     <span class="comment">// parse the "attr=value;attr=value;.." string, and set the given attributes on the channel</span>
00061     const <span class="keywordtype">char</span> *attrs = par("channelAttrs");
00062     cStringTokenizer tok(attrs,";");
00063     while (tok.hasMoreTokens())
00064     {
00065         cStringTokenizer tok2(tok.nextToken(), <span class="stringliteral">"="</span>);
00066         <span class="keyword">const</span> <span class="keywordtype">char</span> *attrname = tok2.nextToken();
00067         <span class="keyword">const</span> <span class="keywordtype">char</span> *value = tok2.nextToken();
00068         cPar&amp; p = newchan-&gt;addPar(attrname);
00069         <span class="keywordflow">if</span> (!p.setFromText(value))
00070             p.setStringValue(value);
00071     }
00072 
00073     <span class="keywordflow">return</span> newchan;
00074 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="ChannelInstaller::handleMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ChannelInstaller::handleMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00077 {
00078 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="ChannelInstaller::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ChannelInstaller::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00025 {
00026     <span class="keywordtype">int</span> count = 0;
00027     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;=simulation.lastModuleId(); i++)
00028     {
00029         cModule *mod = simulation.module(i);
00030         <span class="keywordflow">if</span> (!mod) continue;
00031         <span class="keywordtype">int</span> numGates = mod-&gt;gates();
00032         for (<span class="keywordtype">int</span> j=0; j&lt;numGates; j++)
00033         {
00034             cGate *g = mod-&gt;gate(j);
00035             <span class="keywordflow">if</span> (!g) continue;
00036             cChannel *channel = g-&gt;channel();
00037             if (!channel) continue;
00038             g-&gt;setChannel(createReplacementChannelFor(channel));
00039             count++;
00040         }
00041     }
00042 
00043     EV &lt;&lt; "<a class="code" href="class_channel_installer.html">ChannelInstaller</a> replaced " &lt;&lt; count &lt;&lt; " channel objects.\n";
00044 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_channel_installer_8h.html">ChannelInstaller.h</a><li><a class="el" href="_channel_installer_8cc.html">ChannelInstaller.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:21 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
