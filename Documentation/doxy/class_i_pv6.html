<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: IPv6 Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>IPv6 Class Reference</h1><code>#include &lt;IPv6.h&gt;</code>
<p>
<p>Inheritance diagram for IPv6:
<p><center><img src="class_i_pv6.png" usemap="#IPv6_map" border="0" alt=""></center>
<map name="IPv6_map">
<area href="class_queue_base.html" alt="QueueBase" shape="rect" coords="0,56,97,80">
<area href="class_abstract_queue.html" alt="AbstractQueue" shape="rect" coords="0,0,97,24">
</map>
<a href="class_i_pv6-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
IPv6 implementation. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#a0">IPv6</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b0">sourceInterfaceFrom</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b1">updateDisplayString</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b2">encapsulate</a> (cMessage *transportPacket, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&amp;destIE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b3">handleDatagramFromNetwork</a> (<a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b4">handleMessageFromHL</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b5">handleReceivedICMP</a> (<a class="el" href="class_i_c_m_pv6_message.html">ICMPv6Message</a> *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b6">fragmentAndRoute</a> (<a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *destIE=NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b7">routePacket</a> (<a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *destIE, bool fromHL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b8">routeMulticastPacket</a> (<a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *destIE, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *fromIE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b9">localDeliver</a> (<a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b10">decapsulate</a> (<a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b11">sendDatagramToOutput</a> (<a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram, <a class="el" href="class_interface_entry.html">InterfaceEntry</a> *ie, const <a class="el" href="class_m_a_c_address.html">MACAddress</a> &amp;macAddr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b12">initialize</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#b13">endService</a> (cMessage *msg)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_interface_table.html">InterfaceTable</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p0">ift</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_routing_table6.html">RoutingTable6</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p1">rt</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_pv6_neighbour_discovery.html">IPv6NeighbourDiscovery</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p2">nd</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_c_m_pv6.html">ICMPv6</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p3">icmp</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p4">curFragmentId</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_i_pv6_frag_buf.html">IPv6FragBuf</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p5">fragbuf</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p6">lastCheckTime</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_protocol_mapping.html">ProtocolMapping</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p7">mapping</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p8">numMulticast</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p9">numLocalDeliver</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p10">numDropped</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p11">numUnroutable</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_pv6.html#p12">numForwarded</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="IPv6::IPv6"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">IPv6::IPv6           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00125 {}
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b10" doxytag="IPv6::decapsulate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage * IPv6::decapsulate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>datagram</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Decapsulate and return encapsulated packet after attaching <a class="el" href="class_i_pv6_control_info.html">IPv6ControlInfo</a>. <div class="fragment"><pre class="fragment">00480 {
00481     <span class="comment">// decapsulate transport packet</span>
00482     <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *fromIE = <a class="code" href="class_i_pv6.html#b0">sourceInterfaceFrom</a>(datagram);
00483     cMessage *packet = datagram-&gt;decapsulate();
00484 
00485     <span class="comment">// create and fill in control info</span>
00486     <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a>();
00487     controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a4">setProtocol</a>(datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a16">transportProtocol</a>());
00488     controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a10">setSrcAddr</a>(datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a4">srcAddress</a>());
00489     controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a7">setDestAddr</a>(datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a7">destAddress</a>());
00490     controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a12">setHopLimit</a>(datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a14">hopLimit</a>());
00491     controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a14">setInterfaceId</a>(fromIE ? fromIE-&gt;<a class="code" href="class_interface_entry.html#a4">interfaceId</a>() : -1);
00492 
00493     <span class="comment">// original IP datagram might be needed in upper layers to send back ICMP error message</span>
00494     controlInfo-&gt;<a class="code" href="class_i_pv6_control_info.html#a4">setOrigDatagram</a>(datagram);
00495 
00496     <span class="comment">// attach control info</span>
00497     packet-&gt;setControlInfo(controlInfo);
00498 
00499     <span class="keywordflow">return</span> packet;
00500 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="IPv6::encapsulate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> * IPv6::encapsulate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname" nowrap> <em>transportPacket</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>destIE</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Encapsulate packet coming from higher layers into <a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> <div class="fragment"><pre class="fragment">00503 {
00504     <a class="code" href="class_i_pv6_control_info.html">IPv6ControlInfo</a> *controlInfo = check_and_cast&lt;IPv6ControlInfo*&gt;(transportPacket-&gt;removeControlInfo());
00505 
00506     <a class="code" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram = <span class="keyword">new</span> <a class="code" href="class_i_pv6_datagram.html">IPv6Datagram</a>(transportPacket-&gt;name());
00507     datagram-&gt;setByteLength(datagram-&gt;<a class="code" href="class_i_pv6_datagram.html#a9">calculateHeaderByteLength</a>());
00508     datagram-&gt;encapsulate(transportPacket);
00509 
00510     <span class="comment">// IPV6_MULTICAST_IF option, but allow interface selection for unicast packets as well</span>
00511     destIE = <a class="code" href="class_i_pv6.html#p0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a13">interfaceId</a>());
00512 
00513     <span class="comment">// set source and destination address</span>
00514     <a class="code" href="class_i_pv6_address.html">IPv6Address</a> dest = controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a5">destAddr</a>();
00515     datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a9">setDestAddress</a>(dest);
00516 
00517     <a class="code" href="class_i_pv6_address.html">IPv6Address</a> src = controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a8">srcAddr</a>();
00518 
00519     <span class="comment">// when source address was given, use it; otherwise it'll get the address</span>
00520     <span class="comment">// of the outgoing interface after routing</span>
00521     <span class="keywordflow">if</span> (!src.<a class="code" href="class_i_pv6_address.html#a22">isUnspecified</a>())
00522     {
00523         <span class="comment">// if interface parameter does not match existing interface, do not send datagram</span>
00524         <span class="keywordflow">if</span> (<a class="code" href="class_i_pv6.html#p1">rt</a>-&gt;<a class="code" href="class_routing_table6.html#z52_0">interfaceByAddress</a>(src)==NULL)
00525             opp_error(<span class="stringliteral">"Wrong source address %s in (%s)%s: no interface with such address"</span>,
00526                       src.<a class="code" href="class_i_pv6_address.html#a11">str</a>().c_str(), transportPacket-&gt;className(), transportPacket-&gt;fullName());
00527         datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a6">setSrcAddress</a>(src);
00528     }
00529 
00530     <span class="comment">// set other fields</span>
00531     datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a15">setHopLimit</a>(controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a11">hopLimit</a>()&gt;0 ? controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a11">hopLimit</a>() : 32); <span class="comment">//FIXME use iface hop limit instead of 32?</span>
00532     datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a17">setTransportProtocol</a>(controlInfo-&gt;<a class="code" href="class_i_pv6_control_info___base.html#a3">protocol</a>());
00533     <span class="keyword">delete</span> controlInfo;
00534 
00535     <span class="comment">// setting IP options is currently not supported</span>
00536 
00537     <span class="keywordflow">return</span> datagram;
00538 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b13" doxytag="IPv6::endService"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::endService           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Processing of IPv6 datagrams. Called when a datagram reaches the front of the queue. 
<p>
Implements <a class="el" href="class_abstract_queue.html#z14_3">AbstractQueue</a>.<div class="fragment"><pre class="fragment">00074 {
00075     <span class="keywordflow">if</span> (msg-&gt;arrivalGate()-&gt;isName(<span class="stringliteral">"transportIn"</span>) ||
00076        (msg-&gt;arrivalGate()-&gt;isName(<span class="stringliteral">"ndIn"</span>) &amp;&amp; dynamic_cast&lt;IPv6NDMessage*&gt;(msg)) ||
00077        (msg-&gt;arrivalGate()-&gt;isName(<span class="stringliteral">"icmpIn"</span>) &amp;&amp; dynamic_cast&lt;ICMPv6Message*&gt;(msg)))<span class="comment">//Added this for ICMP msgs from ICMP module-WEI</span>
00078     {
00079         <span class="comment">// packet from upper layers or ND: encapsulate and send out</span>
00080         <a class="code" href="class_i_pv6.html#b4">handleMessageFromHL</a>(msg);
00081     }
00082     <span class="keywordflow">else</span>
00083     {
00084         <span class="comment">// datagram from network or from ND: localDeliver and/or route</span>
00085         <a class="code" href="class_i_pv6_datagram.html">IPv6Datagram</a> *dgram = check_and_cast&lt;IPv6Datagram *&gt;(msg);
00086         <a class="code" href="class_i_pv6.html#b3">handleDatagramFromNetwork</a>(dgram);
00087     }
00088 
00089     <span class="keywordflow">if</span> (ev.isGUI())
00090         <a class="code" href="class_i_pv6.html#b1">updateDisplayString</a>();
00091 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b6" doxytag="IPv6::fragmentAndRoute"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::fragmentAndRoute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datagram</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>destIE</em> = <code>NULL</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fragment packet if needed, then send it. The optional output gate index is only used if higher layer protocol explicitly requests the datagram to be sent out on a specific interface, bypassing the routing table. <div class="fragment"><pre class="fragment">00147 {
00148 <span class="comment">/*</span>
00149 <span class="comment">FIXME implement fragmentation here.</span>
00150 <span class="comment">   1. determine output interface</span>
00151 <span class="comment">   2. compare packet size with interface MTU</span>
00152 <span class="comment">   3. if bigger, do fragmentation</span>
00153 <span class="comment">         int mtu = ift-&gt;interfaceByPortNo(outputGateIndex)-&gt;mtu();</span>
00154 <span class="comment">*/</span>
00155     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"fragmentation not implemented yet\n"</span>;
00156 
00157     <span class="comment">// route packet</span>
00158     <span class="keywordflow">if</span> (destIE!=NULL)
00159         sendDatagramToOutput(datagram, destIE, <a class="code" href="class_m_a_c_address.html">MACAddress</a>::BROADCAST_ADDRESS); <span class="comment">// FIXME what MAC address to use?</span>
00160     else if (!datagram-&gt;destAddress().isMulticast())
00161         routePacket(datagram, destIE, true);
00162     else
00163         routeMulticastPacket(datagram, destIE, NULL);
00164 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="IPv6::handleDatagramFromNetwork"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::handleDatagramFromNetwork           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>datagram</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle <a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> messages arriving from lower layer. Decrements TTL, then invokes <a class="el" href="class_i_pv6.html#b7">routePacket()</a>. <div class="fragment"><pre class="fragment">00100 {
00101     <span class="comment">// check for header biterror</span>
00102     <span class="keywordflow">if</span> (datagram-&gt;hasBitError())
00103     {
00104         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"bit error\n"</span>;<span class="keywordflow">return</span>; <span class="comment">// revise!</span>
00105 <span class="comment">/*FIXME revise</span>
00106 <span class="comment">        // probability of bit error in header = size of header / size of total message</span>
00107 <span class="comment">        // (ignore bit error if in payload)</span>
00108 <span class="comment">        double relativeHeaderLength = datagram-&gt;headerLength() / (double)datagram-&gt;byteLength();</span>
00109 <span class="comment">        if (dblrand() &lt;= relativeHeaderLength)</span>
00110 <span class="comment">        {</span>
00111 <span class="comment">            EV &lt;&lt; "bit error found, sending ICMP_PARAMETER_PROBLEM\n";</span>
00112 <span class="comment">            icmp-&gt;sendErrorMessage(datagram, ICMP_PARAMETER_PROBLEM, 0);</span>
00113 <span class="comment">            return;</span>
00114 <span class="comment">        }</span>
00115 <span class="comment">*/</span>
00116     }
00117 
00118     <span class="comment">// remove control info</span>
00119     <span class="keyword">delete</span> datagram-&gt;removeControlInfo();
00120 
00121     <span class="comment">// routepacket</span>
00122     <span class="keywordflow">if</span> (!datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a7">destAddress</a>().<a class="code" href="class_i_pv6_address.html#a23">isMulticast</a>())
00123         <a class="code" href="class_i_pv6.html#b7">routePacket</a>(datagram, NULL, <span class="keyword">false</span>);
00124     <span class="keywordflow">else</span>
00125         <a class="code" href="class_i_pv6.html#b8">routeMulticastPacket</a>(datagram, NULL, <a class="code" href="class_i_pv6.html#b0">sourceInterfaceFrom</a>(datagram));
00126 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="IPv6::handleMessageFromHL"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::handleMessageFromHL           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages (typically packets to be send in IPv6) from transport or <a class="el" href="class_i_c_m_p.html">ICMP</a>. Invokes <a class="el" href="class_i_pv6.html#b2">encapsulate()</a>, then <a class="el" href="class_i_pv6.html#b7">routePacket()</a>. <div class="fragment"><pre class="fragment">00129 {
00130     <span class="comment">// if no interface exists, do not send datagram</span>
00131     <span class="keywordflow">if</span> (<a class="code" href="class_i_pv6.html#p0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a4">numInterfaces</a>() == 0)
00132     {
00133         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"No interfaces exist, dropping packet\n"</span>;
00134         <span class="keyword">delete</span> msg;
00135         <span class="keywordflow">return</span>;
00136     }
00137 
00138     <span class="comment">// encapsulate upper-layer packet into IPv6Datagram</span>
00139     <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *destIE; <span class="comment">// to be filled in by encapsulate()</span>
00140     <a class="code" href="class_i_pv6_datagram.html">IPv6Datagram</a> *datagram = <a class="code" href="class_i_pv6.html#b2">encapsulate</a>(msg, destIE);
00141 
00142     <span class="comment">// possibly fragment (in IPv6, only the source node does that), then route it</span>
00143     <a class="code" href="class_i_pv6.html#b6">fragmentAndRoute</a>(datagram, destIE);
00144 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="IPv6::handleReceivedICMP"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::handleReceivedICMP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_c_m_pv6_message.html">ICMPv6Message</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle incoming <a class="el" href="class_i_c_m_p.html">ICMP</a> messages. <div class="fragment"><pre class="fragment">00452 {
00453     <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="class_i_c_m_pv6_message.html#a7">type</a>())
00454     {
00455         <span class="keywordflow">case</span> <a class="code" href="_i_c_m_pv6_message__m_8h.html#a41a16">ICMPv6_REDIRECT</a>:  <span class="comment">// TODO implement redirect handling</span>
00456         <span class="keywordflow">case</span> <a class="code" href="_i_c_m_pv6_message__m_8h.html#a41a3">ICMPv6_DESTINATION_UNREACHABLE</a>:
00457         <span class="keywordflow">case</span> <a class="code" href="_i_c_m_pv6_message__m_8h.html#a41a4">ICMPv6_PACKET_TOO_BIG</a>:
00458         <span class="keywordflow">case</span> <a class="code" href="_i_c_m_pv6_message__m_8h.html#a41a5">ICMPv6_TIME_EXCEEDED</a>:
00459         <span class="keywordflow">case</span> <a class="code" href="_i_c_m_pv6_message__m_8h.html#a41a6">ICMPv6_PARAMETER_PROBLEM</a>: {
00460             <span class="comment">// ICMP errors are delivered to the appropriate higher layer protocols</span>
00461             <a class="code" href="class_i_pv6_datagram.html">IPv6Datagram</a> *bogusPacket = check_and_cast&lt;IPv6Datagram *&gt;(msg-&gt;encapsulatedMsg());
00462             <span class="keywordtype">int</span> protocol = bogusPacket-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a16">transportProtocol</a>();
00463             <span class="keywordtype">int</span> gateindex = <a class="code" href="class_i_pv6.html#p7">mapping</a>.<a class="code" href="class_protocol_mapping.html#a3">outputGateForProtocol</a>(protocol);
00464             send(msg, <span class="stringliteral">"transportOut"</span>, gateindex);
00465             <span class="keywordflow">break</span>;
00466         }
00467         <span class="keywordflow">default</span>: {
00468             <span class="comment">// all others are delivered to ICMP:</span>
00469             <span class="comment">// ICMPv6_ECHO_REQUEST, ICMPv6_ECHO_REPLY, ICMPv6_MLD_QUERY, ICMPv6_MLD_REPORT,</span>
00470             <span class="comment">// ICMPv6_MLD_DONE, ICMPv6_ROUTER_SOL, ICMPv6_ROUTER_AD, ICMPv6_NEIGHBOUR_SOL,</span>
00471             <span class="comment">// ICMPv6_NEIGHBOUR_AD, ICMPv6_MLDv2_REPORT</span>
00472             <span class="keywordtype">int</span> gateindex = <a class="code" href="class_i_pv6.html#p7">mapping</a>.<a class="code" href="class_protocol_mapping.html#a3">outputGateForProtocol</a>(IP_PROT_ICMP);
00473             send(msg, <span class="stringliteral">"transportOut"</span>, gateindex);
00474         }
00475      }
00476 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b12" doxytag="IPv6::initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialization 
<p>
Reimplemented from <a class="el" href="class_queue_base.html#b0">QueueBase</a>.<div class="fragment"><pre class="fragment">00039 {
00040     <a class="code" href="class_queue_base.html#b0">QueueBase::initialize</a>();
00041 
00042     <a class="code" href="class_i_pv6.html#p0">ift</a> = <a class="code" href="class_interface_table_access.html">InterfaceTableAccess</a>().get();
00043     <a class="code" href="class_i_pv6.html#p1">rt</a> = <a class="code" href="class_routing_table6_access.html">RoutingTable6Access</a>().get();
00044     <a class="code" href="class_i_pv6.html#p2">nd</a> = <a class="code" href="class_i_pv6_neighbour_discovery_access.html">IPv6NeighbourDiscoveryAccess</a>().get();
00045     <a class="code" href="structicmp.html">icmp</a> = <a class="code" href="class_i_c_m_pv6_access.html">ICMPv6Access</a>().get();
00046 
00047     <a class="code" href="class_i_pv6.html#p7">mapping</a>.<a class="code" href="class_protocol_mapping.html#a2">parseProtocolMapping</a>(par(<span class="stringliteral">"protocolMapping"</span>));
00048 
00049     <a class="code" href="class_i_pv6.html#p4">curFragmentId</a> = 0;
00050     <a class="code" href="class_i_pv6.html#p6">lastCheckTime</a> = 0;
00051     <a class="code" href="class_i_pv6.html#p5">fragbuf</a>.<a class="code" href="class_i_pv6_frag_buf.html#a2">init</a>(<a class="code" href="structicmp.html">icmp</a>);
00052 
00053     <a class="code" href="class_i_pv6.html#p8">numMulticast</a> = <a class="code" href="class_i_pv6.html#p9">numLocalDeliver</a> = <a class="code" href="class_i_pv6.html#p10">numDropped</a> = <a class="code" href="class_i_pv6.html#p11">numUnroutable</a> = <a class="code" href="class_i_pv6.html#p12">numForwarded</a> = 0;
00054 
00055     WATCH(numMulticast);
00056     WATCH(numLocalDeliver);
00057     WATCH(numDropped);
00058     WATCH(numUnroutable);
00059     WATCH(numForwarded);
00060 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b9" doxytag="IPv6::localDeliver"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::localDeliver           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>datagram</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Perform reassembly of fragmented datagrams, then send them up to the higher layers using sendToHL(). <div class="fragment"><pre class="fragment">00398 {
00399 <span class="comment">/* FIXME revise and complete defragmentation</span>
00400 <span class="comment">    // Defragmentation. skip defragmentation if datagram is not fragmented</span>
00401 <span class="comment">    if (datagram-&gt;fragmentOffset()!=0 || datagram-&gt;moreFragments())</span>
00402 <span class="comment">    {</span>
00403 <span class="comment">        EV &lt;&lt; "Datagram fragment: offset=" &lt;&lt; datagram-&gt;fragmentOffset()</span>
00404 <span class="comment">           &lt;&lt; ", MORE=" &lt;&lt; (datagram-&gt;moreFragments() ? "true" : "false") &lt;&lt; ".\n";</span>
00405 <span class="comment"></span>
00406 <span class="comment">        // erase timed out fragments in fragmentation buffer; check every 10 seconds max</span>
00407 <span class="comment">        if (simTime() &gt;= lastCheckTime + 10)</span>
00408 <span class="comment">        {</span>
00409 <span class="comment">            lastCheckTime = simTime();</span>
00410 <span class="comment">            fragbuf.purgeStaleFragments(simTime()-FRAGMENT_TIMEOUT);</span>
00411 <span class="comment">        }</span>
00412 <span class="comment"></span>
00413 <span class="comment">        datagram = fragbuf.addFragment(datagram, simTime());</span>
00414 <span class="comment">        if (!datagram)</span>
00415 <span class="comment">        {</span>
00416 <span class="comment">            EV &lt;&lt; "No complete datagram yet.\n";</span>
00417 <span class="comment">            return;</span>
00418 <span class="comment">        }</span>
00419 <span class="comment">        EV &lt;&lt; "This fragment completes the datagram.\n";</span>
00420 <span class="comment">    }</span>
00421 <span class="comment">*/</span>
00422     <span class="comment">// decapsulate and send on appropriate output gate</span>
00423     <span class="keywordtype">int</span> protocol = datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a16">transportProtocol</a>();
00424     cMessage *packet = <a class="code" href="class_i_pv6.html#b10">decapsulate</a>(datagram);
00425 
00426     <span class="keywordflow">if</span> (protocol==IP_PROT_IPv6_ICMP &amp;&amp; dynamic_cast&lt;IPv6NDMessage*&gt;(packet))
00427     {
00428         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Neigbour Discovery packet: passing it to ND module\n"</span>;
00429         send(packet, <span class="stringliteral">"ndOut"</span>);
00430     }
00431     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (protocol==IP_PROT_IPv6_ICMP &amp;&amp; dynamic_cast&lt;ICMPv6Message*&gt;(packet))
00432     {
00433         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"ICMPv6 packet: passing it to ICMPv6 module\n"</span>;
00434         send(packet, <span class="stringliteral">"icmpOut"</span>);
00435     }<span class="comment">//Added by WEI to forward ICMPv6 msgs to ICMPv6 module.</span>
00436     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (protocol==IP_PROT_IP || protocol==IP_PROT_IPv6)
00437     {
00438         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Tunnelled IP datagram\n"</span>;
00439         <span class="comment">// FIXME handle tunnelling</span>
00440         error(<span class="stringliteral">"tunnelling not yet implemented"</span>);
00441     }
00442     <span class="keywordflow">else</span>
00443     {
00444         <span class="keywordtype">int</span> gateindex = <a class="code" href="class_i_pv6.html#p7">mapping</a>.<a class="code" href="class_protocol_mapping.html#a3">outputGateForProtocol</a>(protocol);
00445         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Protocol "</span> &lt;&lt; protocol &lt;&lt; <span class="stringliteral">", passing up on gate "</span> &lt;&lt; gateindex &lt;&lt; <span class="stringliteral">"\n"</span>;
00446         <span class="comment">//TODO: Indication of forward progress</span>
00447         send(packet, <span class="stringliteral">"transportOut"</span>, gateindex);
00448     }
00449 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b8" doxytag="IPv6::routeMulticastPacket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::routeMulticastPacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datagram</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>destIE</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>fromIE</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Forwards packets to all multicast destinations, using fragmentAndSend(). <div class="fragment"><pre class="fragment">00273 {
00274     <span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; destAddr = datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a7">destAddress</a>();
00275 
00276     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"destination address "</span> &lt;&lt; destAddr &lt;&lt; <span class="stringliteral">" is multicast, doing multicast routing\n"</span>;
00277     <a class="code" href="class_i_pv6.html#p8">numMulticast</a>++;
00278 
00279     <span class="comment">// if received from the network...</span>
00280     <span class="keywordflow">if</span> (fromIE!=NULL)
00281     {
00282         <span class="comment">// deliver locally</span>
00283         <span class="keywordflow">if</span> (<a class="code" href="class_i_pv6.html#p1">rt</a>-&gt;<a class="code" href="class_routing_table6.html#z54_0">localDeliver</a>(destAddr))
00284         {
00285             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"local delivery of multicast packet\n"</span>;
00286             <a class="code" href="class_i_pv6.html#p9">numLocalDeliver</a>++;
00287             <a class="code" href="class_i_pv6.html#b9">localDeliver</a>((<a class="code" href="class_i_pv6_datagram.html">IPv6Datagram</a> *)datagram-&gt;<a class="code" href="class_i_pv6_datagram.html#a3">dup</a>());
00288         }
00289 
00290         <span class="comment">// if datagram arrived from input gate and IP forwarding is off, delete datagram</span>
00291         <span class="keywordflow">if</span> (!<a class="code" href="class_i_pv6.html#p1">rt</a>-&gt;<a class="code" href="class_routing_table6.html#a2">isRouter</a>())
00292         {
00293             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"forwarding is off\n"</span>;
00294             <span class="keyword">delete</span> datagram;
00295             <span class="keywordflow">return</span>;
00296         }
00297 
00298         <span class="comment">// make sure scope of multicast address is large enough to be forwarded to other links</span>
00299         <span class="keywordflow">if</span> (destAddr.multicastScope()&lt;=2)
00300         {
00301             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"multicast dest address is link-local (or smaller) scope\n"</span>;
00302             <span class="keyword">delete</span> datagram;
00303             <span class="keywordflow">return</span>;
00304         }
00305 
00306         <span class="comment">// hop counter decrement: only if datagram arrived from network, and will be</span>
00307         <span class="comment">// sent out to the network (hoplimit check will be done just before sending</span>
00308         <span class="comment">// out datagram)</span>
00309         <span class="comment">// TBD: in IPv4, arrange TTL check like this</span>
00310         datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a15">setHopLimit</a>(datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a14">hopLimit</a>()-1);
00311     }
00312 
00313     <span class="comment">// for now, we just send it out on every interface except on which it came. FIXME better!!!</span>
00314     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"sending out datagram on every interface (except incoming one)\n"</span>;
00315     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ift-&gt;numInterfaces(); i++)
00316     {
00317         <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = <a class="code" href="class_i_pv6.html#p0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(i);
00318         <span class="keywordflow">if</span> (fromIE!=ie)
00319             sendDatagramToOutput((<a class="code" href="class_i_pv6_datagram.html">IPv6Datagram</a> *)datagram-&gt;dup(), ie, <a class="code" href="class_m_a_c_address.html">MACAddress</a>::BROADCAST_ADDRESS);
00320     }
00321     delete datagram;
00322 
00323 <span class="comment">/* FIXME implement handling of multicast</span>
00324 <span class="comment"></span>
00325 <span class="comment">    According to Gopi: "multicast routing table" should map</span>
00326 <span class="comment">       srcAddr+multicastDestAddr to a set of next hops (interface+nexthopAddr)</span>
00327 <span class="comment">    Where srcAddr is the multicast server, and destAddr sort of narrows it down to a given stream</span>
00328 <span class="comment"></span>
00329 <span class="comment">    // FIXME multicast--&gt;tunneling link (present in original IPSuite) missing from here</span>
00330 <span class="comment"></span>
00331 <span class="comment">    // DVMRP: process datagram only if sent locally or arrived on the shortest</span>
00332 <span class="comment">    // route (provided routing table already contains srcAddr); otherwise</span>
00333 <span class="comment">    // discard and continue.</span>
00334 <span class="comment">    int inputGateIndex = datagram-&gt;arrivalGate() ? datagram-&gt;arrivalGate()-&gt;index() : -1;</span>
00335 <span class="comment">    int shortestPathInputGateIndex = rt-&gt;outputGateIndexNo(datagram-&gt;srcAddress());</span>
00336 <span class="comment">    if (inputGateIndex!=-1 &amp;&amp; shortestPathInputGateIndex!=-1 &amp;&amp; inputGateIndex!=shortestPathInputGateIndex)</span>
00337 <span class="comment">    {</span>
00338 <span class="comment">        // FIXME count dropped</span>
00339 <span class="comment">        EV &lt;&lt; "Packet dropped.\n";</span>
00340 <span class="comment">        delete datagram;</span>
00341 <span class="comment">        return;</span>
00342 <span class="comment">    }</span>
00343 <span class="comment"></span>
00344 <span class="comment">    // check for local delivery</span>
00345 <span class="comment">    IPv6Address destAddress = datagram-&gt;destAddress();</span>
00346 <span class="comment">    if (rt-&gt;multicastLocalDeliver(destAddress))</span>
00347 <span class="comment">    {</span>
00348 <span class="comment">        IPv6Datagram *datagramCopy = (IPv6Datagram *) datagram-&gt;dup();</span>
00349 <span class="comment"></span>
00350 <span class="comment">        // FIXME code from the MPLS model: set packet dest address to routerId (???)</span>
00351 <span class="comment">        datagramCopy-&gt;setDestAddress(rt-&gt;routerId());</span>
00352 <span class="comment"></span>
00353 <span class="comment">        localDeliver(datagramCopy);</span>
00354 <span class="comment">    }</span>
00355 <span class="comment"></span>
00356 <span class="comment">    // forward datagram only if IP forward is enabled, or sent locally</span>
00357 <span class="comment">    if (inputGateIndex!=-1 &amp;&amp; !rt-&gt;isRouter())</span>
00358 <span class="comment">    {</span>
00359 <span class="comment">        delete datagram;</span>
00360 <span class="comment">        return;</span>
00361 <span class="comment">    }</span>
00362 <span class="comment"></span>
00363 <span class="comment">    MulticastRoutes routes = rt-&gt;multicastRoutesFor(destAddress);</span>
00364 <span class="comment">    if (routes.size()==0)</span>
00365 <span class="comment">    {</span>
00366 <span class="comment">        // no destination: delete datagram</span>
00367 <span class="comment">        delete datagram;</span>
00368 <span class="comment">    }</span>
00369 <span class="comment">    else</span>
00370 <span class="comment">    {</span>
00371 <span class="comment">        // copy original datagram for multiple destinations</span>
00372 <span class="comment">        for (unsigned int i=0; i&lt;routes.size(); i++)</span>
00373 <span class="comment">        {</span>
00374 <span class="comment">            int outputGateIndex = routes[i].interf-&gt;outputGateIndex();</span>
00375 <span class="comment"></span>
00376 <span class="comment">            // don't forward to input port</span>
00377 <span class="comment">            if (outputGateIndex&gt;=0 &amp;&amp; outputGateIndex!=inputGateIndex)</span>
00378 <span class="comment">            {</span>
00379 <span class="comment">                IPv6Datagram *datagramCopy = (IPv6Datagram *) datagram-&gt;dup();</span>
00380 <span class="comment"></span>
00381 <span class="comment">                // set datagram source address if not yet set</span>
00382 <span class="comment">                if (datagramCopy-&gt;srcAddress().isUnspecified())</span>
00383 <span class="comment">                    datagramCopy-&gt;setSrcAddress(ift-&gt;interfaceByPortNo(outputGateIndex)-&gt;ipv6()-&gt;inetAddress());</span>
00384 <span class="comment"></span>
00385 <span class="comment">                // send</span>
00386 <span class="comment">                IPv6Address nextHopAddr = routes[i].gateway;</span>
00387 <span class="comment">                sendDatagramToOutput(datagramCopy, outputGateIndex, macAddr);</span>
00388 <span class="comment">            }</span>
00389 <span class="comment">        }</span>
00390 <span class="comment"></span>
00391 <span class="comment">        // only copies sent, delete original datagram</span>
00392 <span class="comment">        delete datagram;</span>
00393 <span class="comment">    }</span>
00394 <span class="comment">*/</span>
00395 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="IPv6::routePacket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::routePacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datagram</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>destIE</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>fromHL</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Performs routing. Based on the routing decision, it dispatches to <a class="el" href="class_i_pv6.html#b9">localDeliver()</a> for local packets, to fragmentAndSend() for forwarded packets, to <a class="el" href="class_i_pv6.html#b8">routeMulticastPacket()</a> for multicast packets, or drops the packet if it's unroutable or forwarding is off. <div class="fragment"><pre class="fragment">00167 {
00168     <span class="comment">// TBD add option handling code here</span>
00169     <a class="code" href="class_i_pv6_address.html">IPv6Address</a> destAddress = datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a7">destAddress</a>();
00170 
00171     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"Routing datagram `"</span> &lt;&lt; datagram-&gt;name() &lt;&lt; <span class="stringliteral">"' with dest="</span> &lt;&lt; destAddress &lt;&lt; <span class="stringliteral">": "</span>;
00172 
00173     <span class="comment">// local delivery of unicast packets</span>
00174     <span class="keywordflow">if</span> (<a class="code" href="class_i_pv6.html#p1">rt</a>-&gt;<a class="code" href="class_routing_table6.html#z54_0">localDeliver</a>(destAddress))
00175     {
00176         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"local delivery\n"</span>;
00177         <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a4">srcAddress</a>().<a class="code" href="class_i_pv6_address.html#a22">isUnspecified</a>())
00178             datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a6">setSrcAddress</a>(destAddress); <span class="comment">// allows two apps on the same host to communicate</span>
00179         <a class="code" href="class_i_pv6.html#p9">numLocalDeliver</a>++;
00180         <a class="code" href="class_i_pv6.html#b9">localDeliver</a>(datagram);
00181         <span class="keywordflow">return</span>;
00182     }
00183 
00184     <span class="keywordflow">if</span> (!fromHL)
00185     {
00186         <span class="comment">// if datagram arrived from input gate and IP forwarding is off, delete datagram</span>
00187         <span class="comment">//yes but datagrams from the ND module is getting dropped too!-WEI</span>
00188         <span class="comment">//so we add a 2nd condition</span>
00189         <span class="comment">// FIXME rewrite code so that condition is cleaner --Andras</span>
00190         <span class="comment">//if (!rt-&gt;isRouter())</span>
00191         <span class="keywordflow">if</span> (!<a class="code" href="class_i_pv6.html#p1">rt</a>-&gt;<a class="code" href="class_routing_table6.html#a2">isRouter</a>() &amp;&amp; !(datagram-&gt;arrivalGate()-&gt;isName(<span class="stringliteral">"ndIn"</span>)))
00192         {
00193             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"forwarding is off, dropping packet\n"</span>;
00194             <a class="code" href="class_i_pv6.html#p10">numDropped</a>++;
00195             <span class="keyword">delete</span> datagram;
00196             <span class="keywordflow">return</span>;
00197         }
00198 
00199         <span class="comment">// don't forward link-local addresses or weaker</span>
00200         <span class="keywordflow">if</span> (destAddress.<a class="code" href="class_i_pv6_address.html#a26">isLinkLocal</a>() || destAddress.<a class="code" href="class_i_pv6_address.html#a25">isLoopback</a>())
00201         {
00202             <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"dest address is link-local (or weaker) scope, doesn't get forwarded\n"</span>;
00203             <span class="keyword">delete</span> datagram;
00204             <span class="keywordflow">return</span>;
00205         }
00206 
00207         <span class="comment">// hop counter decrement: only if datagram arrived from network, and will be</span>
00208         <span class="comment">// sent out to the network (hoplimit check will be done just before sending</span>
00209         <span class="comment">// out datagram)</span>
00210         <span class="comment">// TBD: in IPv4, arrange TTL check like this</span>
00211         datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a15">setHopLimit</a>(datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a14">hopLimit</a>()-1);
00212     }
00213 
00214     <span class="comment">// routing</span>
00215     <span class="comment">// first try destination cache</span>
00216     <span class="keywordtype">int</span> interfaceId;
00217     <a class="code" href="class_i_pv6_address.html">IPv6Address</a> nextHop = <a class="code" href="class_i_pv6.html#p1">rt</a>-&gt;<a class="code" href="class_routing_table6.html#z54_1">lookupDestCache</a>(destAddress, interfaceId);
00218     <span class="keywordflow">if</span> (interfaceId==-1)
00219     {
00220         <span class="comment">// address not in destination cache: do longest prefix match in routing table</span>
00221         <span class="keyword">const</span> <a class="code" href="class_i_pv6_route.html">IPv6Route</a> *route = <a class="code" href="class_i_pv6.html#p1">rt</a>-&gt;<a class="code" href="class_routing_table6.html#z54_2">doLongestPrefixMatch</a>(destAddress);
00222         <span class="keywordflow">if</span> (!route)
00223         {
00224             <span class="keywordflow">if</span> (<a class="code" href="class_i_pv6.html#p1">rt</a>-&gt;<a class="code" href="class_routing_table6.html#a2">isRouter</a>())
00225             {
00226                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"unroutable, sending ICMPv6_DESTINATION_UNREACHABLE\n"</span>;
00227                 <a class="code" href="class_i_pv6.html#p11">numUnroutable</a>++;
00228                 <a class="code" href="structicmp.html">icmp</a>-&gt;sendErrorMessage(datagram, ICMPv6_DESTINATION_UNREACHABLE, 0); <span class="comment">// FIXME check ICMP 'code'</span>
00229             }
00230             <span class="keywordflow">else</span> <span class="comment">// host</span>
00231             {
00232                 <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"no match in routing table, passing datagram to Neighbour Discovery module for default router selection\n"</span>;
00233                 send(datagram, <span class="stringliteral">"ndOut"</span>);
00234             }
00235             <span class="keywordflow">return</span>;
00236         }
00237         interfaceId = route-&gt;<a class="code" href="class_i_pv6_route.html#a10">interfaceID</a>();
00238         nextHop = route-&gt;<a class="code" href="class_i_pv6_route.html#a11">nextHop</a>();
00239         <span class="keywordflow">if</span> (nextHop.<a class="code" href="class_i_pv6_address.html#a22">isUnspecified</a>())
00240             nextHop = destAddress;  <span class="comment">// next hop is the host itself</span>
00241 
00242         <span class="comment">// add result into destination cache</span>
00243         <a class="code" href="class_i_pv6.html#p1">rt</a>-&gt;<a class="code" href="class_routing_table6.html#z55_0">updateDestCache</a>(destAddress, nextHop, interfaceId);
00244     }
00245 
00246     <a class="code" href="class_interface_entry.html">InterfaceEntry</a> *ie = <a class="code" href="class_i_pv6.html#p0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a5">interfaceAt</a>(interfaceId);
00247     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"next hop for "</span> &lt;&lt; destAddress &lt;&lt; <span class="stringliteral">" is "</span> &lt;&lt; nextHop &lt;&lt; <span class="stringliteral">", interface "</span> &lt;&lt; ie-&gt;<a class="code" href="class_interface_entry.html#a5">name</a>() &lt;&lt; <span class="stringliteral">"\n"</span>;
00248     ASSERT(!nextHop.<a class="code" href="class_i_pv6_address.html#a22">isUnspecified</a>() &amp;&amp; ie!=NULL);
00249 
00250     <a class="code" href="class_m_a_c_address.html">MACAddress</a> macAddr = <a class="code" href="class_i_pv6.html#p2">nd</a>-&gt;<a class="code" href="class_i_pv6_neighbour_discovery.html#a2">resolveNeighbour</a>(nextHop, interfaceId);
00251     <span class="keywordflow">if</span> (macAddr.<a class="code" href="class_m_a_c_address.html#a13">isUnspecified</a>())
00252     {
00253         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"no link-layer address for next hop yet, passing datagram to Neighbour Discovery module\n"</span>;
00254         send(datagram, <span class="stringliteral">"ndOut"</span>);
00255         <span class="keywordflow">return</span>;
00256     }
00257     <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"link-layer address: "</span> &lt;&lt; macAddr &lt;&lt; <span class="stringliteral">"\n"</span>;
00258 
00259     <span class="comment">// set datagram source address if not yet set</span>
00260     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a4">srcAddress</a>().<a class="code" href="class_i_pv6_address.html#a22">isUnspecified</a>())
00261     {
00262         <span class="keyword">const</span> <a class="code" href="class_i_pv6_address.html">IPv6Address</a>&amp; srcAddr = ie-&gt;<a class="code" href="class_interface_entry.html#a34">ipv6</a>()-&gt;<a class="code" href="class_i_pv6_interface_data.html#z48_9">preferredAddress</a>();
00263         ASSERT(!srcAddr.<a class="code" href="class_i_pv6_address.html#a22">isUnspecified</a>()); <span class="comment">// FIXME what if we don't have an address yet?</span>
00264         datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a6">setSrcAddress</a>(srcAddr);
00265     }
00266 
00267     <span class="comment">// send out datagram</span>
00268     <a class="code" href="class_i_pv6.html#p12">numForwarded</a>++;
00269     <a class="code" href="class_i_pv6.html#b11">sendDatagramToOutput</a>(datagram, ie, macAddr);
00270 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b11" doxytag="IPv6::sendDatagramToOutput"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::sendDatagramToOutput           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_datagram.html">IPv6Datagram</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datagram</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_interface_entry.html">InterfaceEntry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="class_m_a_c_address.html">MACAddress</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>macAddr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Last hoplimit check, then send datagram on the given interface. <div class="fragment"><pre class="fragment">00541 {
00542     <span class="comment">// hop counter check</span>
00543     <span class="keywordflow">if</span> (datagram-&gt;<a class="code" href="class_i_pv6_datagram___base.html#a14">hopLimit</a>() &lt;= 0)
00544     {
00545         <span class="comment">// drop datagram, destruction responsibility in ICMP</span>
00546         <a class="code" href="_i_n_e_t_defs_8h.html#a1">EV</a> &lt;&lt; <span class="stringliteral">"datagram hopLimit reached zero, sending ICMPv6_TIME_EXCEEDED\n"</span>;
00547         <a class="code" href="structicmp.html">icmp</a>-&gt;sendErrorMessage(datagram, ICMPv6_TIME_EXCEEDED, 0); <span class="comment">// FIXME check icmp 'code'</span>
00548         <span class="keywordflow">return</span>;
00549     }
00550 
00551     <span class="comment">// in link layer uses MAC addresses (basically, not PPP), add control info</span>
00552     <span class="keywordflow">if</span> (!macAddr.<a class="code" href="class_m_a_c_address.html#a13">isUnspecified</a>())
00553     {
00554         <a class="code" href="class_ieee802_ctrl.html">Ieee802Ctrl</a> *controlInfo = <span class="keyword">new</span> <a class="code" href="class_ieee802_ctrl.html">Ieee802Ctrl</a>();
00555         controlInfo-&gt;<a class="code" href="class_ieee802_ctrl.html#a11">setDest</a>(macAddr);
00556         datagram-&gt;setControlInfo(controlInfo);
00557     }
00558 
00559     <span class="comment">// send datagram to link layer</span>
00560     send(datagram, <span class="stringliteral">"queueOut"</span>, ie-&gt;<a class="code" href="class_interface_entry.html#a6">networkLayerGateIndex</a>());
00561 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="IPv6::sourceInterfaceFrom"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_entry.html">InterfaceEntry</a> * IPv6::sourceInterfaceFrom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00094 {
00095     cGate *g = msg-&gt;arrivalGate();
00096     <span class="keywordflow">return</span> g ? <a class="code" href="class_i_pv6.html#p0">ift</a>-&gt;<a class="code" href="class_interface_table.html#a8">interfaceByNetworkLayerGateIndex</a>(g-&gt;index()) : NULL;
00097 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="IPv6::updateDisplayString"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPv6::updateDisplayString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00063 {
00064     <span class="keywordtype">char</span> buf[80] = <span class="stringliteral">""</span>;
00065     <span class="keywordflow">if</span> (numForwarded&gt;0) sprintf(buf+strlen(buf), "fwd:%d ", numForwarded);
00066     if (numLocalDeliver&gt;0) sprintf(buf+strlen(buf), "up:%d ", numLocalDeliver);
00067     if (numMulticast&gt;0) sprintf(buf+strlen(buf), "mcast:%d ", numMulticast);
00068     if (numDropped&gt;0) sprintf(buf+strlen(buf), "DROP:%d ", numDropped);
00069     if (numUnroutable&gt;0) sprintf(buf+strlen(buf), "UNROUTABLE:%d ", numUnroutable);
00070     displayString().setTagArg("t",0,buf);
00071 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p4" doxytag="IPv6::curFragmentId"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="class_i_pv6.html#p4">IPv6::curFragmentId</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p5" doxytag="IPv6::fragbuf"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_frag_buf.html">IPv6FragBuf</a> <a class="el" href="class_i_pv6.html#p5">IPv6::fragbuf</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="IPv6::icmp"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_c_m_pv6.html">ICMPv6</a>* <a class="el" href="class_i_pv6.html#p3">IPv6::icmp</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="IPv6::ift"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_interface_table.html">InterfaceTable</a>* <a class="el" href="class_i_pv6.html#p0">IPv6::ift</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p6" doxytag="IPv6::lastCheckTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">simtime_t <a class="el" href="class_i_pv6.html#p6">IPv6::lastCheckTime</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p7" doxytag="IPv6::mapping"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_protocol_mapping.html">ProtocolMapping</a> <a class="el" href="class_i_pv6.html#p7">IPv6::mapping</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p2" doxytag="IPv6::nd"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_i_pv6_neighbour_discovery.html">IPv6NeighbourDiscovery</a>* <a class="el" href="class_i_pv6.html#p2">IPv6::nd</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p10" doxytag="IPv6::numDropped"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_pv6.html#p10">IPv6::numDropped</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p12" doxytag="IPv6::numForwarded"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_pv6.html#p12">IPv6::numForwarded</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p9" doxytag="IPv6::numLocalDeliver"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_pv6.html#p9">IPv6::numLocalDeliver</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p8" doxytag="IPv6::numMulticast"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_pv6.html#p8">IPv6::numMulticast</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p11" doxytag="IPv6::numUnroutable"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_i_pv6.html#p11">IPv6::numUnroutable</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="IPv6::rt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_routing_table6.html">RoutingTable6</a>* <a class="el" href="class_i_pv6.html#p1">IPv6::rt</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_i_pv6_8h.html">IPv6.h</a><li><a class="el" href="_i_pv6_8cc.html">IPv6.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:25 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
