<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>INET Framework for OMNeT++/OMNEST: TCPVirtualDataSendQueue Class Reference</title>
<link href="opp.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.0 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>TCPVirtualDataSendQueue Class Reference</h1><code>#include &lt;TCPVirtualDataSendQueue.h&gt;</code>
<p>
<p>Inheritance diagram for TCPVirtualDataSendQueue:
<p><center><img src="class_t_c_p_virtual_data_send_queue.png" usemap="#TCPVirtualDataSendQueue_map" border="0" alt=""></center>
<map name="TCPVirtualDataSendQueue_map">
<area href="class_t_c_p_send_queue.html" alt="TCPSendQueue" shape="rect" coords="0,0,166,24">
</map>
<a href="class_t_c_p_virtual_data_send_queue-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Send queue that manages "virtual bytes", that is, byte counts only. It uses the length() field of the messages only, everything else is ignored.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_t_c_p_virtual_data_rcv_queue.html">TCPVirtualDataRcvQueue</a> </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#a0">TCPVirtualDataSendQueue</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#a1">~TCPVirtualDataSendQueue</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#a2">init</a> (<a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> startSeq)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#a3">info</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#a4">enqueueAppData</a> (cMessage *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#a5">bufferEndSeq</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="class_t_c_p_segment.html">TCPSegment</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#a6">createSegmentWithBytes</a> (<a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> fromSeq, <a class="el" href="namespace_i_n_e_t_fw.html#a7">ulong</a> numBytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#a7">discardUpTo</a> (<a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> seqNum)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#p0">begin</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_c_p_virtual_data_send_queue.html#p1">end</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="TCPVirtualDataSendQueue::TCPVirtualDataSendQueue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">TCPVirtualDataSendQueue::TCPVirtualDataSendQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Ctor <div class="fragment"><pre class="fragment">00024                                                  : <a class="code" href="class_t_c_p_send_queue.html#a0">TCPSendQueue</a>()
00025 {
00026     <a class="code" href="class_t_c_p_virtual_data_send_queue.html#p0">begin</a> = <a class="code" href="class_t_c_p_virtual_data_send_queue.html#p1">end</a> = 0;
00027 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="TCPVirtualDataSendQueue::~TCPVirtualDataSendQueue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">TCPVirtualDataSendQueue::~<a class="el" href="class_t_c_p_virtual_data_send_queue.html">TCPVirtualDataSendQueue</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Virtual dtor. <div class="fragment"><pre class="fragment">00030 {
00031 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a5" doxytag="TCPVirtualDataSendQueue::bufferEndSeq"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> TCPVirtualDataSendQueue::bufferEndSeq           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the sequence number of the last byte stored in the buffer plus one. (The first byte of the next send operation would get this sequence number.) 
<p>
Implements <a class="el" href="class_t_c_p_send_queue.html#a4">TCPSendQueue</a>.<div class="fragment"><pre class="fragment">00054 {
00055     <span class="keywordflow">return</span> <a class="code" href="class_t_c_p_virtual_data_send_queue.html#p1">end</a>;
00056 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="TCPVirtualDataSendQueue::createSegmentWithBytes"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="class_t_c_p_segment.html">TCPSegment</a> * TCPVirtualDataSendQueue::createSegmentWithBytes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>fromSeq</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="namespace_i_n_e_t_fw.html#a7">ulong</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>numBytes</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called when the <a class="el" href="class_t_c_p.html">TCP</a> wants to send or retransmit data, it constructs a <a class="el" href="class_t_c_p.html">TCP</a> segment which contains the data from the requested sequence number range. The actually returned segment may contain less then maxNumBytes bytes if the subclass wants to reproduce the original segment boundaries when retransmitting. 
<p>
Implements <a class="el" href="class_t_c_p_send_queue.html#a6">TCPSendQueue</a>.<div class="fragment"><pre class="fragment">00059 {
00060     <span class="comment">//tcpEV &lt;&lt; "sendQ: " &lt;&lt; info() &lt;&lt; " createSeg(seq=" &lt;&lt; fromSeq &lt;&lt; " len=" &lt;&lt; numBytes &lt;&lt; ")\n";</span>
00061     ASSERT(<a class="code" href="_t_c_p_connection_8h.html#a37">seqLE</a>(begin,fromSeq) &amp;&amp; <a class="code" href="_t_c_p_connection_8h.html#a37">seqLE</a>(fromSeq+numBytes,end));
00062 
00063     <span class="keywordtype">char</span> msgname[32];
00064     sprintf(msgname, <span class="stringliteral">"tcpseg(l=%lu)"</span>, numBytes);
00065 
00066     <a class="code" href="class_t_c_p_segment.html">TCPSegment</a> *tcpseg = <span class="keyword">new</span> <a class="code" href="class_t_c_p_segment.html">TCPSegment</a>(msgname);
00067     tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a9">setSequenceNo</a>(fromSeq);
00068     tcpseg-&gt;<a class="code" href="class_t_c_p_segment___base.html#a29">setPayloadLength</a>(numBytes);
00069     <span class="keywordflow">return</span> tcpseg;
00070 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="TCPVirtualDataSendQueue::discardUpTo"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void TCPVirtualDataSendQueue::discardUpTo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>seqNum</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Tells the queue that bytes up to (but NOT including) seqNum have been transmitted and ACKed, so they can be removed from the queue. 
<p>
Implements <a class="el" href="class_t_c_p_send_queue.html#a7">TCPSendQueue</a>.<div class="fragment"><pre class="fragment">00073 {
00074     <span class="comment">//tcpEV &lt;&lt; "sendQ: " &lt;&lt; info() &lt;&lt; " discardUpTo(seq=" &lt;&lt; seqNum &lt;&lt; ")\n";</span>
00075     ASSERT(<a class="code" href="_t_c_p_connection_8h.html#a37">seqLE</a>(begin,seqNum) &amp;&amp; <a class="code" href="_t_c_p_connection_8h.html#a37">seqLE</a>(seqNum,end));
00076     <a class="code" href="class_t_c_p_virtual_data_send_queue.html#p0">begin</a> = seqNum;
00077 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="TCPVirtualDataSendQueue::enqueueAppData"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void TCPVirtualDataSendQueue::enqueueAppData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called on SEND app command, it inserts in the queue the data the user wants to send. Implementations of this abstract class will decide what this means: copying actual bytes, just increasing the "last byte queued" variable, or storing cMessage object(s). The msg object should not be referenced after this point (sendQueue may delete it.) 
<p>
Implements <a class="el" href="class_t_c_p_send_queue.html#a3">TCPSendQueue</a>.<div class="fragment"><pre class="fragment">00047 {
00048     <span class="comment">//tcpEV &lt;&lt; "sendQ: " &lt;&lt; info() &lt;&lt; " enqueueAppData(bytes=" &lt;&lt; msg-&gt;byteLength() &lt;&lt; ")\n";</span>
00049     <a class="code" href="class_t_c_p_virtual_data_send_queue.html#p1">end</a> += msg-&gt;byteLength();
00050     <span class="keyword">delete</span> msg;
00051 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="TCPVirtualDataSendQueue::info"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::string TCPVirtualDataSendQueue::info           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns a string with the region stored. <div class="fragment"><pre class="fragment">00040 {
00041     std::stringstream out;
00042     out &lt;&lt; <span class="stringliteral">"["</span> &lt;&lt; <a class="code" href="class_t_c_p_virtual_data_send_queue.html#p0">begin</a> &lt;&lt; <span class="stringliteral">".."</span> &lt;&lt; <a class="code" href="class_t_c_p_virtual_data_send_queue.html#p1">end</a> &lt;&lt; <span class="stringliteral">")"</span>;
00043     <span class="keywordflow">return</span> out.str();
00044 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="TCPVirtualDataSendQueue::init"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void TCPVirtualDataSendQueue::init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>startSeq</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize the object. The startSeq parameter tells what sequence number the first byte of app data should get. This is usually ISS+1 because SYN consumes one byte in the sequence number space.<p>
<a class="el" href="class_t_c_p_virtual_data_send_queue.html#a2">init()</a> may be called more than once; every call flushes the existing contents of the queue. 
<p>
Implements <a class="el" href="class_t_c_p_send_queue.html#a2">TCPSendQueue</a>.<div class="fragment"><pre class="fragment">00034 {
00035     <a class="code" href="class_t_c_p_virtual_data_send_queue.html#p0">begin</a> = startSeq;
00036     <a class="code" href="class_t_c_p_virtual_data_send_queue.html#p1">end</a> = startSeq;
00037 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p0" doxytag="TCPVirtualDataSendQueue::begin"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> <a class="el" href="class_t_c_p_virtual_data_send_queue.html#p0">TCPVirtualDataSendQueue::begin</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="TCPVirtualDataSendQueue::end"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="_i_n_e_t_defs_8h.html#a6">uint32</a> <a class="el" href="class_t_c_p_virtual_data_send_queue.html#p1">TCPVirtualDataSendQueue::end</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_t_c_p_virtual_data_send_queue_8h.html">TCPVirtualDataSendQueue.h</a><li><a class="el" href="_t_c_p_virtual_data_send_queue_8cc.html">TCPVirtualDataSendQueue.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 18:22:31 2006 for INET Framework for OMNeT++/OMNEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.0 </small></address>
</body>
</html>
